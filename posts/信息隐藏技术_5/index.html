<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>信息隐藏技术_5 | lxmliu2002&#39;s Blog</title>
<meta name="keywords" content="CTF, 信息隐藏技术">
<meta name="description" content="学习信息隐藏技术">
<meta name="author" content="lxmliu2002">
<link rel="canonical" href="https://lxmliu2002.github.io/posts/%E4%BF%A1%E6%81%AF%E9%9A%90%E8%97%8F%E6%8A%80%E6%9C%AF_5/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css" integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://lxmliu2002.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://lxmliu2002.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://lxmliu2002.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://lxmliu2002.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://lxmliu2002.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://lxmliu2002.github.io/posts/%E4%BF%A1%E6%81%AF%E9%9A%90%E8%97%8F%E6%8A%80%E6%9C%AF_5/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://lxmliu2002.github.io/posts/%E4%BF%A1%E6%81%AF%E9%9A%90%E8%97%8F%E6%8A%80%E6%9C%AF_5/">
  <meta property="og:site_name" content="lxmliu2002&#39;s Blog">
  <meta property="og:title" content="信息隐藏技术_5">
  <meta property="og:description" content="学习信息隐藏技术">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-02-27T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-02-27T00:00:00+00:00">
    <meta property="article:tag" content="CTF">
    <meta property="article:tag" content="信息隐藏技术">
    <meta property="og:image" content="https://github.com/lxmliu2002/images/raw/main/homepage/home-bg-information_hiding.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://github.com/lxmliu2002/images/raw/main/homepage/home-bg-information_hiding.jpg">
<meta name="twitter:title" content="信息隐藏技术_5">
<meta name="twitter:description" content="学习信息隐藏技术">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://lxmliu2002.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "信息隐藏技术_5",
      "item": "https://lxmliu2002.github.io/posts/%E4%BF%A1%E6%81%AF%E9%9A%90%E8%97%8F%E6%8A%80%E6%9C%AF_5/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "信息隐藏技术_5",
  "name": "信息隐藏技术_5",
  "description": "学习信息隐藏技术",
  "keywords": [
    "CTF", "信息隐藏技术"
  ],
  "articleBody": "五、图像信息隐藏 5.1 图像的位平面 5.1.1 图像的位平面概念 数字图像中用来隐藏信息的位置：\n主要考察像素的各个比特对图像的贡献：\n贡献大的保留 贡献微弱的则可用于隐藏秘密信息的比特 图像的位平面概念：\n图像的数据表示：\n8bit / 像素：256 色（0~255）\n各像素位置相同的位形成一个平面，称为“位平面”\n不同位平面的重要程度不同\n高位：图像信息\n低位：噪声\n人眼对随机噪声不敏感\n5.1.2 位平面分解 位平面算法：\n相关函数\n获取图像 x 的行数和列数：[m, n] = size(x) 提取 A 的第 bit 位的值：C = bitget(A, bit) 将 A 的第 bit 位的值设为 v（v 的取值为 0 或 1）：C = bitset(A, bit, v) 提取第一位平面\n1 2 3 4 5 6 7 8 9 10 x = imread('lenagray.bmp'); [m, n] = size(x); for i = 1:m for j = 1:n c(i, j) = bitget(x(i, j), 1); end end figure; imshow(c, []); title('第一位平面'); 依次提取 1~8 个位平面\n1 2 3 4 5 6 7 8 9 10 11 12 x = imread('lenagray.bmp'); [m, n] = size(x); for t = 1:8 for i = 1:m for j = 1:n c(i, j) = bitget(x(i, j), t); end end figure; imshow(c, []); title(t); end 去除第 1 位平面\n1 2 3 4 5 6 7 8 9 10 x = imread('lenagray.bmp'); [m, n] = size(x); for i = 1:m for j = 1:n x(i, j) = bitset(x(i, j), 1, 0); end end figure; imshow(x); title('去除第一位平面'); 对于 256 级灰度图像，第一个位平面（连同第二个位平面）对图像能量的贡献较小，可以用于秘密信息的隐藏。\n5.2 图像的 LSB 方法 LSB 方法：用秘密信息（比特）替换掉最低有效位的数据。\n符号规定：\n$c_i$：载体对象的取样值\n$s_i$：伪装对象的取样值\n$L(c)$：载体的长度\n$k$：伪装密钥\n$L(m)$：秘密信息的长度\n流载体的 LSB 方法：\n嵌入：选择一个载体元素的子集 ${j_1,j_2,…,j_{L(m)}}$ ，其中共有 $L(m)$ 个元素，用以隐藏秘密信息的 $L(m)$ 个比特。然后在这个子集上执行替换操作，把 $c_{j_i}$ 的最低比特用 $m_i$ 来替换。 提取：找到嵌入信息的伪装元素的子集 ${j_1,j_2,…,j_{L(m)}}$，从这些伪装对象 $S_{j_i}$ 中抽出它们的最低比特位，排列之后组成秘密信息 $m$。 如何选择隐藏位置子集？\n顺序选取：发送者从载体的第一个元素开始，顺序选取 $L(m)$ 个元素作为隐藏的子集 缺点：已经嵌入部分和未嵌入部分数据特征不同 解决方法 嵌入秘密信息后，继续嵌入伪随机序列 重复嵌入秘密信息，直到载体结束 随机间隔法：双方利用相同的伪随机数发生器和伪装密钥，确定隐藏位置 随机间隔：用伪装密钥 $k$ 作为 伪随机数发生器的种子，生成一个伪随机序列 $k_1,k_2,…,k_{L(m)}$，则嵌入位置为 $j_1=k_1,k_i=j_{i-1}+k_i(i\\ge2)$ 伪随机置换：能够得到载体的所有元素，就可以从整个载体考虑，把秘密信息比特随机地分散在整个载体中。\n嵌入：用种子密钥产生一个伪随机序列 ${j_1,j_2,…,j_{L(m)}}$，将第 $k$ 个秘密信息比特隐藏在索引为 $j_k$ 的载体元素的最低比特位中。 提取：用同样的种子密钥产生相同的伪随机索引序列，从这些位置最低比特位中提取信息 应避免的问题：产生的索引值可能产生碰撞；用一个集合记录所有一使用过的载体索引值，当再次出现同样的索引值时，则放弃这个索引值，再选择下一个元素；提取时做同样处理 LSB 方法的特点：\n优点：简单，易实现，容量大 缺点：安全性不高，不能抵抗叠加噪声、有损压缩等破坏 提高 LSB 方法的安全性的措施：\n对秘密信息先加密再隐藏 多次重复嵌入 引入纠错编码技术，先进行纠错编码，再进行隐藏 5.3 利用奇偶校验位的方法 把载体划分成几个不相重叠的区域，在一个载体区域中存储一比特信息 嵌入：选择 $L(m)$ 个不相重叠区域，计算出每一区域 $I$ 的所有最低比特的奇偶校验位（即 1 的个数奇偶性）$b_i(i = 1,2,…,n)$。$b_i=\\Sigma_{j\\in I}LSB(c_j)mod2$。嵌入信息时，在对应区域的奇偶校验位上嵌入信息比特 $m_i$，如果奇偶校验位 $b_i$ 与 $m_i$ 不匹配，则将该区域中所有元素的最低比特位进行反转，使得奇偶校验位与 $m_i$ 相同，即 $b_i=m_i$。 提取：在接收端，收方与发放拥有共同的伪装密钥作为种子，可以伪随机地构造载体区域。收方从载体区域中计算出奇偶校验位，排列起来就可以重构秘密信息。 把载体划分成几个不相重叠的区域，在一个载体区域中存储一比特信息 嵌入：选择 $L(m)$ 个不相重叠区域，计算出每一区域 $I$ 的所有最低比特的奇偶校验位（即 1 的个数奇偶性）$b_i(i = 1,2,…,n)$。$b_i=\\Sigma_{j\\in I}LSB(c_j)mod2$。区域 $I$ 隐藏一个信息比特。如果奇偶校验位 $b_i$ 与 $m_i$ 不匹配，则将该区域中某个像素的最低比特位进行反转，使得奇偶校验位与 $m_i$ 相同，即 $b_i=m_i$。 提取：用同样的方法划分载体区域，计算出奇偶校验位，构成秘密信息。 5.4 基于调色板图像的信息隐藏 图像的表示方式：\n在图像矩阵中直接存放像素的实际数据 基于调色板的图像 调色板图像的组成：\n调色板数据：定义了 N 种颜色索引对 $(i,c_i)$ 图像数据：保存每一个像素的调色板索引 基于调色板的 LSB 方法：\n修改调色板颜色向量的 LSB：对调色板的颜色向量的最低比特为进行秘密信息的替换 对于灰度图像，修改灰度图像的调色板颜色数据对图像的显示没有明显影响 对彩色图像，如果在 RGB 三色中同时修改最低比特为，产生的图像颜色可能会出现偏差，容易引起攻击者的怀疑 修改图像数据（索引）的 LSB：在图像的索引数据中进行 LSB 的替换 问题：索引值代表的是调色板中某一种颜色的顺序号。相邻的索引值其代表的颜色可能相差很远。 解决方法：可以先将颜色按某种规则排序，使得相邻颜色比较接近，这时索引值说代表的颜色是相近的。例如，将颜色值根据它们在色彩空间中的欧几里得距离进行排序：$d=\\sqrt{R^2+G^2+B^2}$ 基于调色板排序的隐藏法：用调色板的排序方式对信息进行编码\n在图像的存储中，调色板不需以任何方式排序，所以在以调色板保存颜色时，可以用来对信息进行编码。有 N!个不同的方式对调色板进行排序，可以可以用来对一个短信息进行编码。 缺点：这种演唱信息的方法不具有鲁棒性，任何攻击者都可以通过改变调色板的排序方式（如“另存为”）来破坏秘密信息，而对图像没有丝毫损害。 基于双份调色板索引对隐藏法：保持调色板的颜色不变，将数目扩大一倍，因此图像中的每一个颜色值对应两个调色板索引，根据秘密信息比特，选择两个相同颜色中的一个。接收端利用事先约定的规则，根据每个像素使用的是调色板的哪一个颜色索引来提取出秘密信息。\n5.5 基于量化编码的信息隐藏 基于量化编码的信息隐藏：\n原理：在预测编码中，每一个采样的大小是根据它的邻近采样的值进行预测的。最简单的情况是计算出邻近采样 $x_i$ 和 $x_{i-1}$ 的差值，把差值送入量化器，由量化器输出差分信号的一个离散近似值 $\\Delta_i=Q(x_i-x_{i-1})$，在编码时，只需对 $\\Delta$ 进行编码即可，这就是所谓的增量编码。在增量编码里面，也可以进行信息的隐藏。 基本思想：利用差分信号（或调整差分信号）来传送额外信息。为此，需事先建立一个伪装密钥的表，为每一个可能的 $\\Delta_i$ 值分配一个比特。 嵌入：计算邻近采样 $x_i$ 和 $x_{i-1}$ 的差值，对差值进行量化，得到 $\\Delta_i=Q(x_i-x_{i-1})$，查量化隐藏表： 如果 $\\Delta_i$ 与要编码的秘密信息比特相同，则差分信号不变； 否则，则由最接近的 $\\Delta_i$ 替换，使得查表所对应的比特与秘密信息比特相同。 接收：接收者拥有同样的伪装密钥表，它根据伪装对象的相邻数据的差分信号，对应密钥表，可以得到每一个差分值所对应的秘密信息比特。 基于量化编码的信息隐藏方法尽管很巧妙，但这种方法同最低比特位隐藏方法一样，仍然属于在噪声信号中隐藏信息，因此其稳健型不强。\n5.6 二值图像中的信息隐藏 二值图像由黑白两种颜色的像素组成，通常利用图像区域中黑色像素个数相对于区域中全部像素个数的百分比来对秘密信息进行编码。\nZhao-Koch 方案\n嵌入：把一个二值图像分成 $L(m)$ 个矩阵图像区域 $B_i$，如果其中黑色像素的个数大于一般，则表示嵌入 0；如果白色像素的个数大于一半，则表示嵌入 1。当需要嵌入的比特与所选区域的黑白像素的比例不一致时，为了达到希望的像素关系，则需要修改一些像蛇的颜色。修改赢遵循一定的规则，原则是不引起感观察觉，修改应在黑白区域的边缘进行。\n需注意的细节：选择图像块时，应考虑有一定的冗余度，确定有效区域：\n确定两个阈值 $R_1\u003e50%$ 和 $R_0\u003c50%$，以及一个健壮性参数 $\\lambda$ 隐藏 0 时，该块的黑色像素的个数应属于 $[R_1,R_1+\\lambda]$ 隐藏 1 时，该块的黑色像素的个数应属于 $[R_0-\\lambda,R_0]$ 标识无效块：如果为了适应所嵌入的比特，目标块必须修改太多的像素，就把该块设为无效\n将无效块中的像素进行少量的修改，使得其中黑色像素的百分比大于 $R_1+3\\lambda$，或者小于 $R_0-3\\lambda$ 提取：判断每一个图像块黑色像素的百分比，如果大于 $R_1+3\\lambda$，或者小于 $R_0-3\\lambda$，则跳过这样的无效块；如果在 $[R_1,R_1+\\lambda]$ 或 $[R_0-\\lambda,R_0]$ 的范围内，则正确提取出秘密信息 0 或 1。\n简易算法：将原图划分为 $1\\times4$ 的矩形像素块，每个区域有四个连续的像素点。这些像素点的取值情况可以分为 5 类：全白，1 个黑像素点，2 个黑像素点，3 个黑像素点和全黑。\n黑像素个数 0 1 2 3 4 像素分布 全白 1 黑 3 白 2 黑 2 白 3 黑 1 白 全黑 含义 无效块 隐藏 1 不能出现 隐藏 0 无效块 要隐藏的信息位文本文档中的字符串，需注意：\n嵌入的信息长度不能过大，不能超过图片大小所能负担的度量 为了简化过程，可以规定接收者已知秘密信息的长度 嵌入：遍历原图中的每个 $1\\times4$ 矩阵区域\n如果要嵌入的信息为 0，则需要将当前区域的黑像素点数量调整到 3 个 如果当前区域黑像素点数量正好为 3 个，则不需要修改 如果当前区域黑像素点数量为 1 或 2 或 4 个，则需要进行修改，使其黑色像素点数量变为 3 个，同时要注意的是，对原有黑色像素直接利用，位置不做修改，为的是嵌入秘密信息的过程中，对图片的修改尽量少 如果原区域全白，则舍弃这一块不做修改，否则变化可能被直观视觉所感受到 如果要嵌入的信息为 1，则需要将当前区域的黑像素点数量调整到 1 个 如果当前区域黑像素点数量正好为 1 个，则不需要修改 如果当前区域黑像素点数量为 0 或 2 或 3 个，则需要进行修改，使其黑色像素点数量变为 1 个，同时要注意的是，对原有黑色像素直接利用，多余的翻转为白像素，为的是嵌入秘密信息的过程中，对图片的修改尽量少 如果原区域全黑，则舍弃这一块不做修改，否则变化可能被直观视觉所感受到 提取：嵌入过信息的图像中每个区域的黑色像素点个数只有 4 个取值：0、1、3、4.遍历携带图像的每个 $1\\times4$ 区域，如果黑色像素点个数为 1 或 3 则提取信息，1 个黑像素点对应 1，3 个黑像素点对应 0，其余为为嵌入信息的区域。\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 for j = c:cc % 统计区域内黑块的个数 if bw(r, j) == 0 blk = blk + 1; end end % 要嵌入的消息为 0，修改使黑色变为 3 个 if bin_msg(ind) == 0 if blk == 1 % 1 个黑色素 if bw(r, c) == 0 % 黑色素位于第一个位置 bw(r, c + 1) = 0; bw(r, c + 2) = 0; elseif bw(r, c + 1) == 0 % 黑色素位于第二个位置 bw(r, c) = 0; bw(r, c + 2) = 0; elseif ...... % 黑色素位于第三个位置 else ...... % 黑色素位于第四个位置 end elseif blk == 2 % 2 个黑色素 elseif blk == 3 % 3 个黑色素 elseif blk == 4 % 4 个黑色素（全白块） randnum = round(rand(1, 1) * 3); if randnum == 0 bw(r, c) = 1; elseif randnum == 1 bw(r, c + 1) = 1; ...... end elseif blk == 0 % 黑色为 0 个，舍弃这一块 ind = ind - 1; end else % 要嵌入的信息为 1，需要修改使黑色为 1 个 ...... end 游程编码：\n编码：$$ 嵌入：修改二值图像的游程长度 如果秘密信息位是 0，则修改该游程长度为偶数 如果为 1，则修改为奇数 如果秘密信息的取值与游程长度的奇偶性想匹配，则不改变游程长度 提取：根据游程长度的奇偶性提取出秘密信息 5.7 DCT 域的信息隐藏 变换域技术：在载体的显著区域隐藏信息，比 LSB 方法能够更好地抵抗攻击，而且还保持了对人类感观的不可察觉性。\n常用的变换域方法： 离散余弦变换（DCT） 离散小波变换（DWT） 离散傅里叶变换（DFT） 图像压缩标准（JPEG）的核心：二维 DCT 变换。在 DCT 域中的信息隐藏，可以有效地抵抗 JPEG 有损压缩。\n二维 DCT 变换：图像分为 $8\\times8$ 的像素块，进行二维 DCT 变换，得到 $8\\times8$ 的 DCT 系数。最左上角的那个洗漱为直流系数，其余为交流系数。左上角的部分为直流和低频，右下角的部分为高频，中间区域为中频。中频系数包含了图像的大部分能量，是对人的视觉最重要的部分。\nDCT 与 Zig-Zag 扫描顺序：转换 2-D 系数区块成 1-D 系数，系数按照 Zig-Zag 次序排列。\n基本隐藏算法：以一定的方式挑选一些中频系数，在这些中频系数中叠加秘密信息：\n所有中频系数 固定位置的中频系数 随机挑选中频系数 选择最大的几个中频系数 在选出的中频系数中叠加秘密信息 $x’(i,j)=x(i,j)+\\alpha m_i$，$x(i,j)$ 为 DCT 系数，$x’(i,j)$ 为隐藏后的 DCT 系数，$m_i$ 为第 i 个秘密信息比特，$\\alpha$ 为可调参数，控制嵌入强度。 在选出的中频系数中叠加秘密信息 $x’(i,j)=x(i,j)(1+\\alpha m_i)$ 每个系数上嵌入的强度相同 根据系数的大小成比例地嵌入 上述的两个算法的提取都需要原始图像\n不需要原始载体的隐藏方法：利用载体中两个特定数的相对大小来代表隐藏的信息\n嵌入：载体图像分为 $8\\times8$ 的块，做二维 DCT 变换，伪随机地选择一个图像块 $B_i$，分别选择其中的两个位置，比如用 $(u_1,v_1)$ 和 $(u_2,v_2)$ 代表所选定的两个系数的坐标。 如果 $B_i(u_1,v_1)\u003eB_i(u_2,v_2)$，代表隐藏 1；如果相反，则交换两系数 如果 $B_i(u_1,v_1)",
  "wordCount" : "928",
  "inLanguage": "en",
  "image":"https://github.com/lxmliu2002/images/raw/main/homepage/home-bg-information_hiding.jpg","datePublished": "2024-02-27T00:00:00Z",
  "dateModified": "2024-02-27T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "lxmliu2002"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://lxmliu2002.github.io/posts/%E4%BF%A1%E6%81%AF%E9%9A%90%E8%97%8F%E6%8A%80%E6%9C%AF_5/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "lxmliu2002's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://lxmliu2002.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lxmliu2002.github.io/" accesskey="h" title="lxmliu2002&#39;s Blog (Alt + H)">lxmliu2002&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://lxmliu2002.github.io/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://lxmliu2002.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://lxmliu2002.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://lxmliu2002.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://lxmliu2002.github.io/" title="homepage">
                    <span>homepage</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://lxmliu2002.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://lxmliu2002.github.io/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      信息隐藏技术_5
    </h1>
    <div class="post-description">
      学习信息隐藏技术
    </div>
    <div class="post-meta"><span title='2024-02-27 00:00:00 +0000 UTC'>February 27, 2024</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;lxmliu2002&nbsp;|&nbsp;<a href="https://github.com/lxmliu2002/My_Blog/tree/master/content/posts/%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e6%8a%80%e6%9c%af_5.md" rel="noopener noreferrer" target="_blank">Any Suggestions?</a>

</div>
  </header> 
<figure class="entry-cover"><img loading="eager" src="https://github.com/lxmliu2002/images/raw/main/homepage/home-bg-information_hiding.jpg" alt="">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e4%ba%94%e5%9b%be%e5%83%8f%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f" aria-label="五、图像信息隐藏">五、图像信息隐藏</a><ul>
                        
                <li>
                    <a href="#51-%e5%9b%be%e5%83%8f%e7%9a%84%e4%bd%8d%e5%b9%b3%e9%9d%a2" aria-label="5.1 图像的位平面">5.1 图像的位平面</a><ul>
                        
                <li>
                    <a href="#511-%e5%9b%be%e5%83%8f%e7%9a%84%e4%bd%8d%e5%b9%b3%e9%9d%a2%e6%a6%82%e5%bf%b5" aria-label="5.1.1 图像的位平面概念">5.1.1 图像的位平面概念</a></li>
                <li>
                    <a href="#512-%e4%bd%8d%e5%b9%b3%e9%9d%a2%e5%88%86%e8%a7%a3" aria-label="5.1.2 位平面分解">5.1.2 位平面分解</a></li></ul>
                </li>
                <li>
                    <a href="#52-%e5%9b%be%e5%83%8f%e7%9a%84-lsb-%e6%96%b9%e6%b3%95" aria-label="5.2 图像的 LSB 方法">5.2 图像的 LSB 方法</a></li>
                <li>
                    <a href="#53-%e5%88%a9%e7%94%a8%e5%a5%87%e5%81%b6%e6%a0%a1%e9%aa%8c%e4%bd%8d%e7%9a%84%e6%96%b9%e6%b3%95" aria-label="5.3 利用奇偶校验位的方法">5.3 利用奇偶校验位的方法</a></li>
                <li>
                    <a href="#54-%e5%9f%ba%e4%ba%8e%e8%b0%83%e8%89%b2%e6%9d%bf%e5%9b%be%e5%83%8f%e7%9a%84%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f" aria-label="5.4 基于调色板图像的信息隐藏">5.4 基于调色板图像的信息隐藏</a></li>
                <li>
                    <a href="#55-%e5%9f%ba%e4%ba%8e%e9%87%8f%e5%8c%96%e7%bc%96%e7%a0%81%e7%9a%84%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f" aria-label="5.5 基于量化编码的信息隐藏">5.5 基于量化编码的信息隐藏</a></li>
                <li>
                    <a href="#56-%e4%ba%8c%e5%80%bc%e5%9b%be%e5%83%8f%e4%b8%ad%e7%9a%84%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f" aria-label="5.6 二值图像中的信息隐藏">5.6 二值图像中的信息隐藏</a></li>
                <li>
                    <a href="#57-dct-%e5%9f%9f%e7%9a%84%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f" aria-label="5.7 DCT 域的信息隐藏">5.7 DCT 域的信息隐藏</a></li>
                <li>
                    <a href="#58-dwt-%e5%9f%9f%e7%9a%84%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f" aria-label="5.8 DWT 域的信息隐藏">5.8 DWT 域的信息隐藏</a></li>
                <li>
                    <a href="#59-%e6%96%87%e4%bb%b6%e6%a0%bc%e5%bc%8f%e9%9a%90%e8%97%8f%e6%b3%95" aria-label="5.9 文件格式隐藏法">5.9 文件格式隐藏法</a></li>
                <li>
                    <a href="#510-%e7%bb%9f%e8%ae%a1%e9%9a%90%e8%97%8f%e6%8a%80%e6%9c%af%e4%b8%8e%e5%8f%98%e5%bd%a2%e6%8a%80%e6%9c%af" aria-label="5.10 统计隐藏技术与变形技术">5.10 统计隐藏技术与变形技术</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="五图像信息隐藏">五、图像信息隐藏<a hidden class="anchor" aria-hidden="true" href="#五图像信息隐藏">#</a></h1>
<h2 id="51-图像的位平面">5.1 图像的位平面<a hidden class="anchor" aria-hidden="true" href="#51-图像的位平面">#</a></h2>
<h3 id="511-图像的位平面概念">5.1.1 图像的位平面概念<a hidden class="anchor" aria-hidden="true" href="#511-图像的位平面概念">#</a></h3>
<p>数字图像中用来隐藏信息的位置：</p>
<blockquote>
<p>主要考察像素的各个比特对图像的贡献：</p>
</blockquote>
<ul>
<li>贡献大的保留</li>
<li>贡献微弱的则可用于隐藏秘密信息的比特</li>
</ul>
<p>图像的位平面概念：</p>
<ul>
<li>
<p>图像的数据表示：</p>
<ul>
<li>
<p>8bit / 像素：256 色（0~255）</p>
<ul>
<li>
<p>各像素位置相同的位形成一个平面，称为“位平面”</p>
</li>
<li>
<p>不同位平面的重要程度不同</p>
<ul>
<li>
<p>高位：图像信息</p>
</li>
<li>
<p>低位：噪声</p>
<blockquote>
<p>人眼对随机噪声不敏感</p>
</blockquote>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="512-位平面分解">5.1.2 位平面分解<a hidden class="anchor" aria-hidden="true" href="#512-位平面分解">#</a></h3>
<p>位平面算法：</p>
<ul>
<li>
<p>相关函数</p>
<ul>
<li>获取图像 x 的行数和列数：[m, n] = size(x)</li>
<li>提取 A 的第 bit 位的值：C = bitget(A, bit)</li>
<li>将 A 的第 bit 位的值设为 v（v 的取值为 0 或 1）：C = bitset(A, bit, v)</li>
</ul>
</li>
<li>
<p>提取第一位平面</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-matlab" data-lang="matlab"><span class="line"><span class="cl"><span class="n">x</span> <span class="p">=</span> <span class="n">imread</span><span class="p">(</span><span class="s">&#39;lenagray.bmp&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span> <span class="p">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="nb">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">m</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="nb">j</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span>
</span></span><span class="line"><span class="cl">		<span class="n">c</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span> <span class="nb">j</span><span class="p">)</span> <span class="p">=</span> <span class="n">bitget</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span> <span class="nb">j</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="n">figure</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">imshow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="p">[]);</span>
</span></span><span class="line"><span class="cl"><span class="n">title</span><span class="p">(</span><span class="s">&#39;第一位平面&#39;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>依次提取 1~8 个位平面</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-matlab" data-lang="matlab"><span class="line"><span class="cl"><span class="n">x</span> <span class="p">=</span> <span class="n">imread</span><span class="p">(</span><span class="s">&#39;lenagray.bmp&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span> <span class="p">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">t</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="mi">8</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="nb">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">m</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="nb">j</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span>
</span></span><span class="line"><span class="cl">            <span class="n">c</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span> <span class="nb">j</span><span class="p">)</span> <span class="p">=</span> <span class="n">bitget</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span> <span class="nb">j</span><span class="p">),</span> <span class="n">t</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="n">figure</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">imshow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="p">[]);</span>
</span></span><span class="line"><span class="cl">    <span class="n">title</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>去除第 1 位平面</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-matlab" data-lang="matlab"><span class="line"><span class="cl"><span class="n">x</span> <span class="p">=</span> <span class="n">imread</span><span class="p">(</span><span class="s">&#39;lenagray.bmp&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span> <span class="p">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="nb">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">m</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="nb">j</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span>
</span></span><span class="line"><span class="cl">		<span class="n">x</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span> <span class="nb">j</span><span class="p">)</span> <span class="p">=</span> <span class="n">bitset</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span> <span class="nb">j</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="n">figure</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">imshow</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">title</span><span class="p">(</span><span class="s">&#39;去除第一位平面&#39;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p>对于 256 级灰度图像，第一个位平面（连同第二个位平面）对图像能量的贡献较小，可以用于秘密信息的隐藏。</p>
<h2 id="52-图像的-lsb-方法">5.2 图像的 LSB 方法<a hidden class="anchor" aria-hidden="true" href="#52-图像的-lsb-方法">#</a></h2>
<p>LSB 方法：用秘密信息（比特）替换掉最低有效位的数据。</p>
<p>符号规定：</p>
<ul>
<li>
<p>$c_i$：载体对象的取样值</p>
</li>
<li>
<p>$s_i$：伪装对象的取样值</p>
</li>
<li>
<p>$L(c)$：载体的长度</p>
</li>
<li>
<p>$k$：伪装密钥</p>
</li>
<li>
<p>$L(m)$：秘密信息的长度</p>
</li>
</ul>
<p>流载体的 LSB 方法：</p>
<ul>
<li>嵌入：选择一个载体元素的子集 ${j_1,j_2,&hellip;,j_{L(m)}}$ ，其中共有 $L(m)$ 个元素，用以隐藏秘密信息的  $L(m)$ 个比特。然后在这个子集上执行替换操作，把 $c_{j_i}$ 的最低比特用 $m_i$ 来替换。</li>
<li>提取：找到嵌入信息的伪装元素的子集 ${j_1,j_2,&hellip;,j_{L(m)}}$，从这些伪装对象 $S_{j_i}$ 中抽出它们的最低比特位，排列之后组成秘密信息 $m$。</li>
</ul>
<p>如何选择隐藏位置子集？</p>
<ul>
<li>顺序选取：发送者从载体的第一个元素开始，顺序选取 $L(m)$ 个元素作为隐藏的子集
<ul>
<li>缺点：已经嵌入部分和未嵌入部分数据特征不同
<ul>
<li>解决方法
<ul>
<li>嵌入秘密信息后，继续嵌入伪随机序列</li>
<li>重复嵌入秘密信息，直到载体结束</li>
<li>随机间隔法：双方利用相同的伪随机数发生器和伪装密钥，确定隐藏位置</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>随机间隔：用伪装密钥 $k$ 作为 伪随机数发生器的种子，生成一个伪随机序列 $k_1,k_2,&hellip;,k_{L(m)}$，则嵌入位置为 $j_1=k_1,k_i=j_{i-1}+k_i(i\ge2)$</li>
</ul>
<p>伪随机置换：能够得到载体的所有元素，就可以从整个载体考虑，把秘密信息比特随机地分散在整个载体中。</p>
<ul>
<li>嵌入：用种子密钥产生一个伪随机序列 ${j_1,j_2,&hellip;,j_{L(m)}}$，将第 $k$ 个秘密信息比特隐藏在索引为 $j_k$ 的载体元素的最低比特位中。</li>
<li>提取：用同样的种子密钥产生相同的伪随机索引序列，从这些位置最低比特位中提取信息</li>
<li>应避免的问题：产生的索引值可能产生碰撞；用一个集合记录所有一使用过的载体索引值，当再次出现同样的索引值时，则放弃这个索引值，再选择下一个元素；提取时做同样处理</li>
</ul>
<p>LSB 方法的特点：</p>
<ul>
<li>优点：简单，易实现，容量大</li>
<li>缺点：安全性不高，不能抵抗叠加噪声、有损压缩等破坏</li>
</ul>
<p>提高 LSB 方法的安全性的措施：</p>
<ul>
<li>对秘密信息先加密再隐藏</li>
<li>多次重复嵌入</li>
<li>引入纠错编码技术，先进行纠错编码，再进行隐藏</li>
</ul>
<h2 id="53-利用奇偶校验位的方法">5.3 利用奇偶校验位的方法<a hidden class="anchor" aria-hidden="true" href="#53-利用奇偶校验位的方法">#</a></h2>
<ul>
<li>把载体划分成几个不相重叠的区域，在一个载体区域中存储一比特信息
<ul>
<li>嵌入：选择 $L(m)$ 个不相重叠区域，计算出每一区域 $I$ 的所有最低比特的奇偶校验位（即 1 的个数奇偶性）$b_i(i = 1,2,&hellip;,n)$。$b_i=\Sigma_{j\in I}LSB(c_j)mod2$。嵌入信息时，在对应区域的奇偶校验位上嵌入信息比特 $m_i$，如果奇偶校验位 $b_i$ 与 $m_i$ 不匹配，则将该区域中所有元素的最低比特位进行反转，使得奇偶校验位与 $m_i$ 相同，即 $b_i=m_i$。</li>
<li>提取：在接收端，收方与发放拥有共同的伪装密钥作为种子，可以伪随机地构造载体区域。收方从载体区域中计算出奇偶校验位，排列起来就可以重构秘密信息。</li>
</ul>
</li>
<li>把载体划分成几个不相重叠的区域，在一个载体区域中存储一比特信息
<ul>
<li>嵌入：选择 $L(m)$ 个不相重叠区域，计算出每一区域 $I$ 的所有最低比特的奇偶校验位（即 1 的个数奇偶性）$b_i(i = 1,2,&hellip;,n)$。$b_i=\Sigma_{j\in I}LSB(c_j)mod2$。区域 $I$ 隐藏一个信息比特。如果奇偶校验位 $b_i$ 与 $m_i$ 不匹配，则将该区域中<strong>某个像素</strong>的最低比特位进行反转，使得奇偶校验位与 $m_i$ 相同，即 $b_i=m_i$。</li>
<li>提取：用同样的方法划分载体区域，计算出奇偶校验位，构成秘密信息。</li>
</ul>
</li>
</ul>
<h2 id="54-基于调色板图像的信息隐藏">5.4 基于调色板图像的信息隐藏<a hidden class="anchor" aria-hidden="true" href="#54-基于调色板图像的信息隐藏">#</a></h2>
<p>图像的表示方式：</p>
<ul>
<li>在图像矩阵中直接存放像素的实际数据</li>
<li>基于调色板的图像</li>
</ul>
<p>调色板图像的组成：</p>
<ul>
<li>调色板数据：定义了 N 种颜色索引对 $(i,c_i)$</li>
<li>图像数据：保存每一个像素的调色板索引</li>
</ul>
<p><strong>基于调色板的 LSB 方法</strong>：</p>
<ol>
<li>修改调色板颜色向量的 LSB：对调色板的颜色向量的最低比特为进行秘密信息的替换
<ul>
<li>对于灰度图像，修改灰度图像的调色板颜色数据对图像的显示没有明显影响</li>
<li>对彩色图像，如果在 RGB 三色中同时修改最低比特为，产生的图像颜色可能会出现偏差，容易引起攻击者的怀疑</li>
</ul>
</li>
<li>修改图像数据（索引）的 LSB：在图像的索引数据中进行 LSB 的替换
<ul>
<li>问题：索引值代表的是调色板中某一种颜色的顺序号。相邻的索引值其代表的颜色可能相差很远。</li>
<li>解决方法：可以先将颜色按某种规则排序，使得相邻颜色比较接近，这时索引值说代表的颜色是相近的。例如，将颜色值根据它们在色彩空间中的欧几里得距离进行排序：$d=\sqrt{R^2+G^2+B^2}$</li>
</ul>
</li>
</ol>
<p><strong>基于调色板排序的隐藏法</strong>：用调色板的排序方式对信息进行编码</p>
<ul>
<li>在图像的存储中，调色板不需以任何方式排序，所以在以调色板保存颜色时，可以用来对信息进行编码。有 N!个不同的方式对调色板进行排序，可以可以用来对一个短信息进行编码。</li>
<li>缺点：这种演唱信息的方法不具有鲁棒性，任何攻击者都可以通过改变调色板的排序方式（如“另存为”）来破坏秘密信息，而对图像没有丝毫损害。</li>
</ul>
<p><strong>基于双份调色板索引对隐藏法</strong>：保持调色板的颜色不变，将数目扩大一倍，因此图像中的每一个颜色值对应两个调色板索引，根据秘密信息比特，选择两个相同颜色中的一个。接收端利用事先约定的规则，根据每个像素使用的是调色板的哪一个颜色索引来提取出秘密信息。</p>
<h2 id="55-基于量化编码的信息隐藏">5.5 基于量化编码的信息隐藏<a hidden class="anchor" aria-hidden="true" href="#55-基于量化编码的信息隐藏">#</a></h2>
<p>基于量化编码的信息隐藏：</p>
<ul>
<li>原理：在预测编码中，每一个采样的大小是根据它的邻近采样的值进行预测的。最简单的情况是计算出邻近采样 $x_i$ 和 $x_{i-1}$ 的差值，把差值送入量化器，由量化器输出差分信号的一个离散近似值 $\Delta_i=Q(x_i-x_{i-1})$，在编码时，只需对 $\Delta$ 进行编码即可，这就是所谓的增量编码。在增量编码里面，也可以进行信息的隐藏。</li>
<li>基本思想：利用差分信号（或调整差分信号）来传送额外信息。为此，需事先建立一个伪装密钥的表，为每一个可能的 $\Delta_i$ 值分配一个比特。</li>
<li>嵌入：计算邻近采样 $x_i$ 和 $x_{i-1}$ 的差值，对差值进行量化，得到 $\Delta_i=Q(x_i-x_{i-1})$，查量化隐藏表：
<ul>
<li>如果 $\Delta_i$ 与要编码的秘密信息比特相同，则差分信号不变；</li>
<li>否则，则由最接近的 $\Delta_i$ 替换，使得查表所对应的比特与秘密信息比特相同。</li>
</ul>
</li>
<li>接收：接收者拥有同样的伪装密钥表，它根据伪装对象的相邻数据的差分信号，对应密钥表，可以得到每一个差分值所对应的秘密信息比特。</li>
</ul>
<p>基于量化编码的信息隐藏方法尽管很巧妙，但这种方法同最低比特位隐藏方法一样，仍然属于在噪声信号中隐藏信息，因此其稳健型不强。</p>
<h2 id="56-二值图像中的信息隐藏">5.6 二值图像中的信息隐藏<a hidden class="anchor" aria-hidden="true" href="#56-二值图像中的信息隐藏">#</a></h2>
<p>二值图像由黑白两种颜色的像素组成，通常利用图像区域中黑色像素个数相对于区域中全部像素个数的百分比来对秘密信息进行编码。</p>
<p>Zhao-Koch 方案</p>
<ul>
<li>
<p>嵌入：把一个二值图像分成 $L(m)$ 个矩阵图像区域 $B_i$，如果其中黑色像素的个数大于一般，则表示嵌入 0；如果白色像素的个数大于一半，则表示嵌入 1。当需要嵌入的比特与所选区域的黑白像素的比例不一致时，为了达到希望的像素关系，则需要修改一些像蛇的颜色。修改赢遵循一定的规则，原则是不引起感观察觉，修改应在黑白区域的边缘进行。</p>
</li>
<li>
<p>需注意的细节：选择图像块时，应考虑有一定的冗余度，确定有效区域：</p>
<ul>
<li>确定两个阈值 $R_1&gt;50%$ 和 $R_0&lt;50%$，以及一个健壮性参数 $\lambda$</li>
<li>隐藏 0 时，该块的黑色像素的个数应属于 $[R_1,R_1+\lambda]$</li>
<li>隐藏 1 时，该块的黑色像素的个数应属于 $[R_0-\lambda,R_0]$</li>
</ul>
</li>
<li>
<p>标识无效块：如果为了适应所嵌入的比特，目标块必须修改太多的像素，就把该块设为无效</p>
<ul>
<li>将无效块中的像素进行少量的修改，使得其中黑色像素的百分比大于 $R_1+3\lambda$，或者小于 $R_0-3\lambda$</li>
</ul>
</li>
<li>
<p>提取：判断每一个图像块黑色像素的百分比，如果大于 $R_1+3\lambda$，或者小于 $R_0-3\lambda$，则跳过这样的无效块；如果在 $[R_1,R_1+\lambda]$ 或 $[R_0-\lambda,R_0]$ 的范围内，则正确提取出秘密信息 0 或 1。</p>
</li>
<li>
<p>简易算法：将原图划分为 $1\times4$ 的矩形像素块，每个区域有四个连续的像素点。这些像素点的取值情况可以分为 5 类：全白，1 个黑像素点，2 个黑像素点，3 个黑像素点和全黑。</p>
<table>
  <thead>
      <tr>
          <th style="text-align: center">黑像素个数</th>
          <th style="text-align: center">0</th>
          <th style="text-align: center">1</th>
          <th style="text-align: center">2</th>
          <th style="text-align: center">3</th>
          <th style="text-align: center">4</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center">像素分布</td>
          <td style="text-align: center">全白</td>
          <td style="text-align: center">1 黑 3 白</td>
          <td style="text-align: center">2 黑 2 白</td>
          <td style="text-align: center">3 黑 1 白</td>
          <td style="text-align: center">全黑</td>
      </tr>
      <tr>
          <td style="text-align: center">含义</td>
          <td style="text-align: center">无效块</td>
          <td style="text-align: center">隐藏 1</td>
          <td style="text-align: center">不能出现</td>
          <td style="text-align: center">隐藏 0</td>
          <td style="text-align: center">无效块</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>要隐藏的信息位文本文档中的字符串，需注意：</p>
<ul>
<li>嵌入的信息长度不能过大，不能超过图片大小所能负担的度量</li>
<li>为了简化过程，可以规定接收者已知秘密信息的长度</li>
</ul>
</blockquote>
<ul>
<li>
<p>嵌入：遍历原图中的每个 $1\times4$ 矩阵区域</p>
<ul>
<li>如果要嵌入的信息为 0，则需要将当前区域的黑像素点数量调整到 3 个
<ul>
<li>如果当前区域黑像素点数量正好为 3 个，则不需要修改</li>
<li>如果当前区域黑像素点数量为 1 或 2 或 4 个，则需要进行修改，使其黑色像素点数量变为 3 个，同时要注意的是，对原有黑色像素直接利用，位置不做修改，为的是嵌入秘密信息的过程中，对图片的修改尽量少</li>
<li>如果原区域全白，则舍弃这一块不做修改，否则变化可能被直观视觉所感受到</li>
</ul>
</li>
<li>如果要嵌入的信息为 1，则需要将当前区域的黑像素点数量调整到 1 个
<ul>
<li>如果当前区域黑像素点数量正好为 1 个，则不需要修改</li>
<li>如果当前区域黑像素点数量为 0 或 2 或 3 个，则需要进行修改，使其黑色像素点数量变为 1 个，同时要注意的是，对原有黑色像素直接利用，多余的翻转为白像素，为的是嵌入秘密信息的过程中，对图片的修改尽量少</li>
<li>如果原区域全黑，则舍弃这一块不做修改，否则变化可能被直观视觉所感受到</li>
</ul>
</li>
</ul>
</li>
<li>
<p>提取：嵌入过信息的图像中每个区域的黑色像素点个数只有 4 个取值：0、1、3、4.遍历携带图像的每个 $1\times4$ 区域，如果黑色像素点个数为 1 或 3 则提取信息，1 个黑像素点对应 1，3 个黑像素点对应 0，其余为为嵌入信息的区域。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-matlab" data-lang="matlab"><span class="line"><span class="cl"><span class="k">for</span> <span class="nb">j</span> <span class="p">=</span> <span class="n">c</span><span class="p">:</span><span class="n">cc</span> <span class="c">% 统计区域内黑块的个数</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">bw</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="nb">j</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">		<span class="n">blk</span> <span class="p">=</span> <span class="n">blk</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="c">% 要嵌入的消息为 0，修改使黑色变为 3 个</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">bin_msg</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="n">blk</span> <span class="o">==</span> <span class="mi">1</span> <span class="c">% 1 个黑色素</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="n">bw</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="c">% 黑色素位于第一个位置</span>
</span></span><span class="line"><span class="cl">			<span class="n">bw</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="n">bw</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">elseif</span> <span class="n">bw</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="c">% 黑色素位于第二个位置</span>
</span></span><span class="line"><span class="cl">    	<span class="n">bw</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    	<span class="n">bw</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">elseif</span> <span class="c">...... % 黑色素位于第三个位置</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="c">...... % 黑色素位于第四个位置</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">elseif</span> <span class="n">blk</span> <span class="o">==</span> <span class="mi">2</span> <span class="c">% 2 个黑色素</span>
</span></span><span class="line"><span class="cl">  <span class="k">elseif</span> <span class="n">blk</span> <span class="o">==</span> <span class="mi">3</span> <span class="c">% 3 个黑色素</span>
</span></span><span class="line"><span class="cl">  <span class="k">elseif</span> <span class="n">blk</span> <span class="o">==</span> <span class="mi">4</span> <span class="c">% 4 个黑色素（全白块）</span>
</span></span><span class="line"><span class="cl">  	<span class="n">randnum</span> <span class="p">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  	<span class="k">if</span> <span class="n">randnum</span> <span class="o">==</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">  		<span class="n">bw</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">elseif</span> <span class="n">randnum</span> <span class="o">==</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    	<span class="n">bw</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c">......</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">  <span class="k">elseif</span> <span class="n">blk</span> <span class="o">==</span> <span class="mi">0</span> <span class="c">% 黑色为 0 个，舍弃这一块</span>
</span></span><span class="line"><span class="cl">  	<span class="n">ind</span> <span class="p">=</span> <span class="n">ind</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span> <span class="c">% 要嵌入的信息为 1，需要修改使黑色为 1 个</span>
</span></span><span class="line"><span class="cl">	<span class="c">......</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
<p>游程编码：</p>
<ul>
<li>编码：$&lt;a_0, 3&gt;&lt;a_1,5&gt;&lt;a_2,4&gt;&lt;a_3,2&gt;&lt;a_4,1&gt;$</li>
<li>嵌入：修改二值图像的游程长度
<ul>
<li>如果秘密信息位是 0，则修改该游程长度为偶数</li>
<li>如果为 1，则修改为奇数</li>
<li>如果秘密信息的取值与游程长度的奇偶性想匹配，则不改变游程长度</li>
</ul>
</li>
<li>提取：根据游程长度的奇偶性提取出秘密信息</li>
</ul>
<h2 id="57-dct-域的信息隐藏">5.7 DCT 域的信息隐藏<a hidden class="anchor" aria-hidden="true" href="#57-dct-域的信息隐藏">#</a></h2>
<p>变换域技术：在载体的显著区域隐藏信息，比 LSB 方法能够更好地抵抗攻击，而且还保持了对人类感观的不可察觉性。</p>
<ul>
<li>常用的变换域方法：
<ul>
<li>离散余弦变换（DCT）</li>
<li>离散小波变换（DWT）</li>
<li>离散傅里叶变换（DFT）</li>
</ul>
</li>
</ul>
<p>图像压缩标准（JPEG）的核心：二维 DCT 变换。在 DCT 域中的信息隐藏，可以有效地抵抗 JPEG 有损压缩。</p>
<p>二维 DCT 变换：图像分为 $8\times8$ 的像素块，进行二维 DCT 变换，得到 $8\times8$ 的 DCT 系数。最左上角的那个洗漱为直流系数，其余为交流系数。左上角的部分为直流和低频，右下角的部分为高频，中间区域为中频。中频系数包含了图像的大部分能量，是对人的视觉最重要的部分。</p>
<p><img loading="lazy" src="https://github.com/lxmliu2002/images/raw/main/post/20240227/image-20240227152357732.png"></p>
<p>DCT 与 Zig-Zag 扫描顺序：转换 2-D 系数区块成 1-D 系数，系数按照 Zig-Zag 次序排列。</p>
<p><img loading="lazy" src="https://github.com/lxmliu2002/images/raw/main/post/20240227/image-20240227152519192.png"></p>
<p>基本隐藏算法：以一定的方式挑选一些中频系数，在这些中频系数中叠加秘密信息：</p>
<ul>
<li>所有中频系数</li>
<li>固定位置的中频系数</li>
<li>随机挑选中频系数</li>
<li>选择最大的几个中频系数</li>
</ul>
<ol>
<li>在选出的中频系数中叠加秘密信息 $x&rsquo;(i,j)=x(i,j)+\alpha m_i$，$x(i,j)$ 为 DCT 系数，$x&rsquo;(i,j)$ 为隐藏后的 DCT 系数，$m_i$ 为第 i 个秘密信息比特，$\alpha$ 为可调参数，控制嵌入强度。</li>
<li>在选出的中频系数中叠加秘密信息 $x&rsquo;(i,j)=x(i,j)(1+\alpha m_i)$
<ol>
<li>每个系数上嵌入的强度相同</li>
<li>根据系数的大小成比例地嵌入</li>
</ol>
</li>
</ol>
<blockquote>
<p>上述的两个算法的提取都需要原始图像</p>
</blockquote>
<ol start="3">
<li>
<p>不需要原始载体的隐藏方法：利用载体中两个特定数的相对大小来代表隐藏的信息</p>
<ul>
<li>嵌入：载体图像分为 $8\times8$ 的块，做二维 DCT 变换，伪随机地选择一个图像块 $B_i$，分别选择其中的两个位置，比如用 $(u_1,v_1)$ 和 $(u_2,v_2)$ 代表所选定的两个系数的坐标。
<ul>
<li>如果 $B_i(u_1,v_1)&gt;B_i(u_2,v_2)$，代表隐藏 1；如果相反，则交换两系数</li>
<li>如果 $B_i(u_1,v_1)&lt;B_i(u_2,v_2)$，代表隐藏 0；如果相反，则交换两系数</li>
<li>最后做二维 DCT 逆变换</li>
</ul>
</li>
<li>提取：接收者进行二维 DCT 变换，比较每一块中约定位置的 DCT 系数值，根据其相对大小，得到隐藏信息的比特串，从而恢复出秘密信息。</li>
<li>特点：不需要原始图像</li>
<li>注意：如果选定位置的两个系数相差太大，则对图像影响较大，应选择相近的值（如中频系数）</li>
</ul>
</li>
<li>
<p>算法三的扩展：利用 DCT 中频系数中的三个系数之间的相对关系来对秘密信息进行编码</p>
<ul>
<li>
<p>嵌入：选择三个位置  $(u_1,v_1),\  (u_2,v_2),\ (u_3,v_3)$</p>
<ul>
<li>嵌入 1：令 $B_i(u_1,v_1)&gt;B_i(u_3,v_3)+D$，$B_i(u_2,v_2)&gt;B_i(u_3,v_3)+D$</li>
<li>嵌入 0：令 $B_i(u_1,v_1)&lt;B_i(u_3,v_3)-D$，$B_i(u_2,v_2)&lt;B_i(u_3,v_3)-D$</li>
</ul>
<blockquote>
<p>如果数据不符，就修改这三个系数值，使得它们满足上述关系。其中参数 D 的选择要考虑隐藏的健壮性和不可察觉性之间的平衡，D 越大，隐藏算法对于图像处理就越健壮，但是对图像的改动就越大，越容易引起察觉。</p>
<p>如果需要做的修改太大，则放弃该块，将其标识为“无效”。即，满足如下条件之一：</p>
<ul>
<li>$B_i(u_1,v_1)\le B_i(u_3,v_3)\le B_i(u_2,v_2)$</li>
<li>$B_i(u_2,v_2)\le B_i(u_3,v_3)\le B_i(u_1,v_1)$</li>
</ul>
</blockquote>
</li>
<li>
<p>提取：对图像进行 DCT 变换，比较每一块相应三个位置的系数，从它们之间的关系，可以判断隐藏的是信息 1、0 还是无效块，这样就可以恢复秘密信息。</p>
</li>
</ul>
</li>
</ol>
<h2 id="58-dwt-域的信息隐藏">5.8 DWT 域的信息隐藏<a hidden class="anchor" aria-hidden="true" href="#58-dwt-域的信息隐藏">#</a></h2>
<p>二维小波分解，一级小波分解后得到的四个部分：</p>
<ul>
<li>左上：低频近似部分（图像的主要能量集中）</li>
<li>右上：水平方向细节部分</li>
<li>左下：垂直方向细节部分</li>
<li>右下：对角线方向细节部分</li>
</ul>
<ol>
<li>修改系数方法：在选出的中频系数中叠加秘密信息 $x&rsquo;(i,j)=x(i,j)(1+\alpha m_i)$</li>
<li>系数比较方法：选择三个位置  $(u_1,v_1),\  (u_2,v_2),\ (u_3,v_3)$
<ul>
<li>嵌入 1：令 $B_i(u_1,v_1)&gt;B_i(u_3,v_3)+D$，$B_i(u_2,v_2)&gt;B_i(u_3,v_3)+D$</li>
<li>嵌入 0：令 $B_i(u_1,v_1)&lt;B_i(u_3,v_3)-D$，$B_i(u_2,v_2)&lt;B_i(u_3,v_3)-D$</li>
<li>如果数据不符，则修改这三个系数值，方法为：选 $D = 0.5$，系数调整为均值和均值 $\pm D$。即令 $B_i(u_j,v_j)$ 为嵌入水印前系数，$B&rsquo;_i(u_j,v_j)$ 为嵌入水印后系数。$m=(B_i(u_1,v_1)+B_i(u_2,v_2)+B_i(u_3,v_3))/3$
<ul>
<li>若嵌入 1，调整为 $B&rsquo;_i(u_1,v_1)=B&rsquo;_i(u_3,v_3)=m+D; \ B&rsquo;_i(u_2,v_2)=m$</li>
<li>若嵌入 0，调整为 $B&rsquo;_i(u_1,v_1)=B&rsquo;_i(u_3,v_3)=m-D; \ B&rsquo;_i(u_2,v_2)=m$</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="59-文件格式隐藏法">5.9 文件格式隐藏法<a hidden class="anchor" aria-hidden="true" href="#59-文件格式隐藏法">#</a></h2>
<p>原理：在文件格式中找到某些不影响载体文件的位置，嵌入要隐藏的数据。</p>
<p>BMP 文件的数据按照从文件头开始的先后顺序分为四个部分：</p>
<ul>
<li>bmp 文件头：提供文件的格式、大小等信息</li>
<li>位图信息头：提供图像数据的尺寸、位平面数、压缩方式、颜色索引等信息</li>
<li>调色板：可选</li>
<li>位图数据：就是图像数据</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">                                 选定载体图像文件
</span></span><span class="line"><span class="cl">                                       <span class="p">|</span>
</span></span><span class="line"><span class="cl">                                       v
</span></span><span class="line"><span class="cl">秘密数据 -&gt; 数据压缩 -&gt; 数据加密 -&gt; 写入图像文件某位置 -&gt; 修改文件头数据
</span></span></code></pre></td></tr></table>
</div>
</div><p>文件存取工具在保存文档时可能会造成隐藏数据的丢失。因此利用文件格式进行信息伪装 的方法是不太安全的。</p>
<h2 id="510-统计隐藏技术与变形技术">5.10 统计隐藏技术与变形技术<a hidden class="anchor" aria-hidden="true" href="#510-统计隐藏技术与变形技术">#</a></h2>
<p>统计隐藏技术：</p>
<ul>
<li>原理：对载体的某些统计特性进行明显的修改，表示嵌入信息 1，若统计特性不变，则表示嵌入信息 0。接收者在不知道原始载体的情况下，根据统计特性的改变，提取信息。</li>
<li>载体为灰度图像，把图像分为 $L(m)$ 个不重叠的载体块 $B_i$，其中包含的像素集合为 ${p_{n,m}^{(i)}}$。</li>
<li>伪装密钥 $S={S_{n,m}^{(i)}}$ 是同样尺寸的伪随机二值图案，并且 S 中 0 和 1 的个数相等。</li>
<li>嵌入：把图像块 $B_i$ 按照 S 分成同样大小的两个集合 $C_i$ 和 $D_i$，规则为对应 $S_{n,m}$ 为 1 的那些像素点放入集合 $C_i$，而对应 $S_{n,m}$ 为 0 的那些像素点放入集合 $D_i$，然后发送者对子集 $C_i$ 的所有像素加上一个值 $k(k&gt;0)$，而 $D_i$ 中的像素不变。最后合并 $C_i$ 和 $D_i$，形成加了标记的图像块 $B_i$。</li>
<li>提取：接收者利用伪装密钥 $S$，可以重构集合 $C_i$ 和 $D_i$。如果块 $B_i$ 中加了标记，那么 $C_i$ 中的所有值比嵌入之前大，计算集合 $C_i$ 和 $D_i$ 的均值之差
<ul>
<li>如果均值之差大于一个阈值，则认为嵌入了比特 1</li>
<li>否则为 0</li>
</ul>
</li>
</ul>
<p>变形技术：</p>
<ul>
<li>原理：对载体进行某种修改，其修改方式与需要嵌入的秘密信息比特相关联，通过比较修改后的载体与原始载体的差别来提取隐藏信息。（对载体的修改应不易察觉）</li>
<li>应用：
<ul>
<li>在格式化文本中嵌入信息：利用文本的排列或者文档的布局来隐藏信息。</li>
<li>行间距编码：
<ul>
<li>嵌入：在行间距编码中，行的位置根据秘密信息位进行上移或下移。为了检测时达到同步，需要保持一些行不变，如隔行不变。</li>
<li>提取：可以使用质心检测法（质心定义为水平轴上一行的中心），计算移动行的质心与上下不动行质心之间的距离。</li>
</ul>
</li>
<li>字间距编码：根据秘密信息位，改变载体文本的两个单词间的水平距离，以隐藏信息。</li>
<li>空格宽度编码</li>
</ul>
</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://lxmliu2002.github.io/tags/ctf/">CTF</a></li>
      <li><a href="https://lxmliu2002.github.io/tags/%E4%BF%A1%E6%81%AF%E9%9A%90%E8%97%8F%E6%8A%80%E6%9C%AF/">信息隐藏技术</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://lxmliu2002.github.io/posts/%E4%BF%A1%E6%81%AF%E9%9A%90%E8%97%8F%E6%8A%80%E6%9C%AF_6/">
    <span class="title">« Prev</span>
    <br>
    <span>信息隐藏技术_6</span>
  </a>
  <a class="next" href="https://lxmliu2002.github.io/posts/%E4%BF%A1%E6%81%AF%E9%9A%90%E8%97%8F%E6%8A%80%E6%9C%AF_4/">
    <span class="title">Next »</span>
    <br>
    <span>信息隐藏技术_4</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 信息隐藏技术_5 on x"
            href="https://x.com/intent/tweet/?text=%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e6%8a%80%e6%9c%af_5&amp;url=https%3a%2f%2flxmliu2002.github.io%2fposts%2f%25E4%25BF%25A1%25E6%2581%25AF%25E9%259A%2590%25E8%2597%258F%25E6%258A%2580%25E6%259C%25AF_5%2f&amp;hashtags=CTF%2c%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e6%8a%80%e6%9c%af">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 信息隐藏技术_5 on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2flxmliu2002.github.io%2fposts%2f%25E4%25BF%25A1%25E6%2581%25AF%25E9%259A%2590%25E8%2597%258F%25E6%258A%2580%25E6%259C%25AF_5%2f&amp;title=%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e6%8a%80%e6%9c%af_5&amp;summary=%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e6%8a%80%e6%9c%af_5&amp;source=https%3a%2f%2flxmliu2002.github.io%2fposts%2f%25E4%25BF%25A1%25E6%2581%25AF%25E9%259A%2590%25E8%2597%258F%25E6%258A%2580%25E6%259C%25AF_5%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 信息隐藏技术_5 on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2flxmliu2002.github.io%2fposts%2f%25E4%25BF%25A1%25E6%2581%25AF%25E9%259A%2590%25E8%2597%258F%25E6%258A%2580%25E6%259C%25AF_5%2f&title=%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e6%8a%80%e6%9c%af_5">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 信息隐藏技术_5 on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2flxmliu2002.github.io%2fposts%2f%25E4%25BF%25A1%25E6%2581%25AF%25E9%259A%2590%25E8%2597%258F%25E6%258A%2580%25E6%259C%25AF_5%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 信息隐藏技术_5 on whatsapp"
            href="https://api.whatsapp.com/send?text=%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e6%8a%80%e6%9c%af_5%20-%20https%3a%2f%2flxmliu2002.github.io%2fposts%2f%25E4%25BF%25A1%25E6%2581%25AF%25E9%259A%2590%25E8%2597%258F%25E6%258A%2580%25E6%259C%25AF_5%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 信息隐藏技术_5 on telegram"
            href="https://telegram.me/share/url?text=%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e6%8a%80%e6%9c%af_5&amp;url=https%3a%2f%2flxmliu2002.github.io%2fposts%2f%25E4%25BF%25A1%25E6%2581%25AF%25E9%259A%2590%25E8%2597%258F%25E6%258A%2580%25E6%259C%25AF_5%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 信息隐藏技术_5 on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e6%8a%80%e6%9c%af_5&u=https%3a%2f%2flxmliu2002.github.io%2fposts%2f%25E4%25BF%25A1%25E6%2581%25AF%25E9%259A%2590%25E8%2597%258F%25E6%258A%2580%25E6%259C%25AF_5%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>© <a href="https://github.com/lxmliu2002">lxmliu2002</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
