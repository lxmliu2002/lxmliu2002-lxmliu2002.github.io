<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Posts | lxmliu2002&#39;s Blog</title>
<meta name="keywords" content="">
<meta name="description" content="Posts - lxmliu2002&#39;s Blog">
<meta name="author" content="lxmliu2002">
<link rel="canonical" href="https://lxmliu2002.github.io/posts/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css" integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://lxmliu2002.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://lxmliu2002.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://lxmliu2002.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://lxmliu2002.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://lxmliu2002.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://lxmliu2002.github.io/posts/index.xml">
<link rel="alternate" hreflang="en" href="https://lxmliu2002.github.io/posts/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://lxmliu2002.github.io/posts/">
  <meta property="og:site_name" content="lxmliu2002&#39;s Blog">
  <meta property="og:title" content="Posts">
  <meta property="og:description" content="lxmliu2002&#39;s Blog">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Posts">
<meta name="twitter:description" content="lxmliu2002&#39;s Blog">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://lxmliu2002.github.io/posts/"
    }
  ]
}
</script>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lxmliu2002.github.io/" accesskey="h" title="lxmliu2002&#39;s Blog (Alt + H)">lxmliu2002&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://lxmliu2002.github.io/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://lxmliu2002.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://lxmliu2002.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://lxmliu2002.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://lxmliu2002.github.io/" title="homepage">
                    <span>homepage</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header"><div class="breadcrumbs"><a href="https://lxmliu2002.github.io/">Home</a></div>
  <h1>
    Posts
    <a href="/posts/index.xml" title="RSS" aria-label="RSS">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
        stroke-linecap="round" stroke-linejoin="round" height="23">
        <path d="M4 11a9 9 0 0 1 9 9" />
        <path d="M4 4a16 16 0 0 1 16 16" />
        <circle cx="5" cy="19" r="1" />
      </svg>
    </a>
  </h1>
</header>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Markdown Syntax Guide For L2
    </h2>
  </header>
  <div class="entry-content">
    <p>This article offers a sample of basic Markdown syntax that can be used in Hugo content files, also it shows whether basic HTML elements are decorated with CSS in a Hugo theme.
...</p>
  </div>
  <footer class="entry-footer"><span title='2019-03-11 00:00:00 +0000 UTC'>March 11, 2019</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Hugo Authors</footer>
  <a class="entry-link" aria-label="post link to Markdown Syntax Guide For L2" href="https://lxmliu2002.github.io/posts/markdown-syntax.fr/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Markdown Syntax Guide For RTL
    </h2>
  </header>
  <div class="entry-content">
    <p>This article offers a sample of basic Markdown syntax that can be used in Hugo content files, also it shows whether basic HTML elements are decorated with CSS in a Hugo theme.
...</p>
  </div>
  <footer class="entry-footer"><span title='2019-03-11 00:00:00 +0000 UTC'>March 11, 2019</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Hugo Authors</footer>
  <a class="entry-link" aria-label="post link to Markdown Syntax Guide For RTL" href="https://lxmliu2002.github.io/posts/markdown-syntax.fa/"></a>
</article>

<article class="post-entry"> 
<figure class="entry-cover"><img loading="lazy" src="https://github.com/lxmliu2002/images/raw/main/homepage/home-bg-secret_flow.png" alt="">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">联邦学习_d1
    </h2>
  </header>
  <div class="entry-content">
    <p>第 1 课：数据可信流通：从运维信任到技术信任 建立数据来源可确认、使用范围可界定、流通过程可追溯、安全风险可防范的数据可信流通体系
信任的基石：
身份可确认 利益可依赖 能力有预期 行为有后果 内循环（传统数据安全的信任基础）：数据持有方在自己的运维安全域内对自己的数据使用和安全拥有全责 外循环：责任主体不清，利益诉求不一致，能力参差不齐，责任链路难追溯 技术信任：
可信数字应用身份 使用权跨域管控：利益对齐的核心技术要求 能力预期与不可能三角：安全要求，功能复杂度，单位成本 全链路审计，闭环完成的数据可信流通体系 </p>
  </div>
  <footer class="entry-footer"><span title='2024-07-15 00:00:00 +0000 UTC'>July 15, 2024</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;lxmliu2002</footer>
  <a class="entry-link" aria-label="post link to 联邦学习_d1" href="https://lxmliu2002.github.io/posts/%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0_d1/"></a>
</article>

<article class="post-entry"> 
<figure class="entry-cover"><img loading="lazy" src="https://github.com/lxmliu2002/images/raw/main/homepage/home-bg-03.jpg" alt="">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">PaperReading_How_Machine_Learning_Is_Solving_the_Binary_Function_Similarity_Problem
    </h2>
  </header>
  <div class="entry-content">
    <p>How Machine Learning Is Solving the Binary Function Similarity Problem 通读 Abstract 精确计算两段二进制代码之间的相似度的能力在许多不同的问题中起着重要的作用。本文对该领域的最新技术进行评估研究。首先将其系统化，确定了代表三个不同社区新提出的解决方案。本文重新实现这些方案并使用不同编译器、优化选项和三种不同编译架构创建了一个新数据集。以此系统评估二进制相似度方法。
Introduction 二元函数相似度是指将一对函数的二进制表示作为输入，生成一个数值表示二者间的相似性。但是，不同的编译工具链、优化选项等，会使得简单的判定方法失效。
Challenges 第一个挑战是目前既不能重现也不能复制以前的结果。由于重新实现以前的技术非常复杂且非常耗时，因此每个解决方案通常只与以前的几个技术进行比较，这些技术有时甚至不是为了解决相同的问题而设计的，并且在某些极端情况下，只与同一作者的先前论文进行比较。
第二个挑战是评估结果往往是不透明的。不同的解决方案通常是针对略有不同的目标（搜索漏洞 vs. 发现类似的恶意软件样本)，在不同的设置（交叉编译器 vs. 交叉架构)，通过使用不同的相似性概念（相同的代码 vs. 相同的语义)，并在不同的粒度（代码片段 vs. 整个函数)操作。实验也在不同大小和性质的数据集上进行（firmware vs. 命令行实用程序)，并通过使用不同的指标（ROC 曲线 vs. top-n vs. MRR10)报告结果。因此每篇论文中的数值都无法直接比较。而且，不同的论文并不指明特定情景，且不说明其过滤掉细节、如何进行训练等，使得其难以再现。
不同的环境的可靠性实际上是如何影响性能是不得知的，即不清楚给定方法的优越结果是否与一些新的贡献有关。这两个挑战的综合影响导致形成了一个极其碎片化的领域，存在数十种技术，但没有明确了解哪种技术在哪种环境下有效（或无效）。这给我们带来了最后一个挑战：很难理解二进制相似性研究的方向。每个新的解决方案都采用了一种更复杂的技术，或者是多种技术的新组合，很难判断这是由更简单方法的实际限制驱动的，还是由需要说服审稿人相信每个工作的新颖性驱动的。这种碎片化通常会导致平行和不相交的研究方向，每个人都声称具有最佳的解决方案。这种碎片化也导致了评估和方法次优的论文。
Contributions 本文对该研究领域进行了一个系统评估。首先探索现有的研究，并根据所采用的方法对每个解决方案进行分组，特别关注最近基于机器学习的成功技术。然后选择、比较和实现十种最具代表性的方法及其可能的变体。这些方法代表了广泛的趋势，跨越了三个不同的研究社区：计算机安全，编程语言分析，以及机器学习社区。为了使得比较有意义，本文对实现建立在一个共同的框架之上。并利用并行编程和高效的编码技术避免对模型性能产生负面瓶颈。
通过重新实现各种方法（不一定是“论文”），本文分离出现有的“原语”，并在单独使用或相互结合使用时对它们进行评估，以获得见解并确定隐藏在先前作品复杂性中的重要因素，并回答各种开放的研究问题。为了使评估工作更具可比性，本文还提出了一个新的数据集，作为不同方面（如编译器系列、优化和体系结构)的通用基准。
本文侧重于评估迄今为止提出的主要技术，而非重现论文报告中的准确数据。
本文还发现了几个有趣的见解。例如，我们发现，虽然简单的方法（例如，模糊散列）在简单的设置中工作得很好，但在处理更复杂的场景时（例如跨架构数据集，或多个变量同时变化的数据集），它们就失败了。在机器学习模型中，基于图神经网络的模型在几乎所有任务中都取得了最好的结果，并且在比较推理时间时是最快的。另一个有趣的发现是，许多最近发表的论文在同一数据集上进行测试时都具有非常相似的准确性，尽管有几篇论文声称在技术水平上有所改进。
虽然我们不声称我们的代码或数据集比以前的作品更好或更有代表性，但我们发布了我们的模块化框架，重新实现了所有选定的方法，完整的数据集，以及如何重新创建和调整它的详细说明通过允许社区对单个组件进行实验并直接相互比较，我们希望鼓励和减轻未来对接近这一活跃研究领域感兴趣的研究人员的努力。
The Binary Function Similarity Problem 在其最简单的形式中，二进制函数相似性旨在计算一个数值，该数值捕获一对函数在其二进制表示中的“相似性”，即由编译器生成的构成函数体的原始字节（即机器代码)。请注意，在本文中，我们关注的是使用函数作为代码单元的方法，研究人员也研究了专注于低级抽象（例如，基本块)或高级抽象（例如，整个程序)的技术。根据我们的定义，两个“相似”函数可能具有截然不同的二进制表示——这就是这使得这个研究问题变得有趣且具有挑战性的原因。
二进制函数相似度已经在一百多篇论文中得到了研究。使情况更加复杂的是，大多数现有的方法不能映射到单一的技术类别，因为它们通常构建在不同的组件之上。在此，专注于这些方法组合的不同构建块，首先查看计算相似性的技术，然后查看这些方法可以利用的输入数据类型。
Measuring Function Similarity Direct vs. indirect comparison 我们可以将测量函数相似性的技术分为两大类。第一类解决方案通过考虑原始输入数据或实现某种特征提取来实现函数对的直接比较。这些解决方案通常需要了解两个看似不相关的值可以表示相似的函数，反之亦然，接近的值不一定表示相似的东西。当从二进制函数中提取的特征不能通过使用基本相似性度量直接进行比较时，就会出现这种情况，因为它们可能没有在线性空间中表示，或者可能在相似性得分上没有等效的权重。因此，研究人员建议使用机器学习模型来确定两个函数是否相似，并给出一组提取的特征作为输入。有几种方法可以通过利用贝叶斯网络、卷积神经网络、图匹配网络（GMN）、规则前馈神经网络或它们的组合来实现这种类型的相似性。在这些情况下，该模型用于输出一对函数之间的相似性得分。
为了找到类似的函数，这些方法需要搜索整个数据集，并将查询函数的特征与数据集中的每个条目进行比较，这不是一个可扩展的解决方案。出于这个原因，许多方法实现了索引策略，通过诸如基于树的数据结构、局部敏感散列（近似最近邻搜索）、bloom 过滤器、基于更简单数据的自定义预过滤器、聚类技术，甚至分布式搜索方法（如 map-reduce）来预过滤潜在的相似候选。
第二类解决方案实现了间接比较技术。这些方法将输入特征映射为“浓缩”的低维表示，可以使用距离度量（如欧几里得距离或余弦距离）轻松地相互比较。这些解决方案允许高效的一对多比较。例如，如果需要将一个新函数与整个数据集进行比较，可以首先将存储库中的每个函数映射到其各自的低维表示（这是一次性操作），然后对新函数执行相同的操作，最后通过使用近似最近邻等有效技术比较这些表示。
Fuzzy hashes and embeddings. 低维表示的一个流行的例子是模糊散列。模糊哈希是由与传统加密哈希不同的算法产生的，因为它们被有意设计为将类似的输入值映射到类似的哈希。结论是输入原始字节的微小变化会显著影响生成的散列。然而，即使普通模糊哈希可能不适合函数相似性，一些方法（如 FunctionSimSearch）已经提出了更专门的哈希技术来比较两个函数。
另一种流行的低维表示形式依赖于 embeddings。这个术语在机器学习社区中很流行，指的是一个低维空间，在这个空间中，语义上相似的输入被映射到彼此接近的点，而不管输入在其原始表示中看起来有多么不同。机器学习模型的目标是学习如何产生 embeddings，使相似函数之间的相似性最大化，并使不同函数之间的相似性最小化。在文献中，我们可以识别出两种主要类型的 embeddings：一种试图总结每个函数的代码，另一种试图总结它们的图结构。
Code embeddings 许多研究者试图利用现有的自然语言处理（NLP）技术，通过将汇编代码作为文本处理来解决二值函数相似问题。这些解决方案处理 token 流（例如，指令、助记符、操作数、规范化指令），每个代码块输出一个 embedding，每个指令输出一个 embedding，或者两者都输出。第一类方法（如 Asm2Vec）基于 word2vec，这是自然语言处理领域的一种知名技术。尽管这些模型不是为跨架构嵌入生成而设计的，但它们可以同时在不同的指令集上进行训练，学习不同语言的语法（但不能跨语言映射语义)，或者它们可以应用于中间语言之上。第二种解决方案基于 seq2seq 编码器 - 解码器模型，该模型允许将不同架构的语义映射到相同的 embedding 空间，从而学习跨架构的相似性。第三种类型的模型建立在 BERT 之上，这是基于 NLP 中最先进的预训练模型。例如，OrderMatters 使用在四个任务上预训练的 BERT 模型来生成基本的块 embedding，而 Trex 使用分层转换器和掩码语言建模任务来学习近似的程序执行语义，然后将学习到的知识转移到识别语义相似的函数。
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-03-25 00:00:00 +0000 UTC'>March 25, 2024</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;lxmliu2002</footer>
  <a class="entry-link" aria-label="post link to PaperReading_How_Machine_Learning_Is_Solving_the_Binary_Function_Similarity_Problem" href="https://lxmliu2002.github.io/posts/paperreading_how_machine_learning_is_solving_the_binary_function_similarity_problem/"></a>
</article>

<article class="post-entry"> 
<figure class="entry-cover"><img loading="lazy" src="https://github.com/lxmliu2002/images/raw/main/homepage/home-bg-03.jpg" alt="">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">PaperReading_jTrans
    </h2>
  </header>
  <div class="entry-content">
    <p>jTrans: Jump-Aware Transformer for Binary Code Similarity Detection 通读 ABSTRACT 二进制代码相似性检测（Binary code similarity detection，BCSD）在漏洞分析、软件构建分析和逆向工程等领域有着重要应用。现有的工作表明深度神经网络（DNNs）可以理解二进制代码的指令或者是控制流图，并支持 BCSD。本文中，作者提出了一个新的基于 transformer 的方法 jTrans，来学习二进制代码的表示。这是第一个将二进制代码的控制流信息嵌入到基于 transformer 的语言模型中的解决方案，通过使用所分析的二进制代码的新的跳跃感知表示和新设计的预训练任务。
INTRODUCTION Binary code similarity detection(BCSD)可以识别两个二进制代码片段之间的相似程度，这有着广泛的应用，包括已知的漏洞发现，恶意软件检测和聚类，软件剽窃检测，补丁分析，以及软件供应链分析。
在机器学习应用到该领域之前，传统的 BCSD 严重依赖于手工提取的 CFG 特征，它可以捕获句法知识，如 bindiff 采用图同构技术来计算两个函数的 CFG 之间的相似性，但这种相似性可能会根据编译器的优化而改变，而注入 bingo 等方案通过计算 CFG 片段的相似性来实现对 CFG 变化的更大稳健性。这些手工特征很难捕捉到二进制代码的精确语义，因此仅具备较低的准确性。
一般来讲，这些解决方案是将目标二进制代码嵌入到向量中，并计算函数在向量空间的相似度。一些解决方案，如 Asm2Vec 和 SAFE，使用受自然语言处理（NLP）启发的语言模型来建模汇编语言(机器代码)。其他研究使用图神经网络 (GNNs) 来学习 CFGs 的表示并计算它们的相似性。一些研究结合了这两种方法，通过 NLP 技术学习基本块的表示，并通过 GNN 进一步处理CFG中的基本块特征。尽管性能有所提高，但现有方法有一些局限性。
首先，基于 NLP 的汇编语言建模只考虑了指令的顺序以及它们之间的关系；没有考虑有关程序实际执行（例如控制流）的信息。因此，仅依靠 NLP 的方法将缺乏对分析二进制文件的语义理解，而且也不能很好的适应代码中可能出现的重大变化，这些变化是编译器所带来的结果。
其次，仅依靠 CFG 会错过每个基本块中指令的语义。使用 GNN 来处理 CFG 只能捕获结构信息，且难以并行训练和使用。
第三，现有的解决方案的数据集不够大，不够多样化，缺乏一个通用的基准。
在本文中，提出了 jTrans，一种新颖的基于 Transformer 的模型，旨在解决上述问题并支持现实世界的二进制相似性检测。我们将捕获指令语义的 NLP 模型与捕获控制流信息的 CFG 相结合，以推断二进制代码的表示。将控制流信息融合到 Transformer 架构中
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-03-24 00:00:00 +0000 UTC'>March 24, 2024</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;lxmliu2002</footer>
  <a class="entry-link" aria-label="post link to PaperReading_jTrans" href="https://lxmliu2002.github.io/posts/paperreading_jtrans/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="next" href="https://lxmliu2002.github.io/posts/page/2/">Next&nbsp;2/7&nbsp;»
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
        <span>© <a href="https://github.com/lxmliu2002">lxmliu2002</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
