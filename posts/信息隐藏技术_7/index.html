<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>信息隐藏技术_7 | lxmliu2002&#39;s Blog</title>
<meta name="keywords" content="CTF, 信息隐藏技术">
<meta name="description" content="学习信息隐藏技术">
<meta name="author" content="lxmliu2002">
<link rel="canonical" href="https://lxmliu2002.github.io/posts/%E4%BF%A1%E6%81%AF%E9%9A%90%E8%97%8F%E6%8A%80%E6%9C%AF_7/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css" integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://lxmliu2002.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://lxmliu2002.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://lxmliu2002.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://lxmliu2002.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://lxmliu2002.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://lxmliu2002.github.io/posts/%E4%BF%A1%E6%81%AF%E9%9A%90%E8%97%8F%E6%8A%80%E6%9C%AF_7/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://lxmliu2002.github.io/posts/%E4%BF%A1%E6%81%AF%E9%9A%90%E8%97%8F%E6%8A%80%E6%9C%AF_7/">
  <meta property="og:site_name" content="lxmliu2002&#39;s Blog">
  <meta property="og:title" content="信息隐藏技术_7">
  <meta property="og:description" content="学习信息隐藏技术">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-02-29T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-02-29T00:00:00+00:00">
    <meta property="article:tag" content="CTF">
    <meta property="article:tag" content="信息隐藏技术">
    <meta property="og:image" content="https://github.com/lxmliu2002/images/raw/main/homepage/home-bg-information_hiding.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://github.com/lxmliu2002/images/raw/main/homepage/home-bg-information_hiding.jpg">
<meta name="twitter:title" content="信息隐藏技术_7">
<meta name="twitter:description" content="学习信息隐藏技术">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://lxmliu2002.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "信息隐藏技术_7",
      "item": "https://lxmliu2002.github.io/posts/%E4%BF%A1%E6%81%AF%E9%9A%90%E8%97%8F%E6%8A%80%E6%9C%AF_7/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "信息隐藏技术_7",
  "name": "信息隐藏技术_7",
  "description": "学习信息隐藏技术",
  "keywords": [
    "CTF", "信息隐藏技术"
  ],
  "articleBody": "七、数字水印技术 7.1 数字水印的形成和产生 数字水印的形式：\n一串有意义的字符 标注作品的所有者、创作日期、发行部门以及其他需要标注的信息，它们可以是明文字符，将这些字符串以比特流的形式嵌入数字作品中。 在提取水印时，按照提取算法提取出这些比特流，转换成字符串，就可以得到需要的水印信息。 在以明文字符做数字水印的情况下，需要考虑水印的稳健性。一般在将字符串作为水印嵌入数字作品之前，需要将水印首先进行纠错编码，对水印增加一些冗余度，使得它可以纠正由于一些小的误差引起的字符错误。 这一类数字水印，从水印形式上说，是稳健性较差的水印。 一串伪随机序列 克服了第一类水印的缺点，它不是直接将明文字符作为水印，而是将需要标识的信息与一个伪随机序列串对应起来。将伪随机数作为数字水印嵌入数字作品中。 在需要验证作品的所有权问题时，用相应的水印提取算法提取出数字水印，这时提取出的数字水印不需要与原来的水印完全一样，通过相关性检测就可以判断有没有水印存在。如果相关性很高，可以判断提取出的水印与原来的水印很相似，也就是存在水印。 利用相关性检测的水印，从水印的格式上来说，是稳健性比较好的水印。 一个可视的图片 第三类数字水印是一种可视图像，它可以是一个人的手写签名或者是一些字符，也可以是一个徽标****，以二值图像**（或灰度图像）的形式保存。 将这些二值图像（或灰度图像）变为比特串，作为数字水印嵌入作品中。水印提取时，也是提取这些比特串，并把它们复原成原图像。 在误码不是很大的情况下，它们所组成的二值图像仍然能够通过人眼来识别。 这一类水印主要是利用人眼的视觉冗余性，它可以容忍较大的比特误码。也是稳健性比较好的水印。 水印的稳健性：\n选择水印时应该考虑水印本身能够容忍一定的误码，比如第二类和第三类水印 设计水印算法时，要考虑水印算法的抗攻击能力，同时还要考虑水印检测方式 7.2 数字水印框架 数字水印的框架结构由两部分组成：\n水印嵌入过程\n$CPP$：对被保护的数字产品进行的预处理 $WPP$：对数字水印 $W$ 进行的预处理 $G$：数字水印嵌入算法 $CPP^{-1}$：$CPP$ 的逆操作 $C$：被保护的数字产品 $W$：水印信息 $K$：数字水印嵌入算法的密钥 $C_W$：嵌入数字水印后的数字产品 水印提取过程\n$D$：数字水印提取算法 $WRP$：对直接提取水印的算法，就是 $WPP$ 的逆操作。对判断绝对存在与否的算法，就是数字水印的判决算法 提取过程的两种输出： 直接提取水印 判断水印是否存在 提取过程中是否需要原始载体取决于嵌入算法 根据预处理的不同，水印方案可以分为：\n空间域水印（预处理为空操作） 变换域水印（预处理为各种变换） 水印算法设计的原则：\n稳健性 抵抗各种攻击 寻找不变量 7.3 图像数字水印技术 7.3.1 水印嵌入位置的选择 安全性问题：嵌入的水印不能被非法使用者轻易地提取出来，或者被轻易地擦除 对载体质量的影响问题：不能影响数字载体的使用，嵌入水印引起的失真，应该对人类的感观是不可察觉的 水印位置的选择：根据 Kerckhoffs 准则，一个安全的数字水印，其算法应该是公开的，其安全性应该建立在密钥的保密性的基础上，而不是算法是保密性上。为了防止水印被偶尔移去，或者被直截了当地提取出水印，可以采用选择水印在载体中嵌入的位置来达到目的。除了安全性方面，水印嵌入位置的选择对于载体的感观失真也起到了关键的作用。比如，人类视觉系统的敏感度随着图像纹理特征的变化而改变，因此需要考虑水印位置选择所引起的心理视觉问题。\n”拼凑“算法：根据密钥随机选择 n 哥像素对，更改它们的亮度值。$\\widetilde{a_i}=a_i+1 \\ \\ \\widetilde{b_i}=b_i-1$。在提取时，计算 $s=\\Sigma^{n}_{i=1}(\\widetilde{a_i}-\\widetilde{b_i})$。如果这个载体确实包含了水印，可以预计这个和为 2n，否则将近似为零。\n基于心理视觉考虑的水印嵌入位置选择：\n适合嵌入：对于图像而言，在纹理较复杂的地方以及物体的边缘区域，人类的视觉系统不太精确，也就是说对这些部分的失真不太敏感，因此在这些地方非常适合嵌入水印。 不适合嵌入：对于图像取值比较均匀的光滑区域，人眼对这些地方的失真非常敏感，因此这些地方不适合嵌入水印。 7.3.2 工作域的选择 数字水印的工作域选择\n空间域水印算法：拼凑算法、LSB 方法、选择图像的视觉不敏感区域等\n变换域水印算法：\nDFT 域：离散傅里叶变换的目的是将空间域的信号转换为频率域的信号，提供了信号的频谱能量分布和相位信息，因此，利用这一工具，可以根据需要有效地控制和调整信号的频率成分和相位成分。一个较为公认的离散傅里叶变换隐藏方法为在声音信号相位中的隐藏，它是利用了人耳对相位的不敏感性来实现的信息隐藏同样，对于数字水印，也可以采用类似的方法人在声音信号的相位中嵌入水印。\nDCT 域：大部分算法的核心是在中频区域选择多个三元组 $(A1,A2,A3)$，每个三元组嵌入 1 比特，通过调整三元组数据的相对大小来实现水印嵌入\nDCT 系数的特点： 直流分量和低频系数值较大，代表了图像的大部分能量，对它们做修改会影响图像的视觉效果; 高频系数值很小，去掉它们基本不引起察觉; 最好的水印嵌入区域就是在中频部分。 例：基于中国剩余定理的数字水印分存算法： DWT 域：\n例：邻近值算法——对小波系数进行编码\n水印加载\n水印提取\n嵌入：对于当前的系数值 x 和步长 a，根据水印比特的取值 0 或 1，修改 x 的值。\n嵌入 1 时，取 x 为最接近的偶数个 a 的值 嵌入 0 时，取 x 为最接近的奇数个 a 的值 提取：\nx/a 最接近偶数时，水印比特为 0 x/a 最接近奇数时，水印比特为 1 7.3.3 脆弱性数字水印技术 脆弱性数字水印技术：在保证多媒体信息一定感知质量的前提下，将数字、序列号、文字、图像标志等作为数字水印嵌入到多媒体数据中当多媒体内容受到怀疑时，可将该水印提取出来用于多媒体内容的真伪识别，并且指出篡改的位置，甚至攻击类型等。又称为易碎水印，图像载体发生变化，水印则受到破坏。\n特征：\n检测篡改：理想情况是能够提供破坏量的多少及修改的位置甚至能够分析篡改的类型，并能对篡改的内容进行恢复。 稳健性与脆弱性：水印是在满足一定稳健性条件下的脆弱（脆弱与半脆弱） 不可感知性 可靠性 分类：\n完全脆弱性水印：水印能够检测出任何对图像像素值进行改变的操作或对图像完整性的破坏。 半脆弱水印：水印能够允许图像有一定的改变，它是在一定程度上的完整性检验。 图像可视内容鉴别：水印对图像的主要特征进行真伪鉴别，即比前两类水印更加稳健。 自嵌入水印：把图像本身作为水印加入，不仅可以鉴别图像的内容，还可以部分恢复被修改的区域 按照实现方法不同分类：\n空间域方法：最早的空间域方法是基于 LSB 的方法，但这种仅仅修改图像最低有效位的方法不仅对噪声非常敏感，而且容易被破坏掉，同时这种方法不能容忍对图像的任何修改。另一种脆弱性水印，针对图像的7个最高有效位及尺寸，通过 Hash 函数运算来获得原始图像的某些特征，该特征与一有意义的二值水印图像经过异或操作，并经加密后，嵌入到图像的最低有效位。当图像内容受到怀疑时，首先将图像的 7 个最高有效位与图像尺寸，经过Hash运算后，得到某些特征，然后将图像最低有效位公开解密后的结果与该特征进行异或操作后，即从提出的水印可以非常直观地看出被篡改的区域。空间域方法的优点是能够嵌入较多的水印，但非常易于被精心设计的攻击所攻破。 变换域方法：在脆弱性数字水印研究中，变换域方法也有许多优点如许多脆弱性水印系统的应用场合是要求水印能抵抗有损压缩的，这在变换域中更容易实现，而且容易对图像被篡改的特征进行描绘。变换域方法突出的优点是能够较好地与现有的压缩标准（如JPEG，JPEG2000）结合起来，并且能够在容许一定压缩比的情况下，检测出发生的篡改并定位。由于嵌入水印的量比较有限，对篡改的定位一般是 $8\\times 8$ 大小的块，因此不如空间域水印定位准确。 图像认证：随着网络通信技术的迅速发展和多媒体数字产品的增多，对数字信息进行真实性和完整性认证变得日益紧迫和重要，其应用涉及电子政务、电子商务、国家安全、医院、司法、新闻出版、网络通信、科学研究、工程设计等各个领域，采用数字水印技术进行图像认证是一个方兴未艾的高新技术前沿课题，其迫切的市场需求和广泛的应用前景已吸引了众多的研究者投入到这一行列。\n7.4 软件数字水印技术 软件水印：把程序的版权信息和用户身份信息嵌入到程序中。软件(通常是一段可执行程序)与一般的数字产品不同，它不能在进行大量的、深层次的修改后仍保持原有的特征。软件水印与多媒体水印有本质的不同\n对软件水印的要求： 能够证明软件的产权所有者 具有鲁棒性。能够抵抗攻击、防止篡改，软件的正常压缩解压以及文件传输不会对水印造成破坏。 软件水印不应依赖于某一具体的体系结构 软件水印应该便于生成、分发以及识别 对软件已有功能和特征的影响在实际环境下可以忽略 软件水印的分类： 按照水印的嵌入位置： 代码水印：隐藏在程序的指令部分 数据水印：隐藏在数据中（如头文件、字符串和调试信息等） 根据水印被加载的时刻： 静态水印：存储在可执行程序代码中 静态代码水印：利用目标代码中包含冗余信息嵌入水印。比如:通过调整两条无依赖关系指令的顺序可以嵌 1bit 的水印信息。IBM 提出了一种把寄存器出入栈的顺序作为水印的方法，同样可以通过排列有多个分支的 case 语句的顺序来进行编码。 许多代码水印经不起简单的攻击，如调整指令的顺序 静态数据水印：将水印信息嵌入在程序的一些数据中，但是它很容易被迷乱攻击破坏。例如，把所有的数据分解成一系列数据，然后散布到整个程序中，这样代表水印信息的数据也被分解，增加了水印检测的困难程度;或者用一个产生这些数据的子程序来代替这些数据，这样在程序中就找不到该数据的原型，也就无法检测水印。 动态水印：保存在程序的执行状态中 Easter Egg 水印：通过一个输入产生输出。例如，输入一个字符串，屏幕上显示出版权信息或一幅画 主要问题：水印在程序中的位置容易找到，一旦输入正确信息，用 softice 这样的标准调试软件就可以跟踪程序执行情况，进而找到水印的位置，所以这种水印不是很安全。 数据结构水印：输入特定信息激发程序，把水印信息隐藏在堆、栈或者全局变量域等程序状态中。当所有信息都输完之后，通过检测程序变量的当前值来进行水印提取。可以安排一个提取水印信息的进程或者是在调试器下运行程序查看变量取值。 动态数据水印没有输出，而且水印的提取过程不是封装在应用程序中，因而不容易找到水印在程序中的位置，但是这种水印也经不住迷乱变换攻击。 执行状态水印：程序在特定的输入下运行时，对程序中指令的执行顺序进行编码生成水印。水印检测则通过控制地址和操作码顺序的统计特性来进行。 动态水印需要由预先输入，根据输入，程序会运行到某种状态，这些状态就代表水印 7.5 音频数字水印技术 音频信号的特点：\n在每个时间间隔内采样的点数要少得多 人耳听觉系统比人眼视觉系统灵敏得多 应该保持同步 提取时一般要求不需要原始音频信号 音频信号也有特殊的攻击 根据水印加载方式分类：\n时间域数字水印 LSB 方法 回声隐藏法 通过改变信号幅值的隐藏算法 变换域数字水印 傅氏变换 DCT 变换 小波变换 压缩域数字水印 在原始音频信号中嵌入 在音频编码器中嵌入，这种方法稳健性较高，但需要复杂的编码和解码过程，运算量大，实时性不好 在压缩后的音频数据流中直接嵌入，这种方法避免了复杂的编解码过程，但稳健性不高，而且能够嵌入的水印容量不大 其他类型 音频水印评价指标：\n透明性： MOS 值 信噪比 峰值信噪比 水印容量：也叫数据嵌入比，指单位长度的音频中可以隐藏的秘密信息量，通常用比特率来表示，单位为 bit/s 鲁棒性： 误码率 归一化系数 7.6 视频数字水印技术 视频信号的特点：\n每一帧是静止图像，但与图像又有很大不同 视频容量大，结构复杂，数据编码 攻击特殊：如帧平均、帧剪切、帧重组、掉帧、速率改变等 要达到算法的实时性，必须降低算法复杂度 对视频水印的要求：\n不可感知性 稳健性 复杂度（提取和检测应达到实时） 考虑视频的压缩编码 加入水印不应增加视频流码率 盲检测：水印检测时不应需要原始视频 视频水印的分类：\n按水印技术是否与内容相关分类\n第一代视频水印：与视频内容无关 MPEG-1 和 MPEG-2：帧内图 I，预测图 P，双向预测图 B 第二代视频水印：基于内容的视频水印 MPEG-4 标准首次以视频对象（Video Object）概念来实现基于内容的表示，视频对象主要被定义为画面分割出来的不同物体，通过运动信息、形状信息、纹理信息来描述。 按水印嵌入的策略分类\n在未压缩域中：移植静止图像的水印技术，结合视频帧结构特点形成适用于视频的水印方案 在视频编码器中：通过修改变换域系数，能得到较好的视频质量和较强的水印抵抗攻击能力，同时不会增加数据比特率 在视频码流中：最大优点就是不需要完全解码和再编码，提高了水印嵌入和提取的效率，但是能够嵌入的水印容量受到较大的限制，而且水印的嵌入有可能对视觉产生影响 按照视频载体采用的压缩编码标准分类\n基于 MPEG-1 或 MPEG-2 标准：如在未压缩域对视频帧进行水印嵌入，或者在视频压缩编码中进行嵌入修改，也有直接将水印信息嵌入到压缩码流中。 基于 MPEG-4 标准：先提取视频对象，然后选择视频对象的部分属性作变换，嵌入水印 基于其它压缩标准的视频水印 视频水印算法：\n视频水印嵌入策略：\n方案一，在原始视频流中嵌入水印\n优点：水印嵌入方法多，原则上图像水印方案均可应用于此，算法成熟，有稳健性水印、脆弱性水印等，可用于多种目的 缺点： 经过视频编码处理后，会造成部分水印信息丢失，给水印的提取和检测带来不便，会增加数据比特率 对于已压缩的视频，需先解码，嵌入水印后，再重新编码，算法运算量大、效率低，放攻击能力差 第二代要复杂很多，主要仍然是统计不可见性和与内容同步嵌入，增强了防攻击能力，具有智能特性 方案二，在视频编码器中嵌入水印：通过修改编码阶段的 DCT 域中的量化系数，并且结合人类视觉特性嵌入水印\n优点： 水印仅嵌入在 DCT 系数中，不会增加数据比特率 易设计出抗多种攻击的水印 缺点：存在误差积累，嵌入的水印数据量低，没有成熟的三维时空视觉隐蔽模型 方案三，在视频压缩码流中嵌入水印\n优点：没有解码和再编码的过程，提高了水印嵌入和提取的效率 缺点：压缩比特率的限制限定了嵌入水印的数据量的大小，嵌入后效果可能有可察觉的变化 基本要求： 水印信息的嵌入不能影响视频码流的正常解码和显示 嵌入水印的视频码流仍满足原始码流的码率约束条件 内嵌水印再体现视觉不易察觉性的同时，能够抗有损压缩编码 基于对象的视频水印：MPEG-4 的应用，是的对视频对象的造作变得更加容易，这样，对视频对象的保护显得更为迫切了，正因为如何，基于对象的视频水印迅速成为视频水印的一个热门研究方向。\n八、信息隐藏分析 8.1 隐写分析分类 隐写：以表面正常的数字载体如静止图像、数字音频和视频信号等作为掩护， 再其中隐藏秘密信息。额外数据的嵌入既不改变载体信号的视、听觉效果，也不改变计算机软件的大小和格式（包括文件头），使隐蔽信息能以不为人知的方式进行传输。\n隐写分析：隐写分析使针对图像、视频和音频等多媒体数据，在对信息隐藏算法或隐藏的信息一无所知的抢矿下，仅仅是对可能携密的载体进行检测或者预测，以判断载体中是否携带秘密信息。\n隐写分析分类：\n根据适用性分类： 专用隐写分析：针对特定隐写技术或研究对象的特点进行设计 通用隐写分析：不针对某一种隐写工具或隐写算法的盲分析 根据已知消息分类： 唯隐文攻击：只有隐写对象可用于分析 已知载体攻击：可利用原始的载体对象和隐写对象 已知消息攻击：已知隐藏的消息 选择隐文攻击：知道隐藏算法和隐秘对象 选择消息攻击：用某个隐藏算法对一个选择的消息产生伪装对象，然后分析伪装对象中产生的模式特征 已知隐文攻击：知道隐藏算法，可利用原始对象和隐写对象 根据采用的分析方法分类： 感官分析：用人眼、耳对伪装对象进行分析，判断是否可疑 统计分析：对比正常载体和伪装对象的理论期望频率分布 特征分析：寻找特定隐藏算法所产生的固有特征 根据最终的效果分类： 被动隐写分析：仅仅是判断多媒体数据中是否存在秘密信息，尝试判断携密载体所采用的算法 主动隐写分析： 估算隐藏信息的长度 估计隐藏信息的位置 猜测隐藏算法使用的密钥 猜测隐藏算法所使用的某些参数 提取隐藏的秘密信息——最终目标 8.2 信息隐藏分析的层次 信息隐藏分析的层次：\n发现隐藏信息 信息隐藏技术主要分为 时域替换技术 变换域技术 其他常用的技术 空间域低比特替换方法 正常的量化噪声应满足高斯分布，用秘密信息替换后（或者秘密信息加密后再替换），其分布就会发生变化 分析伪装对象低比特位的统计特性，来判断是否存在信息隐藏 调色板图像：分析调色板有无异常 变换域技术：较困难，针对具体隐藏算法，寻找特定算法所产生的特性 文件格式隐藏法：分析文件大小与数据大小是否一致 提取隐藏信息 在未知隐藏算法、隐藏位置、隐藏密钥的情况下，要提取隐藏信息是非常困难的 如果信息是先加密再隐藏，即使找到隐藏的信息，也要通过破译密码才能提取真正的密文 目前智能对一些简单的隐藏算法进行提取（铭文隐藏的情况下）最低比特位顺序隐藏文件格式法隐藏 破坏隐藏信息 时域（或空域）中的 LSB 隐藏方法 叠加噪声 有损压缩 变换域方法 几何变换：扭曲、裁剪、旋转、缩放等 信号处理：滤波、模糊化等 数模转换和模数转换：如图像的打印和扫描，声音的播放和重新采样等 重复嵌入：采用变换域技术再嵌入一些信息 密码设计与分析：\n目的：破译密码；寻找密码算法的漏洞，促进研制安全性更高的密码算法 密码设计：研制密码算法 密码分析：在未知密钥的情况下，试图破译密码 信息隐藏与分析：\n目的：防止隐写术的滥用；寻找隐藏算法的漏洞，促进研制安全性更高的隐藏算法 信息隐藏：研究信息隐藏算法 隐藏分析：需要在载体对象、伪装对象和可能的部分秘密消息之间进行比较 8.3 隐写分析评价指标 隐写攻击：\n非蓄意攻击 信道噪声 传输过程编码转换引入的噪声 蓄意攻击 主动攻击 被动攻击：隐写分析 隐写分析评价指标：\n准确性：指检测的准确程度，是衡量隐写的一种评价指标 False Positive：错误地将不属于分类的对象判定为属于分类，就隐写分析而言，是将自然载体判定为隐写载体 False Negative：错误地将属于分类的对象判定为不属于分类，就隐写分析而言，指将隐写载体判定为自然载体 $N$ 为一次测试的样本集大小；$N_T$ 为正确判决次数，$N_{FP}$ 为虚警次数（将无隐写错误判决为有隐写的次数），$N_{FN}$ 为漏检次数（将有阴血错误判决为无隐写的次数），有： 错误判决次数：$N_F=N_{FP}+N_{FN}$ 正确率：$R_T=\\frac{N_T}{N}$ 虚警率：$R_{FP}=\\frac{N_{FP}}{N}$ 漏检率：$R_{FN}=\\frac{N_{FN}}{N}$ 错误率：$R_F=\\frac{N_T}{N}=R_{FP}+r_{FN}$ 适用性：指分析算法对不同的隐写算法的有效性。可以用于检测算法能有效地检测多少种和多少类隐写算法来衡量 实用性：指分析算法可以实际推广应用的程度，可由实现条件是否允许、分析结果是否稳定、自动化程度的高低和实时性等进行衡量。其中，实时性可以用隐写分析算法进行一次隐写分析所用的时间来衡量，用时越短则实时性越好 复杂度：复杂度是针对隐写分析算法本身而言的，可由隐写分析算法实现需要的资源开销和软硬件条件来衡量 性能指标之间相互制约：\n准确性和适用性之间相互制约：当某一个算法的准确性较高时候，这种算法或许只能是针对某一种或者某几种隐写算法，适用性较差。当某一种算法适用性较好时，这种算法的准确性可能较差；当采用高阶或者更多统计特征进行分析的隐写分析算法时，复杂度会提高，同时将会更加有效地检测出秘密信息，增加算法的准确性，但是算法的实时性就比较差 隐写率与嵌入效率：\n隐写率（用于隐藏秘密信息的样点数/载体样点总数） 嵌入效率（隐藏的秘密信息总数/载体样点总数） 音频隐写分析\n音频分段：音频隐写算法通常将信号分为若干分段，在每个分段中依次嵌入秘密信息。因此检测秘密信息，首先需要确定隐写算法的分段大小。图像隐写算法，通常选择 $8\\times 8$ 的像素块隐藏秘密信息。音频则不同，根据音频的短时平稳特性，音频分段长度一般可在 10~30ms 之间，隐写算法具体选择多大分段长度，分析算法需要在较大的范围内来对分段长度进行选择并检测 音频值域：图像在时域隐藏秘密信息时，无论是彩色图还是灰度图，像素值都是非负的。音频的常见格式中，出去无符号 8bit 量化精度格式外，其他都是有符号量化值 8.4 LSB 信息隐藏的卡方分析 LSB 隐藏分析方法：\n卡方分析法 RS 分析法 GPC 分析法 LSB 隐写的特点：\n研究最早 算法简单 隐藏量大 应用广泛 LSB 隐写的原理：\n位平面与视觉效果的关系：隐写技术——替换 LSB 隐写步骤：\n将秘密信息转化为比特流 将比特流进行加密或置乱（用密钥） 逐行或逐列或随机游走的方式替换载体图像的最低比特位 接收者提取最低比特位，恢复秘密信息 $\\chi^2$ 分析：\nLSB 方法： 如果秘密信息位与隐藏位置的像素灰度值的最低比特位相同，不改变原始载体；反之，则改变灰度值的最低位 约定： $q$：一个像素被选中用于隐藏信息的概率 $Tc[j],j=0,1,…,255$：载体图像中，值为 $j$ 的像素个数 $Ts[j],j=0,1,…,255$：隐写图像中，值为 $j$ 的像素个数 假设： 秘密消息中比特 0 和 1 随机分布 $Tc[2i]$ 个值为 $2i$ 的像素中，有 $(1-\\frac{q}{2})T_c[2i]$ 个像素的最低比特与详细相同，不需要修改 有 $\\frac{q}{2}T_c[2i]$ 个像素最低比特与消息不同，像素值变为 $2i+1$ 类似地，值为 $2i+1$ 的像素中，$\\frac{q}{2}T_c[2i+1]$ 个像素最低比特与消息不同，像素值变为 $2i$ $E{T_s[2i]}=(1-\\frac{q}{2})T_c[2i]+\\frac{q}{2}T_c[2i+1]$ $E{T_s[2i+1]}=(1-\\frac{q}{2})T_c[2i+1]+\\frac{q}{2}T_c[2i]$ 当 $q=1$ 时：$E{T_s[2i]}=E{T_s[2i+1]}=0.5{T_c[2i]+T_c[2i+1]}=0.5{T_s[2i]+T_s[2i+1]}$。即对于隐写图像来说，值为 $2i$ 的像素个数的观测值为：$T_s[2i]$；值为 $2i$ 的像素个数的理论值 $\\overline{T_s}[2i]$ 为： $0.5{T_s[2i]+T_s[2i+1]$ 结论：如果图像 LSB 隐写，那么 $\\overline{T_s}[2i]$ 与 $T_s[2i]$ 一致 问题：$\\overline{T_s}[2i]$ 与 $T_s[2i]$ 的关系如何，可认为一致？ 卡方检验：如果图像 LSB 隐写，那么就一致。可以用卡方检验来检测 $\\overline{T_s}[2i]$ 与 $T_s[2i]$ 的一致性。 由卡方检验原理可知，统计量 $s=\\Sigma^{k}_{i=1}\\frac{(T_s[2i]-\\overline{T_s}[2i])^2}{\\overline{T_s}[2i]}$ 隐写分析：计算待检测图像统计量 $s$，$s$ 的值越小，意味 $\\overline{T_s}[2i]$与 $T_s[2i]$ 越一致，可就是说待检测图像是隐写图像的概念越高。反之，$s$ 的值越大，意味 $\\overline{T_s}[2i]$与 $T_s[2i]$ 差异越大，也就是说待检测图像是隐写的概率越低 通常计算 $p$ 值，$p(s)=P(\\chi \\ge s),\\chi \\sim \\chi^2(k-1)$ 来判别 如果图像没隐写，$s$ 很大，$p(s)$ 近似于 0 实际应用中，$p(s)\u003e\\alpha$，即认为图像包含秘密信息 九、数字水印的攻击 9.1 数字水印攻击的分类和软件 水印攻击的分类：\n去除攻击：试图削弱载体中的水印强度，或破坏载体中的水印存在 有损压缩：为了实现在网络上的快速传递和有效保存，通常需要对它进行压缩 信号处理：滤波，加噪，图像锐化、增强，修改直方图，颜色量化，修复，平均、共谋 表达攻击：试图使水印检测失效 几何攻击：翻转，剪切，旋转，缩放，行、列删除，数模、模数转换，几何扭曲 解释攻击：通过伪造水印来达到目的 既不试图擦除水印，也不试图使水印检测无效，而是使得检测出的水印存在多个解释 法律攻击：利用法律上的漏洞 利用法律上的漏洞，不同国家和地区有不同的法律规定 水印攻击软件：可用于评价和测试水印算法的性能\nUnzign StirMark Checkmark Optimark ",
  "wordCount" : "529",
  "inLanguage": "en",
  "image":"https://github.com/lxmliu2002/images/raw/main/homepage/home-bg-information_hiding.jpg","datePublished": "2024-02-29T00:00:00Z",
  "dateModified": "2024-02-29T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "lxmliu2002"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://lxmliu2002.github.io/posts/%E4%BF%A1%E6%81%AF%E9%9A%90%E8%97%8F%E6%8A%80%E6%9C%AF_7/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "lxmliu2002's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://lxmliu2002.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lxmliu2002.github.io/" accesskey="h" title="lxmliu2002&#39;s Blog (Alt + H)">lxmliu2002&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://lxmliu2002.github.io/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://lxmliu2002.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://lxmliu2002.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://lxmliu2002.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://lxmliu2002.github.io/" title="homepage">
                    <span>homepage</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://lxmliu2002.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://lxmliu2002.github.io/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      信息隐藏技术_7
    </h1>
    <div class="post-description">
      学习信息隐藏技术
    </div>
    <div class="post-meta"><span title='2024-02-29 00:00:00 +0000 UTC'>February 29, 2024</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;lxmliu2002&nbsp;|&nbsp;<a href="https://github.com/lxmliu2002/My_Blog/tree/master/content/posts/%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e6%8a%80%e6%9c%af_7.md" rel="noopener noreferrer" target="_blank">Any Suggestions?</a>

</div>
  </header> 
<figure class="entry-cover"><img loading="eager" src="https://github.com/lxmliu2002/images/raw/main/homepage/home-bg-information_hiding.jpg" alt="">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e4%b8%83%e6%95%b0%e5%ad%97%e6%b0%b4%e5%8d%b0%e6%8a%80%e6%9c%af" aria-label="七、数字水印技术">七、数字水印技术</a><ul>
                        
                <li>
                    <a href="#71-%e6%95%b0%e5%ad%97%e6%b0%b4%e5%8d%b0%e7%9a%84%e5%bd%a2%e6%88%90%e5%92%8c%e4%ba%a7%e7%94%9f" aria-label="7.1 数字水印的形成和产生">7.1 数字水印的形成和产生</a></li>
                <li>
                    <a href="#72-%e6%95%b0%e5%ad%97%e6%b0%b4%e5%8d%b0%e6%a1%86%e6%9e%b6" aria-label="7.2 数字水印框架">7.2 数字水印框架</a></li>
                <li>
                    <a href="#73-%e5%9b%be%e5%83%8f%e6%95%b0%e5%ad%97%e6%b0%b4%e5%8d%b0%e6%8a%80%e6%9c%af" aria-label="7.3 图像数字水印技术">7.3 图像数字水印技术</a><ul>
                        
                <li>
                    <a href="#731-%e6%b0%b4%e5%8d%b0%e5%b5%8c%e5%85%a5%e4%bd%8d%e7%bd%ae%e7%9a%84%e9%80%89%e6%8b%a9" aria-label="7.3.1 水印嵌入位置的选择">7.3.1 水印嵌入位置的选择</a></li>
                <li>
                    <a href="#732-%e5%b7%a5%e4%bd%9c%e5%9f%9f%e7%9a%84%e9%80%89%e6%8b%a9" aria-label="7.3.2 工作域的选择">7.3.2 工作域的选择</a></li>
                <li>
                    <a href="#733-%e8%84%86%e5%bc%b1%e6%80%a7%e6%95%b0%e5%ad%97%e6%b0%b4%e5%8d%b0%e6%8a%80%e6%9c%af" aria-label="7.3.3 脆弱性数字水印技术">7.3.3 脆弱性数字水印技术</a></li></ul>
                </li>
                <li>
                    <a href="#74-%e8%bd%af%e4%bb%b6%e6%95%b0%e5%ad%97%e6%b0%b4%e5%8d%b0%e6%8a%80%e6%9c%af" aria-label="7.4 软件数字水印技术">7.4 软件数字水印技术</a></li>
                <li>
                    <a href="#75-%e9%9f%b3%e9%a2%91%e6%95%b0%e5%ad%97%e6%b0%b4%e5%8d%b0%e6%8a%80%e6%9c%af" aria-label="7.5 音频数字水印技术">7.5 音频数字水印技术</a></li>
                <li>
                    <a href="#76-%e8%a7%86%e9%a2%91%e6%95%b0%e5%ad%97%e6%b0%b4%e5%8d%b0%e6%8a%80%e6%9c%af" aria-label="7.6 视频数字水印技术">7.6 视频数字水印技术</a></li></ul>
                </li>
                <li>
                    <a href="#%e5%85%ab%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e5%88%86%e6%9e%90" aria-label="八、信息隐藏分析">八、信息隐藏分析</a><ul>
                        
                <li>
                    <a href="#81-%e9%9a%90%e5%86%99%e5%88%86%e6%9e%90%e5%88%86%e7%b1%bb" aria-label="8.1 隐写分析分类">8.1 隐写分析分类</a></li>
                <li>
                    <a href="#82-%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e5%88%86%e6%9e%90%e7%9a%84%e5%b1%82%e6%ac%a1" aria-label="8.2 信息隐藏分析的层次">8.2 信息隐藏分析的层次</a></li>
                <li>
                    <a href="#83-%e9%9a%90%e5%86%99%e5%88%86%e6%9e%90%e8%af%84%e4%bb%b7%e6%8c%87%e6%a0%87" aria-label="8.3 隐写分析评价指标">8.3 隐写分析评价指标</a></li>
                <li>
                    <a href="#84-lsb-%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e7%9a%84%e5%8d%a1%e6%96%b9%e5%88%86%e6%9e%90" aria-label="8.4 LSB 信息隐藏的卡方分析">8.4 LSB 信息隐藏的卡方分析</a></li></ul>
                </li>
                <li>
                    <a href="#%e4%b9%9d%e6%95%b0%e5%ad%97%e6%b0%b4%e5%8d%b0%e7%9a%84%e6%94%bb%e5%87%bb" aria-label="九、数字水印的攻击">九、数字水印的攻击</a><ul>
                        
                <li>
                    <a href="#91-%e6%95%b0%e5%ad%97%e6%b0%b4%e5%8d%b0%e6%94%bb%e5%87%bb%e7%9a%84%e5%88%86%e7%b1%bb%e5%92%8c%e8%bd%af%e4%bb%b6" aria-label="9.1 数字水印攻击的分类和软件">9.1 数字水印攻击的分类和软件</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="七数字水印技术">七、数字水印技术<a hidden class="anchor" aria-hidden="true" href="#七数字水印技术">#</a></h1>
<h2 id="71-数字水印的形成和产生">7.1 数字水印的形成和产生<a hidden class="anchor" aria-hidden="true" href="#71-数字水印的形成和产生">#</a></h2>
<p>数字水印的形式：</p>
<ul>
<li>一串有意义的字符
<ul>
<li>标注作品的所有者、创作日期、发行部门以及其他需要标注的信息，它们可以是明文字符，将这些字符串以比特流的形式嵌入数字作品中。</li>
<li>在提取水印时，按照提取算法提取出这些比特流，转换成字符串，就可以得到需要的水印信息。</li>
<li>在以明文字符做数字水印的情况下，需要考虑<strong>水印的稳健性</strong>。一般在将字符串作为水印嵌入数字作品之前，需要将水印首先进行<strong>纠错编码</strong>，对水印增加一些冗余度，使得它可以纠正由于一些小的误差引起的字符错误。</li>
<li>这一类数字水印，从水印形式上说，是<strong>稳健性较差</strong>的水印。</li>
</ul>
</li>
<li>一串伪随机序列
<ul>
<li>克服了第一类水印的缺点，它不是直接将明文字符作为水印，而是将需要标识的信息与一个<strong>伪随机序列串</strong>对应起来。将伪随机数作为数字水印嵌入数字作品中。</li>
<li>在需要验证作品的所有权问题时，用相应的水印提取算法提取出数字水印，这时提取出的数字水印不需要与原来的水印完全一样，通过<strong>相关性检测</strong>就可以判断有没有水印存在。如果相关性很高，可以判断提取出的水印与原来的水印很相似，也就是存在水印。</li>
<li>利用相关性检测的水印，从水印的格式上来说，是<strong>稳健性比较好</strong>的水印。</li>
</ul>
</li>
<li>一个可视的图片
<ul>
<li>第三类数字水印是一种可视图像，它可以是一个人的<strong>手写签名</strong>或者是一些<strong>字符</strong>，也可以是一个<strong>徽标****，以</strong>二值图像**（或灰度图像）的形式保存。</li>
<li>将这些二值图像（或灰度图像）变为比特串，作为数字水印嵌入作品中。水印提取时，也是提取这些比特串，并把它们复原成原图像。</li>
<li>在误码不是很大的情况下，它们所组成的二值图像仍然能够通过人眼来识别。</li>
<li>这一类水印主要是利用人眼的视觉冗余性，它可以容忍较大的比特误码。也是<strong>稳健性比较好</strong>的水印。</li>
</ul>
</li>
</ul>
<p>水印的稳健性：</p>
<ul>
<li>选择水印时应该考虑水印本身能够容忍一定的误码，比如第二类和第三类水印</li>
<li>设计水印算法时，要考虑水印算法的抗攻击能力，同时还要考虑水印检测方式</li>
</ul>
<h2 id="72-数字水印框架">7.2 数字水印框架<a hidden class="anchor" aria-hidden="true" href="#72-数字水印框架">#</a></h2>
<p>数字水印的框架结构由两部分组成：</p>
<ul>
<li>
<p>水印嵌入过程</p>
<img src="https://github.com/lxmliu2002/images/raw/main/post/20240229/image-20240229093931675.png" alt="image-20240229093931675" style="zoom: 33%;" />
<ul>
<li>$CPP$：对被保护的数字产品进行的预处理</li>
<li>$WPP$：对数字水印 $W$ 进行的预处理</li>
<li>$G$：数字水印嵌入算法</li>
<li>$CPP^{-1}$：$CPP$ 的逆操作</li>
<li>$C$：被保护的数字产品</li>
<li>$W$：水印信息</li>
<li>$K$：数字水印嵌入算法的密钥</li>
<li>$C_W$：嵌入数字水印后的数字产品</li>
</ul>
</li>
<li>
<p>水印提取过程</p>
<img src="https://github.com/lxmliu2002/images/raw/main/post/20240229/image-20240229094211250.png" alt="image-20240229094211250" style="zoom:33%;" />
<ul>
<li>$D$：数字水印提取算法</li>
<li>$WRP$：对直接提取水印的算法，就是 $WPP$ 的逆操作。对判断绝对存在与否的算法，就是数字水印的判决算法</li>
<li>提取过程的两种输出：
<ul>
<li>直接提取水印</li>
<li>判断水印是否存在</li>
</ul>
</li>
<li>提取过程中是否需要原始载体取决于嵌入算法</li>
</ul>
</li>
</ul>
<p>根据预处理的不同，水印方案可以分为：</p>
<ul>
<li>空间域水印（预处理为空操作）</li>
<li>变换域水印（预处理为各种变换）</li>
</ul>
<p>水印算法设计的原则：</p>
<ul>
<li>稳健性
<ul>
<li>抵抗各种攻击</li>
<li>寻找不变量</li>
</ul>
</li>
</ul>
<h2 id="73-图像数字水印技术">7.3 图像数字水印技术<a hidden class="anchor" aria-hidden="true" href="#73-图像数字水印技术">#</a></h2>
<h3 id="731-水印嵌入位置的选择">7.3.1 水印嵌入位置的选择<a hidden class="anchor" aria-hidden="true" href="#731-水印嵌入位置的选择">#</a></h3>
<ul>
<li>安全性问题：嵌入的水印不能被非法使用者轻易地提取出来，或者被轻易地擦除</li>
<li>对载体质量的影响问题：不能影响数字载体的使用，嵌入水印引起的失真，应该对人类的感观是不可察觉的</li>
</ul>
<p>水印位置的选择：根据 Kerckhoffs 准则，一个安全的数字水印，其算法应该是公开的，其安全性应该建立在<strong>密钥的保密性</strong>的基础上，而不是算法是保密性上。为了防止水印被偶尔移去，或者被直截了当地提取出水印，可以采用选择水印在载体中嵌入的位置来达到目的。除了安全性方面，水印嵌入位置的选择对于载体的感观失真也起到了关键的作用。比如，人类视觉系统的敏感度随着图像纹理特征的变化而改变，因此需要考虑水印位置选择所引起的心理视觉问题。</p>
<p>”拼凑“算法：根据密钥随机选择 n 哥像素对，更改它们的亮度值。$\widetilde{a_i}=a_i+1 \ \ \widetilde{b_i}=b_i-1$。在提取时，计算 $s=\Sigma^{n}_{i=1}(\widetilde{a_i}-\widetilde{b_i})$。如果这个载体确实包含了水印，可以预计这个和为 2n，否则将近似为零。</p>
<p>基于心理视觉考虑的水印嵌入位置选择：</p>
<ul>
<li>适合嵌入：对于图像而言，在纹理较复杂的地方以及物体的边缘区域，人类的视觉系统不太精确，也就是说对这些部分的失真不太敏感，因此在这些地方非常适合嵌入水印。</li>
<li>不适合嵌入：对于图像取值比较均匀的光滑区域，人眼对这些地方的失真非常敏感，因此这些地方不适合嵌入水印。</li>
</ul>
<h3 id="732-工作域的选择">7.3.2 工作域的选择<a hidden class="anchor" aria-hidden="true" href="#732-工作域的选择">#</a></h3>
<p>数字水印的工作域选择</p>
<ul>
<li>
<p>空间域水印算法：拼凑算法、LSB 方法、选择图像的视觉不敏感区域等</p>
</li>
<li>
<p>变换域水印算法：</p>
<ul>
<li>
<p>DFT 域：离散傅里叶变换的目的是将空间域的信号转换为频率域的信号，提供了信号的频谱能量分布和相位信息，因此，利用这一工具，可以根据需要有效地控制和调整信号的频率成分和相位成分。一个较为公认的离散傅里叶变换隐藏方法为在声音信号相位中的隐藏，它是利用了人耳对相位的不敏感性来实现的信息隐藏同样，对于数字水印，也可以采用类似的方法人在声音信号的相位中嵌入水印。</p>
</li>
<li>
<p>DCT 域：大部分算法的核心是在中频区域选择多个三元组 $(A1,A2,A3)$，每个三元组嵌入 1 比特，通过调整三元组数据的相对大小来实现水印嵌入</p>
<ul>
<li>DCT 系数的特点：
<ul>
<li>直流分量和低频系数值较大，代表了图像的大部分能量，对它们做修改会影响图像的视觉效果;</li>
<li>高频系数值很小，去掉它们基本不引起察觉;</li>
<li>最好的水印嵌入区域就是在中频部分。</li>
</ul>
</li>
<li>例：基于中国剩余定理的数字水印分存算法：</li>
</ul>
</li>
<li>
<p>DWT 域：</p>
<ul>
<li>
<p>例：邻近值算法——对小波系数进行编码</p>
<ul>
<li>
<p>水印加载</p>
<img src="https://github.com/lxmliu2002/images/raw/main/post/20240229/image-20240229095755850.png" alt="image-20240229095755850" style="zoom:33%;" />
</li>
<li>
<p>水印提取</p>
<img src="https://github.com/lxmliu2002/images/raw/main/post/20240229/image-20240229095824403.png" alt="image-20240229095824403" style="zoom:33%;" />
</li>
<li>
<p>嵌入：对于当前的系数值 x 和步长 a，根据水印比特的取值 0 或 1，修改 x 的值。</p>
<ul>
<li>嵌入 1 时，取 x 为最接近的偶数个 a 的值</li>
<li>嵌入 0 时，取 x 为最接近的奇数个 a 的值</li>
</ul>
</li>
<li>
<p>提取：</p>
<ul>
<li>x/a 最接近偶数时，水印比特为 0</li>
<li>x/a 最接近奇数时，水印比特为 1</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="733-脆弱性数字水印技术">7.3.3 脆弱性数字水印技术<a hidden class="anchor" aria-hidden="true" href="#733-脆弱性数字水印技术">#</a></h3>
<p>脆弱性数字水印技术：在保证多媒体信息一定感知质量的前提下，将数字、序列号、文字、图像标志等作为数字水印嵌入到多媒体数据中当多媒体内容受到怀疑时，可将该水印提取出来用于多媒体内容的真伪识别，并且指出篡改的位置，甚至攻击类型等。又称为易碎水印，图像载体发生变化，水印则受到破坏。</p>
<p>特征：</p>
<ul>
<li>检测篡改：理想情况是能够提供破坏量的多少及修改的位置甚至能够分析篡改的类型，并能对篡改的内容进行恢复。</li>
<li>稳健性与脆弱性：水印是在满足一定稳健性条件下的脆弱（脆弱与半脆弱）</li>
<li>不可感知性</li>
<li>可靠性</li>
</ul>
<p>分类：</p>
<ul>
<li>完全脆弱性水印：水印能够检测出任何对图像像素值进行改变的操作或对图像完整性的破坏。</li>
<li>半脆弱水印：水印能够允许图像有一定的改变，它是在一定程度上的完整性检验。</li>
<li>图像可视内容鉴别：水印对图像的主要特征进行真伪鉴别，即比前两类水印更加稳健。</li>
<li>自嵌入水印：把图像本身作为水印加入，不仅可以鉴别图像的内容，还可以部分恢复被修改的区域</li>
</ul>
<p>按照实现方法不同分类：</p>
<ul>
<li>空间域方法：最早的空间域方法是基于 LSB 的方法，但这种仅仅修改图像最低有效位的方法不仅对噪声非常敏感，而且容易被破坏掉，同时这种方法不能容忍对图像的任何修改。另一种脆弱性水印，针对图像的7个最高有效位及尺寸，通过 Hash 函数运算来获得原始图像的某些特征，该特征与一有意义的二值水印图像经过异或操作，并经加密后，嵌入到图像的最低有效位。当图像内容受到怀疑时，首先将图像的 7 个最高有效位与图像尺寸，经过Hash运算后，得到某些特征，然后将图像最低有效位公开解密后的结果与该特征进行异或操作后，即从提出的水印可以非常直观地看出被篡改的区域。空间域方法的优点是能够嵌入较多的水印，但非常易于被精心设计的攻击所攻破。</li>
<li>变换域方法：在脆弱性数字水印研究中，变换域方法也有许多优点如许多脆弱性水印系统的应用场合是要求水印能抵抗有损压缩的，这在变换域中更容易实现，而且容易对图像被篡改的特征进行描绘。变换域方法突出的优点是能够较好地与现有的压缩标准（如JPEG，JPEG2000）结合起来，并且能够在容许一定压缩比的情况下，检测出发生的篡改并定位。由于嵌入水印的量比较有限，对篡改的定位一般是 $8\times 8$ 大小的块，因此不如空间域水印定位准确。</li>
</ul>
<p>图像认证：随着网络通信技术的迅速发展和多媒体数字产品的增多，对数字信息进行真实性和完整性认证变得日益紧迫和重要，其应用涉及电子政务、电子商务、国家安全、医院、司法、新闻出版、网络通信、科学研究、工程设计等各个领域，采用数字水印技术进行图像认证是一个方兴未艾的高新技术前沿课题，其迫切的市场需求和广泛的应用前景已吸引了众多的研究者投入到这一行列。</p>
<h2 id="74-软件数字水印技术">7.4 软件数字水印技术<a hidden class="anchor" aria-hidden="true" href="#74-软件数字水印技术">#</a></h2>
<p>软件水印：把程序的版权信息和用户身份信息嵌入到程序中。软件(通常是一段可执行程序)与一般的数字产品不同，它不能在进行大量的、深层次的修改后仍保持原有的特征。软件水印与多媒体水印有本质的不同</p>
<ul>
<li>对软件水印的要求：
<ul>
<li>能够证明软件的产权所有者</li>
<li>具有鲁棒性。能够抵抗攻击、防止篡改，软件的正常压缩解压以及文件传输不会对水印造成破坏。</li>
<li>软件水印不应依赖于某一具体的体系结构</li>
<li>软件水印应该便于生成、分发以及识别</li>
<li>对软件已有功能和特征的影响在实际环境下可以忽略</li>
</ul>
</li>
<li>软件水印的分类：
<ul>
<li>按照水印的嵌入位置：
<ul>
<li>代码水印：隐藏在程序的指令部分</li>
<li>数据水印：隐藏在数据中（如头文件、字符串和调试信息等）</li>
</ul>
</li>
<li>根据水印被加载的时刻：
<ul>
<li>静态水印：存储在可执行程序代码中
<ul>
<li>静态代码水印：利用目标代码中包含冗余信息嵌入水印。比如:通过调整两条无依赖关系指令的顺序可以嵌 1bit 的水印信息。IBM 提出了一种把寄存器出入栈的顺序作为水印的方法，同样可以通过排列有多个分支的 case 语句的顺序来进行编码。
<ul>
<li>许多代码水印经不起简单的攻击，如调整指令的顺序</li>
</ul>
</li>
<li>静态数据水印：将水印信息嵌入在程序的一些数据中，但是它很容易被迷乱攻击破坏。例如，把所有的数据分解成一系列数据，然后散布到整个程序中，这样代表水印信息的数据也被分解，增加了水印检测的困难程度;或者用一个产生这些数据的子程序来代替这些数据，这样在程序中就找不到该数据的原型，也就无法检测水印。</li>
</ul>
</li>
<li>动态水印：保存在程序的执行状态中
<ul>
<li>Easter Egg 水印：通过一个输入产生输出。例如，输入一个字符串，屏幕上显示出版权信息或一幅画
<ul>
<li>主要问题：水印在程序中的位置容易找到，一旦输入正确信息，用 softice 这样的标准调试软件就可以跟踪程序执行情况，进而找到水印的位置，所以这种水印不是很安全。</li>
</ul>
</li>
<li>数据结构水印：输入特定信息激发程序，把水印信息隐藏在堆、栈或者全局变量域等程序状态中。当所有信息都输完之后，通过检测程序变量的当前值来进行水印提取。可以安排一个提取水印信息的进程或者是在调试器下运行程序查看变量取值。
<ul>
<li>动态数据水印没有输出，而且水印的提取过程不是封装在应用程序中，因而不容易找到水印在程序中的位置，但是这种水印也经不住迷乱变换攻击。</li>
</ul>
</li>
<li>执行状态水印：程序在特定的输入下运行时，对程序中指令的执行顺序进行编码生成水印。水印检测则通过控制地址和操作码顺序的统计特性来进行。</li>
<li>动态水印需要由预先输入，根据输入，程序会运行到某种状态，这些状态就代表水印</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="75-音频数字水印技术">7.5 音频数字水印技术<a hidden class="anchor" aria-hidden="true" href="#75-音频数字水印技术">#</a></h2>
<p>音频信号的特点：</p>
<ul>
<li>在每个时间间隔内采样的点数要少得多</li>
<li>人耳听觉系统比人眼视觉系统灵敏得多</li>
<li>应该保持同步</li>
<li>提取时一般要求不需要原始音频信号</li>
<li>音频信号也有特殊的攻击</li>
</ul>
<p>根据水印加载方式分类：</p>
<ul>
<li>时间域数字水印
<ul>
<li>LSB 方法</li>
<li>回声隐藏法</li>
<li>通过改变信号幅值的隐藏算法</li>
</ul>
</li>
<li>变换域数字水印
<ul>
<li>傅氏变换</li>
<li>DCT 变换</li>
<li>小波变换</li>
</ul>
</li>
<li>压缩域数字水印
<ul>
<li>在原始音频信号中嵌入</li>
<li>在音频编码器中嵌入，这种方法稳健性较高，但需要复杂的编码和解码过程，运算量大，实时性不好</li>
<li>在压缩后的音频数据流中直接嵌入，这种方法避免了复杂的编解码过程，但稳健性不高，而且能够嵌入的水印容量不大</li>
</ul>
</li>
<li>其他类型</li>
</ul>
<p>音频水印评价指标：</p>
<ul>
<li>透明性：
<ul>
<li>MOS 值</li>
<li>信噪比</li>
<li>峰值信噪比</li>
</ul>
</li>
<li>水印容量：也叫数据嵌入比，指单位长度的音频中可以隐藏的秘密信息量，通常用比特率来表示，单位为 bit/s</li>
<li>鲁棒性：
<ul>
<li>误码率</li>
<li>归一化系数</li>
</ul>
</li>
</ul>
<h2 id="76-视频数字水印技术">7.6 视频数字水印技术<a hidden class="anchor" aria-hidden="true" href="#76-视频数字水印技术">#</a></h2>
<p>视频信号的特点：</p>
<ul>
<li>每一帧是静止图像，但与图像又有很大不同</li>
<li>视频容量大，结构复杂，数据编码</li>
<li>攻击特殊：如帧平均、帧剪切、帧重组、掉帧、速率改变等</li>
<li>要达到算法的实时性，必须降低算法复杂度</li>
</ul>
<p>对视频水印的要求：</p>
<ul>
<li>不可感知性</li>
<li>稳健性</li>
<li>复杂度（提取和检测应达到实时）</li>
<li>考虑视频的压缩编码</li>
<li>加入水印不应增加视频流码率</li>
<li>盲检测：水印检测时不应需要原始视频</li>
</ul>
<p>视频水印的分类：</p>
<ul>
<li>
<p>按水印技术是否与内容相关分类</p>
<ul>
<li>第一代视频水印：与视频内容无关
<ul>
<li>MPEG-1 和 MPEG-2：帧内图 I，预测图 P，双向预测图 B</li>
</ul>
</li>
<li>第二代视频水印：基于内容的视频水印
<ul>
<li>MPEG-4 标准首次以视频对象（Video Object）概念来实现基于内容的表示，视频对象主要被定义为画面分割出来的不同物体，通过运动信息、形状信息、纹理信息来描述。</li>
</ul>
</li>
</ul>
</li>
<li>
<p>按水印嵌入的策略分类</p>
<ul>
<li>在未压缩域中：移植静止图像的水印技术，结合视频帧结构特点形成适用于视频的水印方案</li>
<li>在视频编码器中：通过修改变换域系数，能得到较好的视频质量和较强的水印抵抗攻击能力，同时不会增加数据比特率</li>
<li>在视频码流中：最大优点就是不需要完全解码和再编码，提高了水印嵌入和提取的效率，但是能够嵌入的水印容量受到较大的限制，而且水印的嵌入有可能对视觉产生影响</li>
</ul>
</li>
<li>
<p>按照视频载体采用的压缩编码标准分类</p>
<ul>
<li>基于 MPEG-1 或 MPEG-2 标准：如在未压缩域对视频帧进行水印嵌入，或者在视频压缩编码中进行嵌入修改，也有直接将水印信息嵌入到压缩码流中。</li>
<li>基于 MPEG-4 标准：先提取视频对象，然后选择视频对象的部分属性作变换，嵌入水印</li>
<li>基于其它压缩标准的视频水印</li>
</ul>
</li>
</ul>
<p>视频水印算法：</p>
<ul>
<li>
<p>视频水印嵌入策略：</p>
<img src="https://github.com/lxmliu2002/images/raw/main/post/20240229/image-20240229122614120.png" alt="image-20240229122614120" style="zoom:33%;" />
</li>
<li>
<p>方案一，在原始视频流中嵌入水印</p>
<ul>
<li>优点：水印嵌入方法多，原则上图像水印方案均可应用于此，算法成熟，有稳健性水印、脆弱性水印等，可用于多种目的</li>
<li>缺点：
<ul>
<li>经过视频编码处理后，会造成部分水印信息丢失，给水印的提取和检测带来不便，会增加数据比特率</li>
<li>对于已压缩的视频，需先解码，嵌入水印后，再重新编码，算法运算量大、效率低，放攻击能力差</li>
<li>第二代要复杂很多，主要仍然是统计不可见性和与内容同步嵌入，增强了防攻击能力，具有智能特性</li>
</ul>
</li>
</ul>
</li>
<li>
<p>方案二，在视频编码器中嵌入水印：通过修改编码阶段的 DCT 域中的量化系数，并且结合人类视觉特性嵌入水印</p>
<ul>
<li>优点：
<ul>
<li>水印仅嵌入在 DCT 系数中，不会增加数据比特率</li>
<li>易设计出抗多种攻击的水印</li>
</ul>
</li>
<li>缺点：存在误差积累，嵌入的水印数据量低，没有成熟的三维时空视觉隐蔽模型</li>
</ul>
</li>
<li>
<p>方案三，在视频压缩码流中嵌入水印</p>
<ul>
<li>优点：没有解码和再编码的过程，提高了水印嵌入和提取的效率</li>
<li>缺点：压缩比特率的限制限定了嵌入水印的数据量的大小，嵌入后效果可能有可察觉的变化</li>
<li>基本要求：
<ul>
<li>水印信息的嵌入不能影响视频码流的正常解码和显示</li>
<li>嵌入水印的视频码流仍满足原始码流的码率约束条件</li>
<li>内嵌水印再体现视觉不易察觉性的同时，能够抗有损压缩编码</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>基于对象的视频水印：MPEG-4 的应用，是的对视频对象的造作变得更加容易，这样，对视频对象的保护显得更为迫切了，正因为如何，基于对象的视频水印迅速成为视频水印的一个热门研究方向。</p>
<h1 id="八信息隐藏分析">八、信息隐藏分析<a hidden class="anchor" aria-hidden="true" href="#八信息隐藏分析">#</a></h1>
<h2 id="81-隐写分析分类">8.1 隐写分析分类<a hidden class="anchor" aria-hidden="true" href="#81-隐写分析分类">#</a></h2>
<p>隐写：以表面正常的数字载体如静止图像、数字音频和视频信号等作为掩护， 再其中隐藏秘密信息。额外数据的嵌入既不改变载体信号的视、听觉效果，也不改变计算机软件的大小和格式（包括文件头），使隐蔽信息能以不为人知的方式进行传输。</p>
<p>隐写分析：隐写分析使针对图像、视频和音频等多媒体数据，在对信息隐藏算法或隐藏的信息一无所知的抢矿下，仅仅是对可能携密的载体进行检测或者预测，以判断载体中是否携带秘密信息。</p>
<p>隐写分析分类：</p>
<ul>
<li>根据适用性分类：
<ul>
<li>专用隐写分析：针对特定隐写技术或研究对象的特点进行设计</li>
<li>通用隐写分析：不针对某一种隐写工具或隐写算法的盲分析</li>
</ul>
</li>
<li>根据已知消息分类：
<ul>
<li>唯隐文攻击：只有隐写对象可用于分析</li>
<li>已知载体攻击：可利用原始的载体对象和隐写对象</li>
<li>已知消息攻击：已知隐藏的消息</li>
<li>选择隐文攻击：知道隐藏算法和隐秘对象</li>
<li>选择消息攻击：用某个隐藏算法对一个选择的消息产生伪装对象，然后分析伪装对象中产生的模式特征</li>
<li>已知隐文攻击：知道隐藏算法，可利用原始对象和隐写对象</li>
</ul>
</li>
<li>根据采用的分析方法分类：
<ul>
<li>感官分析：用人眼、耳对伪装对象进行分析，判断是否可疑</li>
<li>统计分析：对比正常载体和伪装对象的理论期望频率分布</li>
<li>特征分析：寻找特定隐藏算法所产生的固有特征</li>
</ul>
</li>
<li>根据最终的效果分类：
<ul>
<li>被动隐写分析：仅仅是判断多媒体数据中是否存在秘密信息，尝试判断携密载体所采用的算法</li>
<li>主动隐写分析：
<ul>
<li>估算隐藏信息的长度</li>
<li>估计隐藏信息的位置</li>
<li>猜测隐藏算法使用的密钥</li>
<li>猜测隐藏算法所使用的某些参数</li>
<li>提取隐藏的秘密信息——<strong>最终目标</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="82-信息隐藏分析的层次">8.2 信息隐藏分析的层次<a hidden class="anchor" aria-hidden="true" href="#82-信息隐藏分析的层次">#</a></h2>
<p>信息隐藏分析的层次：</p>
<ol>
<li>发现隐藏信息
<ul>
<li>信息隐藏技术主要分为
<ul>
<li>时域替换技术</li>
<li>变换域技术</li>
<li>其他常用的技术</li>
</ul>
</li>
<li>空间域低比特替换方法
<ul>
<li>正常的量化噪声应满足高斯分布，用秘密信息替换后（或者秘密信息加密后再替换），其分布就会发生变化</li>
<li>分析伪装对象低比特位的统计特性，来判断是否存在信息隐藏</li>
</ul>
</li>
<li>调色板图像：分析调色板有无异常</li>
<li>变换域技术：较困难，针对具体隐藏算法，寻找特定算法所产生的特性</li>
<li>文件格式隐藏法：分析文件大小与数据大小是否一致</li>
</ul>
</li>
<li>提取隐藏信息
<ul>
<li>在未知隐藏算法、隐藏位置、隐藏密钥的情况下，要提取隐藏信息是非常困难的</li>
<li>如果信息是先加密再隐藏，即使找到隐藏的信息，也要通过破译密码才能提取真正的密文</li>
<li>目前智能对一些简单的隐藏算法进行提取（铭文隐藏的情况下）最低比特位顺序隐藏文件格式法隐藏</li>
</ul>
</li>
<li>破坏隐藏信息
<ul>
<li>时域（或空域）中的 LSB 隐藏方法
<ul>
<li>叠加噪声</li>
<li>有损压缩</li>
</ul>
</li>
<li>变换域方法
<ul>
<li>几何变换：扭曲、裁剪、旋转、缩放等</li>
<li>信号处理：滤波、模糊化等</li>
<li>数模转换和模数转换：如图像的打印和扫描，声音的播放和重新采样等</li>
<li>重复嵌入：采用变换域技术再嵌入一些信息</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>密码设计与分析：</p>
<ul>
<li>目的：破译密码；寻找密码算法的漏洞，促进研制安全性更高的密码算法</li>
<li>密码设计：研制密码算法</li>
<li>密码分析：在未知密钥的情况下，试图破译密码</li>
</ul>
<p>信息隐藏与分析：</p>
<ul>
<li>目的：防止隐写术的滥用；寻找隐藏算法的漏洞，促进研制安全性更高的隐藏算法</li>
<li>信息隐藏：研究信息隐藏算法</li>
<li>隐藏分析：需要在载体对象、伪装对象和可能的部分秘密消息之间进行比较</li>
</ul>
<h2 id="83-隐写分析评价指标">8.3 隐写分析评价指标<a hidden class="anchor" aria-hidden="true" href="#83-隐写分析评价指标">#</a></h2>
<p>隐写攻击：</p>
<ul>
<li>非蓄意攻击
<ul>
<li>信道噪声</li>
<li>传输过程编码转换引入的噪声</li>
</ul>
</li>
<li>蓄意攻击
<ul>
<li>主动攻击</li>
<li>被动攻击：隐写分析</li>
</ul>
</li>
</ul>
<p>隐写分析评价指标：</p>
<ul>
<li>准确性：指检测的准确程度，是衡量隐写的一种评价指标
<ul>
<li>False Positive：错误地将不属于分类的对象判定为属于分类，就隐写分析而言，是将自然载体判定为隐写载体</li>
<li>False Negative：错误地将属于分类的对象判定为不属于分类，就隐写分析而言，指将隐写载体判定为自然载体</li>
<li>$N$ 为一次测试的样本集大小；$N_T$ 为正确判决次数，$N_{FP}$ 为虚警次数（将无隐写错误判决为有隐写的次数），$N_{FN}$ 为漏检次数（将有阴血错误判决为无隐写的次数），有：
<ul>
<li>错误判决次数：$N_F=N_{FP}+N_{FN}$</li>
<li>正确率：$R_T=\frac{N_T}{N}$</li>
<li>虚警率：$R_{FP}=\frac{N_{FP}}{N}$</li>
<li>漏检率：$R_{FN}=\frac{N_{FN}}{N}$</li>
<li>错误率：$R_F=\frac{N_T}{N}=R_{FP}+r_{FN}$</li>
</ul>
</li>
</ul>
</li>
<li>适用性：指分析算法对不同的隐写算法的有效性。可以用于检测算法能有效地检测多少种和多少类隐写算法来衡量</li>
<li>实用性：指分析算法可以实际推广应用的程度，可由实现条件是否允许、分析结果是否稳定、自动化程度的高低和实时性等进行衡量。其中，实时性可以用隐写分析算法进行一次隐写分析所用的时间来衡量，用时越短则实时性越好</li>
<li>复杂度：复杂度是针对隐写分析算法本身而言的，可由隐写分析算法实现需要的资源开销和软硬件条件来衡量</li>
</ul>
<p>性能指标之间相互制约：</p>
<ul>
<li>准确性和适用性之间相互制约：当某一个算法的准确性较高时候，这种算法或许只能是针对某一种或者某几种隐写算法，适用性较差。当某一种算法适用性较好时，这种算法的准确性可能较差；当采用高阶或者更多统计特征进行分析的隐写分析算法时，复杂度会提高，同时将会更加有效地检测出秘密信息，增加算法的准确性，但是算法的实时性就比较差</li>
</ul>
<p>隐写率与嵌入效率：</p>
<ul>
<li>隐写率（用于隐藏秘密信息的样点数/载体样点总数）</li>
<li>嵌入效率（隐藏的秘密信息总数/载体样点总数）</li>
</ul>
<p>音频隐写分析</p>
<ul>
<li>音频分段：音频隐写算法通常将信号分为若干分段，在每个分段中依次嵌入秘密信息。因此检测秘密信息，首先需要确定隐写算法的分段大小。图像隐写算法，通常选择 $8\times 8$ 的像素块隐藏秘密信息。音频则不同，根据音频的短时平稳特性，音频分段长度一般可在 10~30ms 之间，隐写算法具体选择多大分段长度，分析算法需要在较大的范围内来对分段长度进行选择并检测</li>
<li>音频值域：图像在时域隐藏秘密信息时，无论是彩色图还是灰度图，像素值都是非负的。音频的常见格式中，出去无符号 8bit 量化精度格式外，其他都是有符号量化值</li>
</ul>
<h2 id="84-lsb-信息隐藏的卡方分析">8.4 LSB 信息隐藏的卡方分析<a hidden class="anchor" aria-hidden="true" href="#84-lsb-信息隐藏的卡方分析">#</a></h2>
<p>LSB 隐藏分析方法：</p>
<ol>
<li>卡方分析法</li>
<li>RS 分析法</li>
<li>GPC 分析法</li>
</ol>
<p>LSB 隐写的特点：</p>
<ul>
<li>研究最早</li>
<li>算法简单</li>
<li>隐藏量大</li>
<li>应用广泛</li>
</ul>
<p>LSB 隐写的原理：</p>
<ul>
<li>位平面与视觉效果的关系：隐写技术——替换</li>
</ul>
<p>LSB 隐写步骤：</p>
<ul>
<li>将秘密信息转化为比特流</li>
<li>将比特流进行加密或置乱（用密钥）</li>
<li>逐行或逐列或随机游走的方式替换载体图像的最低比特位</li>
<li>接收者提取最低比特位，恢复秘密信息</li>
</ul>
<p>$\chi^2$ 分析：</p>
<ul>
<li>LSB 方法：
<ul>
<li>如果秘密信息位与隐藏位置的像素灰度值的最低比特位相同，不改变原始载体；反之，则改变灰度值的最低位</li>
</ul>
</li>
<li>约定：
<ul>
<li>$q$：一个像素被选中用于隐藏信息的概率</li>
<li>$Tc[j],j=0,1,&hellip;,255$：载体图像中，值为 $j$ 的像素个数</li>
<li>$Ts[j],j=0,1,&hellip;,255$：隐写图像中，值为 $j$ 的像素个数</li>
</ul>
</li>
<li>假设：
<ul>
<li>秘密消息中比特 0 和 1 随机分布</li>
<li>$Tc[2i]$ 个值为 $2i$ 的像素中，有 $(1-\frac{q}{2})T_c[2i]$ 个像素的最低比特与详细相同，不需要修改</li>
<li>有 $\frac{q}{2}T_c[2i]$ 个像素最低比特与消息不同，像素值变为 $2i+1$</li>
<li>类似地，值为 $2i+1$ 的像素中，$\frac{q}{2}T_c[2i+1]$ 个像素最低比特与消息不同，像素值变为 $2i$
<ul>
<li>$E{T_s[2i]}=(1-\frac{q}{2})T_c[2i]+\frac{q}{2}T_c[2i+1]$</li>
<li>$E{T_s[2i+1]}=(1-\frac{q}{2})T_c[2i+1]+\frac{q}{2}T_c[2i]$</li>
</ul>
</li>
<li>当 $q=1$ 时：$E{T_s[2i]}=E{T_s[2i+1]}=0.5{T_c[2i]+T_c[2i+1]}=0.5{T_s[2i]+T_s[2i+1]}$。即对于隐写图像来说，值为 $2i$ 的像素个数的观测值为：$T_s[2i]$；值为 $2i$ 的像素个数的理论值 $\overline{T_s}[2i]$ 为： $0.5{T_s[2i]+T_s[2i+1]$</li>
</ul>
</li>
<li>结论：如果图像 LSB 隐写，那么 $\overline{T_s}[2i]$ 与  $T_s[2i]$ 一致</li>
<li>问题：$\overline{T_s}[2i]$ 与  $T_s[2i]$ 的关系如何，可认为一致？</li>
<li>卡方检验：如果图像 LSB 隐写，那么就一致。可以用卡方检验来检测 $\overline{T_s}[2i]$ 与  $T_s[2i]$ 的一致性。
<ul>
<li>由卡方检验原理可知，统计量 $s=\Sigma^{k}_{i=1}\frac{(T_s[2i]-\overline{T_s}[2i])^2}{\overline{T_s}[2i]}$</li>
</ul>
</li>
<li>隐写分析：计算待检测图像统计量 $s$，$s$ 的值越小，意味 $\overline{T_s}[2i]$与 $T_s[2i]$ 越一致，可就是说待检测图像是隐写图像的概念越高。反之，$s$ 的值越大，意味 $\overline{T_s}[2i]$与 $T_s[2i]$ 差异越大，也就是说待检测图像是隐写的概率越低
<ul>
<li>通常计算 $p$ 值，$p(s)=P(\chi \ge s),\chi \sim \chi^2(k-1)$ 来判别</li>
<li>如果图像没隐写，$s$ 很大，$p(s)$ 近似于 0</li>
<li>实际应用中，$p(s)&gt;\alpha$，即认为图像包含秘密信息</li>
</ul>
</li>
</ul>
<h1 id="九数字水印的攻击">九、数字水印的攻击<a hidden class="anchor" aria-hidden="true" href="#九数字水印的攻击">#</a></h1>
<h2 id="91-数字水印攻击的分类和软件">9.1 数字水印攻击的分类和软件<a hidden class="anchor" aria-hidden="true" href="#91-数字水印攻击的分类和软件">#</a></h2>
<p>水印攻击的分类：</p>
<ul>
<li>去除攻击：试图削弱载体中的水印强度，或破坏载体中的水印存在
<ul>
<li>有损压缩：为了实现在网络上的快速传递和有效保存，通常需要对它进行压缩</li>
<li>信号处理：滤波，加噪，图像锐化、增强，修改直方图，颜色量化，修复，平均、共谋</li>
</ul>
</li>
<li>表达攻击：试图使水印检测失效
<ul>
<li>几何攻击：翻转，剪切，旋转，缩放，行、列删除，数模、模数转换，几何扭曲</li>
</ul>
</li>
<li>解释攻击：通过伪造水印来达到目的
<ul>
<li>既不试图擦除水印，也不试图使水印检测无效，而是使得检测出的水印存在多个解释</li>
</ul>
</li>
<li>法律攻击：利用法律上的漏洞
<ul>
<li>利用法律上的漏洞，不同国家和地区有不同的法律规定</li>
</ul>
</li>
</ul>
<p>水印攻击软件：可用于评价和测试水印算法的性能</p>
<ul>
<li>Unzign</li>
<li>StirMark</li>
<li>Checkmark</li>
<li>Optimark</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://lxmliu2002.github.io/tags/ctf/">CTF</a></li>
      <li><a href="https://lxmliu2002.github.io/tags/%E4%BF%A1%E6%81%AF%E9%9A%90%E8%97%8F%E6%8A%80%E6%9C%AF/">信息隐藏技术</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://lxmliu2002.github.io/posts/ctf_pwn/">
    <span class="title">« Prev</span>
    <br>
    <span>CTF_Pwn</span>
  </a>
  <a class="next" href="https://lxmliu2002.github.io/posts/%E4%BF%A1%E6%81%AF%E9%9A%90%E8%97%8F%E6%8A%80%E6%9C%AF_6/">
    <span class="title">Next »</span>
    <br>
    <span>信息隐藏技术_6</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 信息隐藏技术_7 on x"
            href="https://x.com/intent/tweet/?text=%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e6%8a%80%e6%9c%af_7&amp;url=https%3a%2f%2flxmliu2002.github.io%2fposts%2f%25E4%25BF%25A1%25E6%2581%25AF%25E9%259A%2590%25E8%2597%258F%25E6%258A%2580%25E6%259C%25AF_7%2f&amp;hashtags=CTF%2c%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e6%8a%80%e6%9c%af">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 信息隐藏技术_7 on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2flxmliu2002.github.io%2fposts%2f%25E4%25BF%25A1%25E6%2581%25AF%25E9%259A%2590%25E8%2597%258F%25E6%258A%2580%25E6%259C%25AF_7%2f&amp;title=%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e6%8a%80%e6%9c%af_7&amp;summary=%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e6%8a%80%e6%9c%af_7&amp;source=https%3a%2f%2flxmliu2002.github.io%2fposts%2f%25E4%25BF%25A1%25E6%2581%25AF%25E9%259A%2590%25E8%2597%258F%25E6%258A%2580%25E6%259C%25AF_7%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 信息隐藏技术_7 on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2flxmliu2002.github.io%2fposts%2f%25E4%25BF%25A1%25E6%2581%25AF%25E9%259A%2590%25E8%2597%258F%25E6%258A%2580%25E6%259C%25AF_7%2f&title=%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e6%8a%80%e6%9c%af_7">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 信息隐藏技术_7 on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2flxmliu2002.github.io%2fposts%2f%25E4%25BF%25A1%25E6%2581%25AF%25E9%259A%2590%25E8%2597%258F%25E6%258A%2580%25E6%259C%25AF_7%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 信息隐藏技术_7 on whatsapp"
            href="https://api.whatsapp.com/send?text=%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e6%8a%80%e6%9c%af_7%20-%20https%3a%2f%2flxmliu2002.github.io%2fposts%2f%25E4%25BF%25A1%25E6%2581%25AF%25E9%259A%2590%25E8%2597%258F%25E6%258A%2580%25E6%259C%25AF_7%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 信息隐藏技术_7 on telegram"
            href="https://telegram.me/share/url?text=%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e6%8a%80%e6%9c%af_7&amp;url=https%3a%2f%2flxmliu2002.github.io%2fposts%2f%25E4%25BF%25A1%25E6%2581%25AF%25E9%259A%2590%25E8%2597%258F%25E6%258A%2580%25E6%259C%25AF_7%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 信息隐藏技术_7 on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=%e4%bf%a1%e6%81%af%e9%9a%90%e8%97%8f%e6%8a%80%e6%9c%af_7&u=https%3a%2f%2flxmliu2002.github.io%2fposts%2f%25E4%25BF%25A1%25E6%2581%25AF%25E9%259A%2590%25E8%2597%258F%25E6%258A%2580%25E6%259C%25AF_7%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>© <a href="https://github.com/lxmliu2002">lxmliu2002</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
