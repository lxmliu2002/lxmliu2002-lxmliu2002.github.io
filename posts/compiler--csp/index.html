<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Compiler &amp; CSP | lxmliu2002&#39;s Blog</title>
<meta name="keywords" content="CSP, MLM">
<meta name="description" content="CSP 备考的相关知识，与 solidity 智能合约编译过程的研究">
<meta name="author" content="lxmliu2002">
<link rel="canonical" href="https://lxmliu2002.github.io/posts/compiler--csp/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css" integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://lxmliu2002.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://lxmliu2002.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://lxmliu2002.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://lxmliu2002.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://lxmliu2002.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://lxmliu2002.github.io/posts/compiler--csp/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://lxmliu2002.github.io/posts/compiler--csp/">
  <meta property="og:site_name" content="lxmliu2002&#39;s Blog">
  <meta property="og:title" content="Compiler & CSP">
  <meta property="og:description" content="CSP 备考的相关知识，与 solidity 智能合约编译过程的研究">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-24T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-01-24T00:00:00+00:00">
    <meta property="article:tag" content="CSP">
    <meta property="article:tag" content="MLM">
    <meta property="og:image" content="https://github.com/lxmliu2002/images/raw/main/homepage/home-bg-03.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://github.com/lxmliu2002/images/raw/main/homepage/home-bg-03.jpg">
<meta name="twitter:title" content="Compiler &amp; CSP">
<meta name="twitter:description" content="CSP 备考的相关知识，与 solidity 智能合约编译过程的研究">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://lxmliu2002.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Compiler \u0026 CSP",
      "item": "https://lxmliu2002.github.io/posts/compiler--csp/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Compiler \u0026 CSP",
  "name": "Compiler \u0026 CSP",
  "description": "CSP 备考的相关知识，与 solidity 智能合约编译过程的研究",
  "keywords": [
    "CSP", "MLM"
  ],
  "articleBody": "Compiler https://docs.soliditylang.org/zh/latest\nhttps://docs.soliditylang.org/en/v0.8.23\nFilscan: FEVM合约验证的那些事\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 // SPDX-License-Identifier: MIT pragma solidity \u003e0.5.0; contract SimpleVoting { uint256 a; uint256 b; function add(uint256 a1, uint256 a2) public returns(uint256) { a = a1; b = a2; return (a1 + a2); } } 字节码组成 .code：这一部分是创建合约时执行的汇编指令，它通常包括合约的构造函数以及在合约部署过程中需要执行的初始化代码。一旦合约部署完成，.code 部分的指令将不再被执行。 .data：这一部分是合约内容的汇编指令，包含了合约的主要执行逻辑，包括函数的定义和实现、变量的初始化和操作、事件的触发等。这些指令会在合约被调用时被执行，用于处理交易和状态的改变。 以 CODECOPY 为分界？前面为初始化部分（.code），后面为合约内容（.data）\nCODECOPY：copy executing contract’s bytecode\nEthereum Virtual Machine Opcodes\nMetadata 通常 Solidity 编译器会将经过 CBOR 方式编码的 Metadata 文件的哈希值及一些其他信息（如 ipfs、solc 版本等）附加到合约字节码的末尾，字节码末尾的 Metadata 哈希成为锁定整个编译过程所涉及的相关信息的指纹。\n通过命令行标志 --no-cbor-metadata 或标准 JSON 输入中的布尔字段 settings.metadata.appendCBOR 设置为 false 可用于跳过将 Metadata 附加到已部署字节码的末尾。\n优化器选项 在编译时使用 solc --optimize --bin sourceFile.sol 激活优化器。solidity 编译器使用两种不同的优化方式，老的优化器直接优化编译过后的 opcode，新的优化器优化 Yul IR 代码。优化器会尝试优化代码，包括死代码删除、常量表达式计算、内联函数等，影响如下：\n函数调度程序中二进制搜索的大小 大数字或字符串等常量的存储方式 默认情况下，优化器假设合约会执行 200 次。\n部署合约代价低，函数执行代价高 =\u003e 设置 --optimize-runs=1 =\u003e 字节码小，部署成本低\n1 2 --optimize-runs=1 608060405234801561000f575f80fd5b5060d88061001c5f395ff3fe6080604052348015600e575f80fd5b50600436106026575f3560e01c8063771602f714602a575b5f80fd5b603960353660046065565b604b565b60405190815260200160405180910390f35b5f8281556001829055605c82846084565b90505b92915050565b5f80604083850312156075575f80fd5b50508035926020909101359150565b80820180821115605f57634e487b7160e01b5f52601160045260245ffdfea264697066735822122004ae56a0249ee3f53260881591e39b22a4653c42195083a2bf2617a7005c751964736f6c63430008160033 执行次数更高（有更多交易），不考虑部署成本及输出 =\u003e 调高 --optimize-runs =\u003e 字节码大，部署成本高，但运行消耗的 gas 小。\n1 2 --optimize-runs=1000 608060405234801561000f575f80fd5b5060f18061001c5f395ff3fe6080604052348015600e575f80fd5b50600436106026575f3560e01c8063771602f714602a575b5f80fd5b603960353660046065565b604b565b60405190815260200160405180910390f35b5f8281556001829055605c82846084565b90505b92915050565b5f80604083850312156075575f80fd5b50508035926020909101359150565b80820180821115605f577f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffdfea264697066735822122042318f59dbd71f9bc8436b4de5a288a86c58c42782a37bb0b6c66998ad1de8b964736f6c63430008160033 库链接 如果调用 solc 时带有 --link 选项，所有输入文件都被编译成格式为 __$53aea86b7d70b31448b230b20ae141a537$__ 形式的未链接的二进制文件（十六进制编码），并被本地链接（如果从标准输入（stdin）读取输入，则被写到标准输出（stdout））。这些字符串是实际库的地址的占位符。此占位符是完全限定库名的 keccak256 哈希的十六进制编码的34个字符前缀。\n替换占位符的过程通常涉及将占位符与实际的库地址进行映射，并将映射关系应用于合约编译结果中的相应位置，这确保了验证过程能够正确地定位和访问库的相关代码和功能。\nEVM 版本 在错误的EVM版本进行编译会导致错误，奇怪和失败的行为。\n使用 solc --evm-version contract.sol 命令选择 EVM 版本。以下是一个EVM版本的列表，以及每个版本中引入的编译器相关变化。 每个版本之间不保证向后兼容。\nhomestead\n（最老的版本）\n1 PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1DF DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x48 JUMPI PUSH1 0x0 CALLDATALOAD PUSH29 0x100000000000000000000000000000000000000000000000000000000 SWAP1 DIV DUP1 PUSH4 0x771602F7 EQ PUSH2 0x4D JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x67 PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x62 SWAP2 SWAP1 PUSH2 0xDC JUMP JUMPDEST PUSH2 0x7D JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x74 SWAP2 SWAP1 PUSH2 0x12B JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x99 SWAP2 SWAP1 PUSH2 0x175 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0xB9 DUP2 PUSH2 0xA6 JUMP JUMPDEST DUP2 EQ PUSH2 0xC4 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xD6 DUP2 PUSH2 0xB0 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xF3 JUMPI PUSH2 0xF2 PUSH2 0xA1 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0x101 DUP6 DUP3 DUP7 ADD PUSH2 0xC7 JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0x112 DUP6 DUP3 DUP7 ADD PUSH2 0xC7 JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x125 DUP2 PUSH2 0xA6 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x140 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0x11C JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x180 DUP3 PUSH2 0xA6 JUMP JUMPDEST SWAP2 POP PUSH2 0x18B DUP4 PUSH2 0xA6 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x1A3 JUMPI PUSH2 0x1A2 PUSH2 0x146 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 0x5D SELFDESTRUCT 0xCA 0xB1 CALLDATACOPY PC PUSH18 0x78F2DFB493B7BE81E6F7432DB582BA640940 PUSH8 0x5F11721F13F56473 PUSH16 0x6C634300081600330000000000000000 tangerineWhistle\n访问其他账户的 gas 成本增加，与 gas 估算和优化器有关。对于外部调用，所有 gas 都是默认发送的，以前必须保留一定的数量。\n1 PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1DF DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x48 JUMPI PUSH1 0x0 CALLDATALOAD PUSH29 0x100000000000000000000000000000000000000000000000000000000 SWAP1 DIV DUP1 PUSH4 0x771602F7 EQ PUSH2 0x4D JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x67 PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x62 SWAP2 SWAP1 PUSH2 0xDC JUMP JUMPDEST PUSH2 0x7D JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x74 SWAP2 SWAP1 PUSH2 0x12B JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x99 SWAP2 SWAP1 PUSH2 0x175 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0xB9 DUP2 PUSH2 0xA6 JUMP JUMPDEST DUP2 EQ PUSH2 0xC4 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xD6 DUP2 PUSH2 0xB0 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xF3 JUMPI PUSH2 0xF2 PUSH2 0xA1 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0x101 DUP6 DUP3 DUP7 ADD PUSH2 0xC7 JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0x112 DUP6 DUP3 DUP7 ADD PUSH2 0xC7 JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x125 DUP2 PUSH2 0xA6 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x140 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0x11C JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x180 DUP3 PUSH2 0xA6 JUMP JUMPDEST SWAP2 POP PUSH2 0x18B DUP4 PUSH2 0xA6 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x1A3 JUMPI PUSH2 0x1A2 PUSH2 0x146 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 0xF9 JUMP PUSH10 0x972668A9ADEF8DF3CA00 0x2F 0xA6 0xBA DIV SDIV 0xEC DUP9 0xE1 PUSH24 0xA56339895DE1534CA35464736F6C63430008160033000000 spuriousDragon\nexp 操作码的 gas 成本增加，与 gas 估计和优化器有关。\n1 PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1DF DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x48 JUMPI PUSH1 0x0 CALLDATALOAD PUSH29 0x100000000000000000000000000000000000000000000000000000000 SWAP1 DIV DUP1 PUSH4 0x771602F7 EQ PUSH2 0x4D JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x67 PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x62 SWAP2 SWAP1 PUSH2 0xDC JUMP JUMPDEST PUSH2 0x7D JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x74 SWAP2 SWAP1 PUSH2 0x12B JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x99 SWAP2 SWAP1 PUSH2 0x175 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0xB9 DUP2 PUSH2 0xA6 JUMP JUMPDEST DUP2 EQ PUSH2 0xC4 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xD6 DUP2 PUSH2 0xB0 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xF3 JUMPI PUSH2 0xF2 PUSH2 0xA1 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0x101 DUP6 DUP3 DUP7 ADD PUSH2 0xC7 JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0x112 DUP6 DUP3 DUP7 ADD PUSH2 0xC7 JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x125 DUP2 PUSH2 0xA6 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x140 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0x11C JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x180 DUP3 PUSH2 0xA6 JUMP JUMPDEST SWAP2 POP PUSH2 0x18B DUP4 PUSH2 0xA6 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x1A3 JUMPI PUSH2 0x1A2 PUSH2 0x146 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 PUSH15 0x83A1CE49DDE567C411F39C4A5795EF 0xB3 ISZERO DUP16 SWAP14 RETURNDATASIZE BALANCE NOT ADD 0xF ADD ORIGIN PUSH7 0x7201370C64736F PUSH13 0x63430008160033000000000000 byzantium\n在汇编中可使用操作码 returndatacopy， returndatasize 和 staticcall。staticcall 操作码在调用非库合约 view 或 pure 函数时使用，它可以防止函数在 EVM 级别修改状态，也就是说，甚至适用于您使用无效的类型转换时。可以访问从函数调用返回的动态数据。引入了 revert 操作码，这意味着 revert 将不会浪费 gas。\n1 PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1DF DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x48 JUMPI PUSH1 0x0 CALLDATALOAD PUSH29 0x100000000000000000000000000000000000000000000000000000000 SWAP1 DIV DUP1 PUSH4 0x771602F7 EQ PUSH2 0x4D JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x67 PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x62 SWAP2 SWAP1 PUSH2 0xDC JUMP JUMPDEST PUSH2 0x7D JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x74 SWAP2 SWAP1 PUSH2 0x12B JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x99 SWAP2 SWAP1 PUSH2 0x175 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0xB9 DUP2 PUSH2 0xA6 JUMP JUMPDEST DUP2 EQ PUSH2 0xC4 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xD6 DUP2 PUSH2 0xB0 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xF3 JUMPI PUSH2 0xF2 PUSH2 0xA1 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0x101 DUP6 DUP3 DUP7 ADD PUSH2 0xC7 JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0x112 DUP6 DUP3 DUP7 ADD PUSH2 0xC7 JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x125 DUP2 PUSH2 0xA6 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x140 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0x11C JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x180 DUP3 PUSH2 0xA6 JUMP JUMPDEST SWAP2 POP PUSH2 0x18B DUP4 PUSH2 0xA6 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x1A3 JUMPI PUSH2 0x1A2 PUSH2 0x146 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 0xD DUP13 PUSH1 0x71 PUSH0 DUP14 0xCF RETURN 0xD5 0xE4 PUSH12 0x5507BD3D6C4BF4CFC1052568 SWAP12 0xB0 LOG2 0x49 DUP4 SDIV 0xE9 0xC5 0xF6 PUSH5 0x736F6C6343 STOP ADDMOD AND STOP CALLER constantinople\n在汇编中可使用操作码 create2, extcodehash, shl, shr 和 sar。移位运算符使用移位运算码，因此需要的 gas 较少。\n1 PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1C2 DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x2B JUMPI PUSH1 0x0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH2 0x30 JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x4A PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x45 SWAP2 SWAP1 PUSH2 0xBF JUMP JUMPDEST PUSH2 0x60 JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x57 SWAP2 SWAP1 PUSH2 0x10E JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x7C SWAP2 SWAP1 PUSH2 0x158 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0x9C DUP2 PUSH2 0x89 JUMP JUMPDEST DUP2 EQ PUSH2 0xA7 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xB9 DUP2 PUSH2 0x93 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xD6 JUMPI PUSH2 0xD5 PUSH2 0x84 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0xE4 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0xF5 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x108 DUP2 PUSH2 0x89 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x123 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0xFF JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x163 DUP3 PUSH2 0x89 JUMP JUMPDEST SWAP2 POP PUSH2 0x16E DUP4 PUSH2 0x89 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x186 JUMPI PUSH2 0x185 PUSH2 0x129 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 SAR SIGNEXTEND 0xCA PUSH9 0x6272C56E1B7EC48BCB SWAP14 CALLDATALOAD XOR 0xE9 0x5D 0x2F 0x2D DUP7 0xE1 0xCD PUSH15 0xCB62CD0BDF6467AB64736F6C634300 ADDMOD AND STOP CALLER petersburg\n编译器的行为与 constantinople 版本的行为相同。\n1 PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1C2 DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x2B JUMPI PUSH1 0x0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH2 0x30 JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x4A PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x45 SWAP2 SWAP1 PUSH2 0xBF JUMP JUMPDEST PUSH2 0x60 JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x57 SWAP2 SWAP1 PUSH2 0x10E JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x7C SWAP2 SWAP1 PUSH2 0x158 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0x9C DUP2 PUSH2 0x89 JUMP JUMPDEST DUP2 EQ PUSH2 0xA7 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xB9 DUP2 PUSH2 0x93 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xD6 JUMPI PUSH2 0xD5 PUSH2 0x84 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0xE4 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0xF5 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x108 DUP2 PUSH2 0x89 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x123 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0xFF JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x163 DUP3 PUSH2 0x89 JUMP JUMPDEST SWAP2 POP PUSH2 0x16E DUP4 PUSH2 0x89 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x186 JUMPI PUSH2 0x185 PUSH2 0x129 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 0xF6 TIMESTAMP 0xCE 0xA7 SWAP2 PUSH10 0xA56F5782E5B5B7A788B5 JUMPI DUP1 0x28 PUSH7 0x945664E8192C7C 0xBB 0xB7 DUP10 0x2B 0x4F PUSH5 0x736F6C6343 STOP ADDMOD AND STOP CALLER istanbul\n在汇编中可使用操作码 chainid 和 selfbalance。\n1 PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1C2 DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x2B JUMPI PUSH1 0x0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH2 0x30 JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x4A PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x45 SWAP2 SWAP1 PUSH2 0xBF JUMP JUMPDEST PUSH2 0x60 JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x57 SWAP2 SWAP1 PUSH2 0x10E JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x7C SWAP2 SWAP1 PUSH2 0x158 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0x9C DUP2 PUSH2 0x89 JUMP JUMPDEST DUP2 EQ PUSH2 0xA7 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xB9 DUP2 PUSH2 0x93 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xD6 JUMPI PUSH2 0xD5 PUSH2 0x84 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0xE4 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0xF5 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x108 DUP2 PUSH2 0x89 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x123 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0xFF JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x163 DUP3 PUSH2 0x89 JUMP JUMPDEST SWAP2 POP PUSH2 0x16E DUP4 PUSH2 0x89 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x186 JUMPI PUSH2 0x185 PUSH2 0x129 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 SWAP2 0x25 DELEGATECALL PUSH4 0x4BF84E17 PC SELFDESTRUCT PUSH29 0x735401FD80347DCC85EEE8FD49D8DB4521883ABC7F64736F6C63430008 AND STOP CALLER berlin\nSLOAD， *CALL， BALANCE， EXT* 和 SELFDESTRUCT 的 gas 成本增加。 编译器假设这类操作的 gas 成本是固定的。这与 gas 估计和优化器有关。\n1 PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1C2 DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x2B JUMPI PUSH1 0x0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH2 0x30 JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x4A PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x45 SWAP2 SWAP1 PUSH2 0xBF JUMP JUMPDEST PUSH2 0x60 JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x57 SWAP2 SWAP1 PUSH2 0x10E JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x7C SWAP2 SWAP1 PUSH2 0x158 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0x9C DUP2 PUSH2 0x89 JUMP JUMPDEST DUP2 EQ PUSH2 0xA7 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xB9 DUP2 PUSH2 0x93 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xD6 JUMPI PUSH2 0xD5 PUSH2 0x84 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0xE4 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0xF5 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x108 DUP2 PUSH2 0x89 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x123 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0xFF JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x163 DUP3 PUSH2 0x89 JUMP JUMPDEST SWAP2 POP PUSH2 0x16E DUP4 PUSH2 0x89 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x186 JUMPI PUSH2 0x185 PUSH2 0x129 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 STOP KECCAK256 LOG3 0xD0 MULMOD 0x26 SWAP1 0xB5 POP 0xDA STOP 0x25 0xB2 0xC9 PUSH30 0xFC1877A52773280386B2CDFAACACBF231D64736F6C634300081600330000 london\n区块的基本费用（ EIP-3198 和 EIP-1559 ） 可以通过全局的 block.basefee 或内联汇编中的 basefee() 访问。\n1 PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1C2 DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x2B JUMPI PUSH1 0x0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH2 0x30 JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x4A PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x45 SWAP2 SWAP1 PUSH2 0xBF JUMP JUMPDEST PUSH2 0x60 JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x57 SWAP2 SWAP1 PUSH2 0x10E JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x7C SWAP2 SWAP1 PUSH2 0x158 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0x9C DUP2 PUSH2 0x89 JUMP JUMPDEST DUP2 EQ PUSH2 0xA7 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xB9 DUP2 PUSH2 0x93 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xD6 JUMPI PUSH2 0xD5 PUSH2 0x84 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0xE4 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0xF5 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x108 DUP2 PUSH2 0x89 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x123 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0xFF JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x163 DUP3 PUSH2 0x89 JUMP JUMPDEST SWAP2 POP PUSH2 0x16E DUP4 PUSH2 0x89 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x186 JUMPI PUSH2 0x185 PUSH2 0x129 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 0xC7 PUSH10 0x4DF9F0DFC720CF5FC0EA 0x21 0xCD SHR 0xBF 0xB9 0xD1 LOG3 0xD5 0xD9 0xBC 0xB0 0xC6 DUP12 EXP PUSH23 0xB142E28C5464736F6C6343000816003300000000000000 paris\n引入了 prevrandao() 和 block.prevrandao，并改变了现在已经废弃的 block.difficulty 的语义，不允许在内联汇编中使用 difficulty() （见 EIP-4399 ）。\n1 PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1C2 DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x2B JUMPI PUSH1 0x0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH2 0x30 JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x4A PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x45 SWAP2 SWAP1 PUSH2 0xBF JUMP JUMPDEST PUSH2 0x60 JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x57 SWAP2 SWAP1 PUSH2 0x10E JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x7C SWAP2 SWAP1 PUSH2 0x158 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0x9C DUP2 PUSH2 0x89 JUMP JUMPDEST DUP2 EQ PUSH2 0xA7 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xB9 DUP2 PUSH2 0x93 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xD6 JUMPI PUSH2 0xD5 PUSH2 0x84 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0xE4 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0xF5 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x108 DUP2 PUSH2 0x89 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x123 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0xFF JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x163 DUP3 PUSH2 0x89 JUMP JUMPDEST SWAP2 POP PUSH2 0x16E DUP4 PUSH2 0x89 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x186 JUMPI PUSH2 0x185 PUSH2 0x129 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 0xD2 PUSH0 ORIGIN SWAP11 0xE2 0x21 SAR DUP13 DUP16 SAR PUSH1 0x9C 0x1E LOG2 PUSH5 0x33156AEE93 SWAP6 COINBASE PUSH7 0x2275DEB9517F5F 0x4C 0xD2 PUSH5 0x736F6C6343 STOP ADDMOD AND STOP CALLER shanghai （ 默认项 ）\n由于引入了 push0，代码尺寸更小，并且节省了 gas（参见 EIP-3855）。\n1 PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0xF JUMPI PUSH0 DUP1 REVERT JUMPDEST POP PUSH2 0x1B2 DUP1 PUSH2 0x1D PUSH0 CODECOPY PUSH0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0xF JUMPI PUSH0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x29 JUMPI PUSH0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH2 0x2D JUMPI JUMPDEST PUSH0 DUP1 REVERT JUMPDEST PUSH2 0x47 PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x42 SWAP2 SWAP1 PUSH2 0xB6 JUMP JUMPDEST PUSH2 0x5D JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x54 SWAP2 SWAP1 PUSH2 0x103 JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH0 DUP3 PUSH0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x77 SWAP2 SWAP1 PUSH2 0x149 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH0 DUP1 REVERT JUMPDEST PUSH0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0x95 DUP2 PUSH2 0x83 JUMP JUMPDEST DUP2 EQ PUSH2 0x9F JUMPI PUSH0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xB0 DUP2 PUSH2 0x8C JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xCC JUMPI PUSH2 0xCB PUSH2 0x7F JUMP JUMPDEST JUMPDEST PUSH0 PUSH2 0xD9 DUP6 DUP3 DUP7 ADD PUSH2 0xA2 JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0xEA DUP6 DUP3 DUP7 ADD PUSH2 0xA2 JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0xFD DUP2 PUSH2 0x83 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x116 PUSH0 DUP4 ADD DUP5 PUSH2 0xF4 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH0 REVERT JUMPDEST PUSH0 PUSH2 0x153 DUP3 PUSH2 0x83 JUMP JUMPDEST SWAP2 POP PUSH2 0x15E DUP4 PUSH2 0x83 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x176 JUMPI PUSH2 0x175 PUSH2 0x11C JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 PUSH29 0x74F32E6AEC3D558640FFE2C76B9291FD3C3E09D6326AEF37ECF8889562 DUP14 PUSH27 0x64736F6C6343000816003300000000000000000000000000000000 编译器版本 0.8.22\n1 PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0xF JUMPI PUSH0 DUP1 REVERT JUMPDEST POP PUSH2 0x1B2 DUP1 PUSH2 0x1D PUSH0 CODECOPY PUSH0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0xF JUMPI PUSH0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x29 JUMPI PUSH0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH2 0x2D JUMPI JUMPDEST PUSH0 DUP1 REVERT JUMPDEST PUSH2 0x47 PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x42 SWAP2 SWAP1 PUSH2 0xB6 JUMP JUMPDEST PUSH2 0x5D JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x54 SWAP2 SWAP1 PUSH2 0x103 JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH0 DUP3 PUSH0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x77 SWAP2 SWAP1 PUSH2 0x149 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH0 DUP1 REVERT JUMPDEST PUSH0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0x95 DUP2 PUSH2 0x83 JUMP JUMPDEST DUP2 EQ PUSH2 0x9F JUMPI PUSH0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xB0 DUP2 PUSH2 0x8C JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xCC JUMPI PUSH2 0xCB PUSH2 0x7F JUMP JUMPDEST JUMPDEST PUSH0 PUSH2 0xD9 DUP6 DUP3 DUP7 ADD PUSH2 0xA2 JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0xEA DUP6 DUP3 DUP7 ADD PUSH2 0xA2 JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0xFD DUP2 PUSH2 0x83 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x116 PUSH0 DUP4 ADD DUP5 PUSH2 0xF4 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH0 REVERT JUMPDEST PUSH0 PUSH2 0x153 DUP3 PUSH2 0x83 JUMP JUMPDEST SWAP2 POP PUSH2 0x15E DUP4 PUSH2 0x83 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x176 JUMPI PUSH2 0x175 PUSH2 0x11C JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 PUSH29 0x74F32E6AEC3D558640FFE2C76B9291FD3C3E09D6326AEF37ECF8889562 DUP14 PUSH27 0x64736F6C6343000816003300000000000000000000000000000000 0.8.15\n1 PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1E4 DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x2B JUMPI PUSH1 0x0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH2 0x30 JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x4A PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x45 SWAP2 SWAP1 PUSH2 0xBF JUMP JUMPDEST PUSH2 0x60 JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x57 SWAP2 SWAP1 PUSH2 0x10E JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x7C SWAP2 SWAP1 PUSH2 0x158 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0x9C DUP2 PUSH2 0x89 JUMP JUMPDEST DUP2 EQ PUSH2 0xA7 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xB9 DUP2 PUSH2 0x93 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xD6 JUMPI PUSH2 0xD5 PUSH2 0x84 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0xE4 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0xF5 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x108 DUP2 PUSH2 0x89 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x123 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0xFF JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x163 DUP3 PUSH2 0x89 JUMP JUMPDEST SWAP2 POP PUSH2 0x16E DUP4 PUSH2 0x89 JUMP JUMPDEST SWAP3 POP DUP3 PUSH32 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF SUB DUP3 GT ISZERO PUSH2 0x1A3 JUMPI PUSH2 0x1A2 PUSH2 0x129 JUMP JUMPDEST JUMPDEST DUP3 DUP3 ADD SWAP1 POP SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 DIV 0xBC PUSH15 0xF2B145EB5169F90697C2906D8EAD2 0xE7 0xDD 0xC9 0xE8 ADDRESS 0xDA BLOCKHASH 0xCD 0xD1 ORIGIN PUSH5 0x84D3E16473 PUSH16 0x6C634300080F00330000000000000000 0.7.0\n1 PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0xC7 DUP1 PUSH2 0x1F PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH1 0xF JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH1 0x28 JUMPI PUSH1 0x0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH1 0x2D JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x60 PUSH1 0x4 DUP1 CALLDATASIZE SUB PUSH1 0x40 DUP2 LT ISZERO PUSH1 0x41 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST DUP2 ADD SWAP1 DUP1 DUP1 CALLDATALOAD SWAP1 PUSH1 0x20 ADD SWAP1 SWAP3 SWAP2 SWAP1 DUP1 CALLDATALOAD SWAP1 PUSH1 0x20 ADD SWAP1 SWAP3 SWAP2 SWAP1 POP POP POP PUSH1 0x76 JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 DUP3 DUP2 MSTORE PUSH1 0x20 ADD SWAP2 POP POP PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 ADD SWAP1 POP SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 BALANCE SMOD 0x21 0xB4 0x26 PUSH21 0xC8BB58941A6BB05C6E1CC489D1980BAE866A31279A 0xC5 0x23 MULMOD 0xA5 PUSH31 0x64736F6C634300070000330000000000000000000000000000000000000000 0.6.0\n1 PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0xC7 DUP1 PUSH2 0x1F PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH1 0xF JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH1 0x28 JUMPI PUSH1 0x0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH1 0x2D JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x60 PUSH1 0x4 DUP1 CALLDATASIZE SUB PUSH1 0x40 DUP2 LT ISZERO PUSH1 0x41 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST DUP2 ADD SWAP1 DUP1 DUP1 CALLDATALOAD SWAP1 PUSH1 0x20 ADD SWAP1 SWAP3 SWAP2 SWAP1 DUP1 CALLDATALOAD SWAP1 PUSH1 0x20 ADD SWAP1 SWAP3 SWAP2 SWAP1 POP POP POP PUSH1 0x76 JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 DUP3 DUP2 MSTORE PUSH1 0x20 ADD SWAP2 POP POP PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 ADD SWAP1 POP SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 0xA9 0xB9 0xDB SWAP13 0x2B LOG3 0xE9 SMOD MOD PUSH4 0xB81C6012 DUP14 0xB2 SWAP13 0xB2 0x2C 0xD2 SWAP3 0x1E TIMESTAMP PUSH9 0x5E98B3FB163F0DC964 PUSH20 0x6F6C634300060000330000000000000000000000 编译器输入的 JSON 说明 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 { // 必选：源代码语言。目前支持的是 “Solidity“，“Yul“ 和 “SolidityAST” （实验性的）。 \"language\": \"Solidity\", // 必选 \"sources\": { // 这里的键值是源文件的 “全局“ 名称， // 导入文件可以通过重映射使用其他文件（见下文）。 \"myFile.sol\": { // 可选： 源文件的kaccak256哈希值 // 如果通过URL导入，它用于验证检索的内容。 \"keccak256\": \"0x123...\", // 必选（除非声明了 \"content\" 字段，参见下文）: 指向源文件的URL。 // 应按此顺序导入URL，并根据keccak256哈希值检查结果（如果有的话）。 // 如果哈希值不匹配，或者没有一个URL(s)的结果是成功的，就应该产生一个错误。 // 使用命令行界面只支持文件系统路径。 // 通过JavaScript接口，URL将被传递给用户提供的读取回调，因此可以使用回调支持的任何URL。 \"urls\": [ \"bzzr://56ab...\", \"ipfs://Qma...\", \"/tmp/path/to/file.sol\" // 如果使用文件，其目录应通过 `--allow-paths ` 添加到命令行中。 ] // 如果语言设置为 “SolidityAST”，则需要在 “ast” 字段下提供 AST。 // 请注意，ASTs 的导入是试验性的，尤其是： // - 导入无效的 ASTs 会产生未定义的结果，并且 // - 对无效的 ASTs 不提供适当的错误报告。 // 此外，请注意 AST 导入只消耗编译器在 “stopAfter”（停止后）模式下生成的 AST 字段： // “parsing” 模式下生成的 AST 字段，然后重新执行分析， // 因此 AST 中任何基于分析的注释在导入时都会被忽略。 \"ast\": { ... } // 格式化为 json ast 请求的 ``ast`` 输出选择。 }, \"destructible\": { // 可选：源文件的keccak256哈希值 \"keccak256\": \"0x234...\", // 必选：（除非使用 “urls“）：源文件的字面内容 \"content\": \"contract destructible is owned { function shutdown() { if (msg.sender == owner) selfdestruct(owner); } }\" } }, // 可选 \"settings\": { // 可选： 在给定的阶段后停止编译。目前这里只有 “parsing” 有效。 \"stopAfter\": \"parsing\", // 可选： 经过排序的重映射列表 \"remappings\": [ \":g=/dir\" ], // 可选： 优化器设置 \"optimizer\": { // 默认情况下是禁用的。 // 注意：enabled=false 仍然保留了一些优化功能。见下面的注解。 // 警告：在0.8.6版本之前，省略 “enabled“ 键并不等同于将其设置为false， // 实际上会禁用所有优化。 \"enabled\": true, // 根据您打算运行代码的次数进行优化。 // 较低的值将更多地针对初始部署成本进行优化， // 较高的值将更多地针对高频使用进行优化。 \"runs\": 200, // 打开或关闭优化器组件的细节。 // 上面的 “enabled“ 开关提供了两个默认值， // 可以在这里进行调整。如果给出了 “details“，“enabled“ 可以省略。 \"details\": { // 如果没有给出 details，窥视孔优化器总是打开的，使用 details 来关闭它。 \"peephole\": true, // 如果没有给出 details，内联器总是打开的， // 使用 details来关闭它。 \"inliner\": true, // 如果没有给出 details，未使用的跳板移除器总是打开的， // 使用 details来关闭它。 \"jumpdestRemover\": true, // 在换元运算中，有时会对字词重新排序。 \"orderLiterals\": false, // 移除重复的代码块 \"deduplicate\": false, // 常见的子表达式消除，这是最复杂的步骤，但也能提供最大的收益。 \"cse\": false, // 优化代码中字面数字和字符串的表示。 \"constantOptimizer\": false, // 新的Yul优化器。主要在ABI coder v2 和 内联汇编的代码上运行。 // 它与全局优化器设置一起被激活，并且可以在这里停用。 // 在 Solidity 0.6.0 之前，它必须通过这个开关激活。 \"yul\": false, // Yul优化器的调优选项。 \"yulDetails\": { // 改善变量的堆栈槽的分配，可以提前释放堆栈槽。 // 如果Yul优化器被激活，则默认激活。 \"stackAllocation\": true, // 选择要应用的优化步骤。 // 也可以同时修改优化序列和清理序列。 // 每个序列的指令用 “:” 分隔，该值以 优化-序列:清理-序列 的形式提供。 // 更多信息见 “优化器 \u003e 选择优化”。 // 这个字段是可选的，如果不提供，优化和清理的默认序列都会使用。 // 如果只提供了其中一个选项，另一个将不会被运行。 // 如果只提供分隔符 “:”， // 那么优化和清理序列都不会被运行。 // 如果设置为空值，则只使用默认的清理序列， // 不应用任何优化步骤。 \"optimizerSteps\": \"dhfoDgvulfnTUtnIf...\" } } }, // 编译EVM的版本。 // 影响到类型检查和代码生成。版本可以是 homestead, // tangerineWhistle, spuriousDragon, byzantium, constantinople, petersburg, istanbul, berlin, london or paris \"evmVersion\": \"byzantium\", // 可选：改变编译管道以通过Yul的中间表示法。 // 这在默认情况下是假的。 \"viaIR\": true, // 可选： 调试设置 \"debug\": { // 如何处理 revert（和require）的原因字符串。设置是 // \"default\", \"strip\", \"debug\" 和 \"verboseDebug\"。 // \"default\" 不注入编译器生成的revert字符串，而是保留用户提供的字符串。 // \"strip\" 删除所有的revert字符串（如果可能的话，即如果使用了字面意义），以保持副作用。 // \"debug\" 为编译器生成的内部revert注入字符串，目前为ABI编码器V1和V2实现。 // \"verboseDebug\" 甚至将进一步的信息附加到用户提供的revert字符串中（尚未实现）。 \"revertStrings\": \"default\", // 可选：在产生的EVM汇编和Yul代码的注释中包括多少额外的调试信息。可用的组件是： // - `location`: `@src ::` 形式的注解， // 表明原始 Solidity 文件中相应元素的位置，其中： // - `` 是与 `@us-src` 注释相匹配的文件索引。 // - `` 是该位置的第一个字节的索引。 // - `` 是该位置后第一个字节的索引。 // - `snippet`: 来自 `@src` 所示位置的单行代码片断。 // 该片段有引号，并跟随相应的 `@src` 注释。 // - `*`: 通配符值，可用于请求所有的东西。 \"debugInfo\": [\"location\", \"snippet\"] }, // 元数据设置 (可选) \"metadata\": { // CBOR元数据默认是附加在字节码的最后。 // 将此设置为false，会从运行时和部署时代码中省略元数据。 \"appendCBOR\": true, // 只使用字面内容，不使用URL（默认为false） \"useLiteralContent\": true, // 对附加在字节码上的元数据哈希值使用给定的哈希值方法。 // 元数据哈希可以通过选项 \"none \"从字节码中删除。 // 其他选项是 \"ipfs\" 和 \"bzzr1\"。 // 如果省略该选项，默认使用 \"ipfs\"。 \"bytecodeHash\": \"ipfs\" }, // 库的地址。如果这里没有给出所有的库， // 可能会导致未链接的对象，其输出数据是不同的。 \"libraries\": { // 顶层键是使用该库的源文件的名称。 // 如果使用了重映射，这个源文件应该与应用重映射后的全局路径一致。 // 如果这个键是一个空字符串，那就是指一个全局水平。 \"myFile.sol\": { \"MyLib\": \"0x123123...\" } }, // 以下可用于根据文件和合约名称选择所需的输出。 // 如果这个字段被省略，那么编译器就会加载并进行类型检查，但除了错误之外不会产生任何输出。 // 第一层键是文件名，第二层键是合约名。 // 一个空的合约名称用于不与合约绑定而是与整个源文件绑定的输出，如AST。 // 以星号作为合约名称是指文件中的所有合约。 // 同样地，以星形作为文件名可以匹配所有文件。 // 要选择编译器可能产生的所有输出， // 使用 \"outputSelection\"。{ \"*\": { \"*\": [ \"*\" ], \"\": [ \"*\" ] } }\"， // 但要注意，这可能会不必要地减慢编译过程。 // // 可用的输出类型如下： // // 文件级别（需要空字符串作为合约名称）： // ast - 所有源文件的AST // // 合约级别（需要合约名称或 \"*\"）： // abi - ABI // devdoc - 开发者文档（Natspec格式） // userdoc - 用户文档（Natspec格式） // metadata - 元数据 // ir - 优化代码前的Yul中间表示法 // irOptimized - 优化后的中间表现 // storageLayout - 合约的状态变量的槽位、偏移量和类型 // evm.assembly - 新的汇编格式 // evm.legacyAssembly - JSON中的旧式汇编格式 // evm.bytecode.functionDebugData - 在函数层面的调试信息 // evm.bytecode.object - 字节码对象 // evm.bytecode.opcodes - 操作码列表 // evm.bytecode.sourceMap - 源码映射（对调试有用） // evm.bytecode.linkReferences - 链接引用（如果是未链接的对象） // evm.bytecode.generatedSources - 由编译器生成的源码 // evm.deployedBytecode* - 部署的字节码（拥有evm.bytecode的所有选项）。 // evm.deployedBytecode.immutableReferences - 从AST id到引用不可变的字节码范围的映射 // evm.methodIdentifiers - 函数哈希值的列表 // evm.gasEstimates - 函数gas估计 // ewasm.wast - WebAssembly S-expressions格式的Ewasm // ewasm.wasm - WebAssembly二进制格式的Ewasm // // 注意，使用 `evm`， `evm.bytecode`， `ewasm` 等将选择该输出的每个目标部分。 // 此外，`*` 可以作为通配符来请求所有东西。 // \"outputSelection\": { \"*\": { \"*\": [ \"metadata\", \"evm.bytecode\" // 启用每个合约的元数据和字节码输出。 , \"evm.bytecode.sourceMap\" // 启用每个合约的源码映射输出。 ], \"\": [ \"ast\" // 启用每个文件的AST输出。 ] }, // 启用文件def中定义的MyContract的abi和opcodes输出。 \"def\": { \"MyContract\": [ \"abi\", \"evm.bytecode.opcodes\" ] } }, // modelChecker对象是实验性的，可能会有变化。 \"modelChecker\": { // 选择哪些合约应作为部署的合约进行分析。 \"contracts\": { \"source1.sol\": [\"contract1\"], \"source2.sol\": [\"contract2\", \"contract3\"] }, // 选择除法和模数运算的编码方式。 // 当使用 `false` 时，它们被替换为与松弛变量的乘法。这是默认的。 // 如果您使用CHC引擎而不使用Spacer作为Horn求解器（例如使用Eldarica）， // 建议在这里使用 `true`。 // 关于这个选项的更详细的解释，请参见形式验证部分。 \"divModWithSlacks\": false, // 选择要使用的模型检查器引擎：所有（默认）， bmc， chc， 无。 \"engine\": \"chc\", // 选择在编译时可获得被调用函数代码的情况下， // 外部调用是否应被视为可信。 // 详情请参阅SMT检查器部分。 \"extCalls\": \"trusted\", // 选择哪些类型的不变性应该报告给用户：合约，重入。 \"invariants\": [\"contract\", \"reentrancy\"], // 选择是否输出所有验证过的目标。默认为 `false`。 \"showProved\": true, // 选择是否输出所有未验证的目标。默认为 `false`。 \"showUnproved\": true, // 选择是否输出所有不支持的语言功能。默认为 `false`。 \"showUnsupported\": true, // 如果有的话，选择应该使用哪些求解器。 // 关于求解器的描述，见形式验证部分。 \"solvers\": [\"cvc4\", \"smtlib2\", \"z3\"], // 选择哪些目标应该被检查：常数条件，下溢，溢出，除以零，余额，断言，弹出空数组，界外。 // 如果没有给出该选项，所有目标都被默认检查，除了 Solidity \u003e=0.8.7 的下溢/溢出。 // 目标描述见形式化验证部分。 \"targets\": [\"underflow\", \"overflow\", \"assert\"], // 每个SMT查询的超时时间，以毫秒为单位。 // 如果没有给出这个选项，SMTChecker将默认使用确定性的资源限制。 // 给定超时为0意味着任何查询都没有资源/时间限制。 \"timeout\": 20000 } } } CSP 高精度算法 P1009 [NOIP1998 普及组] 阶乘之和\n使用字符串存储大数，运算时参考竖式进行。\n加法运算 大数加法运算直接模拟竖式加法即可。把对应位相加并将结果存入一个定义好长度的数组（放在对应位处），先不必考虑每一位的进位情况，直接存数即可。当算完得到结果数组后，从最后一位（个位）开始检查进位情况，如果有进位（大于 10）则调整该位及其高一位的数。当遍历完整个数组后再将数组转化成字符串返回即可。\n减法运算 大数减法需要判断一下被减数与减数的大小，保证被减数大于减数，如果不满足则交换两个字符串数并在答案字符串中存入一个负号(\"-\")。然后模拟竖式加法，把对应位相减的结果存入一个定义好长度的数组的对应位处（不考虑每一位的借位情况），然后从个位开始检查借位，如果有借位（小于 0）则调整该位及其高一位的数，最后转化数组为字符串并返回。\n乘法运算 乘法运算仍旧是模拟竖式乘法，不考虑进位，将每位相乘结果存入数组对应位处（这里需要累加存入，竖式乘法每一位最后算结果时，不一定是两位相加有可能是多位），然后依旧是从个位开始检查进位，最后转化数组并返回结果。\n除法运算 自然数范围内的除法模拟不出精确的小数结果，所以函数最后需要返回两个值一个是商一个是余数。除法的模拟运算用到了大数减法，思想依旧是模拟竖式的除法：\n从最高位依次取数直到大于等于除数为止 然后用目前取到的数减去若干个除数（直到减到小于除数为止） 记录减去了几个除数，最后将此数存入答案字符串 将记录清零然后再从被除数中再取一个数，判断是否小于除数 如果小于则直接将 0 加到答案字符串末尾 否则转入步骤 2 然后将最后记录加到答案字符串末尾 直到将被除数中的数取完为止 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 #include #include using namespace std; //...................................................................................... int myCompare(string a, string b) // 大数比较设定a\u003eb返回1 a",
  "wordCount" : "7546",
  "inLanguage": "en",
  "image":"https://github.com/lxmliu2002/images/raw/main/homepage/home-bg-03.jpg","datePublished": "2024-01-24T00:00:00Z",
  "dateModified": "2024-01-24T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "lxmliu2002"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://lxmliu2002.github.io/posts/compiler--csp/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "lxmliu2002's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://lxmliu2002.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lxmliu2002.github.io/" accesskey="h" title="lxmliu2002&#39;s Blog (Alt + H)">lxmliu2002&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://lxmliu2002.github.io/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://lxmliu2002.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://lxmliu2002.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://lxmliu2002.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://lxmliu2002.github.io/" title="homepage">
                    <span>homepage</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://lxmliu2002.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://lxmliu2002.github.io/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Compiler &amp; CSP
    </h1>
    <div class="post-description">
      CSP 备考的相关知识，与 solidity 智能合约编译过程的研究
    </div>
    <div class="post-meta"><span title='2024-01-24 00:00:00 +0000 UTC'>January 24, 2024</span>&nbsp;·&nbsp;36 min&nbsp;·&nbsp;lxmliu2002&nbsp;|&nbsp;<a href="https://github.com/lxmliu2002/My_Blog/tree/master/content/posts/Compiler-&amp;-CSP.markdown" rel="noopener noreferrer" target="_blank">Any Suggestions?</a>

</div>
  </header> 
<figure class="entry-cover"><img loading="eager" src="https://github.com/lxmliu2002/images/raw/main/homepage/home-bg-03.jpg" alt="">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#compiler" aria-label="Compiler">Compiler</a><ul>
                        <ul>
                        
                <li>
                    <a href="#%e5%ad%97%e8%8a%82%e7%a0%81%e7%bb%84%e6%88%90" aria-label="字节码组成">字节码组成</a></li>
                <li>
                    <a href="#metadata" aria-label="Metadata">Metadata</a></li>
                <li>
                    <a href="#%e4%bc%98%e5%8c%96%e5%99%a8%e9%80%89%e9%a1%b9" aria-label="优化器选项">优化器选项</a></li>
                <li>
                    <a href="#%e5%ba%93%e9%93%be%e6%8e%a5" aria-label="库链接">库链接</a></li>
                <li>
                    <a href="#evm-%e7%89%88%e6%9c%ac" aria-label="EVM 版本">EVM 版本</a></li>
                <li>
                    <a href="#%e7%bc%96%e8%af%91%e5%99%a8%e7%89%88%e6%9c%ac" aria-label="编译器版本">编译器版本</a></li>
                <li>
                    <a href="#%e7%bc%96%e8%af%91%e5%99%a8%e8%be%93%e5%85%a5%e7%9a%84-json-%e8%af%b4%e6%98%8e" aria-label="编译器输入的 JSON 说明">编译器输入的 JSON 说明</a></li></ul>
                    </ul>
                </li>
                <li>
                    <a href="#csp" aria-label="CSP">CSP</a><ul>
                        
                <li>
                    <a href="#%e9%ab%98%e7%b2%be%e5%ba%a6%e7%ae%97%e6%b3%95" aria-label="高精度算法">高精度算法</a><ul>
                        
                <li>
                    <a href="#%e5%8a%a0%e6%b3%95%e8%bf%90%e7%ae%97" aria-label="加法运算">加法运算</a></li>
                <li>
                    <a href="#%e5%87%8f%e6%b3%95%e8%bf%90%e7%ae%97" aria-label="减法运算">减法运算</a></li>
                <li>
                    <a href="#%e4%b9%98%e6%b3%95%e8%bf%90%e7%ae%97" aria-label="乘法运算">乘法运算</a></li>
                <li>
                    <a href="#%e9%99%a4%e6%b3%95%e8%bf%90%e7%ae%97" aria-label="除法运算">除法运算</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="compiler">Compiler<a hidden class="anchor" aria-hidden="true" href="#compiler">#</a></h1>
<blockquote>
<p><a href="https://docs.soliditylang.org/zh/latest">https://docs.soliditylang.org/zh/latest</a></p>
<p><a href="https://docs.soliditylang.org/en/v0.8.23">https://docs.soliditylang.org/en/v0.8.23</a></p>
<p><a href="https://medium.com/@filscanteam/filscan-%E6%B5%85%E8%B0%88fevm%E5%90%88%E7%BA%A6%E9%AA%8C%E8%AF%81-cb094af8f2fc">Filscan: FEVM合约验证的那些事</a></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-solidity" data-lang="solidity"><span class="line"><span class="cl"><span class="c1">// SPDX-License-Identifier: MIT
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">pragma solidity</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">contract</span> <span class="nc">SimpleVoting</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint256</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">uint256</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">function</span> <span class="nf">add</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">a2</span><span class="p">)</span> <span class="k">public</span> <span class="k">returns</span><span class="p">(</span><span class="kt">uint256</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="n">a1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">=</span> <span class="n">a2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="字节码组成">字节码组成<a hidden class="anchor" aria-hidden="true" href="#字节码组成">#</a></h3>
<ol>
<li><code>.code</code>：这一部分是创建合约时执行的汇编指令，它通常包括合约的构造函数以及在合约部署过程中需要执行的初始化代码。一旦合约部署完成，.code 部分的指令将不再被执行。</li>
<li><code>.data</code>：这一部分是合约内容的汇编指令，包含了合约的主要执行逻辑，包括函数的定义和实现、变量的初始化和操作、事件的触发等。这些指令会在合约被调用时被执行，用于处理交易和状态的改变。</li>
</ol>
<blockquote>
<p>以 <code>CODECOPY</code> 为分界？前面为初始化部分（.code），后面为合约内容（.data）</p>
<blockquote>
<p><code>CODECOPY</code>：copy executing contract&rsquo;s bytecode</p>
<p><a href="https://www.ethervm.io/">Ethereum Virtual Machine Opcodes</a></p>
</blockquote>
</blockquote>
<h3 id="metadata">Metadata<a hidden class="anchor" aria-hidden="true" href="#metadata">#</a></h3>
<p>通常 Solidity 编译器会将经过 CBOR 方式编码的 <strong>Metadata 文件的哈希值</strong>及一些其他信息（如 ipfs、solc 版本等）附加到合约字节码的末尾，字节码末尾的 Metadata 哈希成为锁定整个编译过程所涉及的相关信息的指纹。</p>
<p>通过命令行标志 <code>--no-cbor-metadata</code> 或标准 JSON 输入中的布尔字段 <code>settings.metadata.appendCBOR</code> 设置为 false 可用于跳过将 Metadata 附加到已部署字节码的末尾。</p>
<h3 id="优化器选项">优化器选项<a hidden class="anchor" aria-hidden="true" href="#优化器选项">#</a></h3>
<p>在编译时使用 <code>solc --optimize --bin sourceFile.sol</code> 激活优化器。solidity 编译器使用两种不同的优化方式，老的优化器直接优化编译过后的 opcode，新的优化器优化 Yul IR 代码。优化器会尝试优化代码，包括死代码删除、常量表达式计算、内联函数等，影响如下：</p>
<ul>
<li>函数调度程序中二进制搜索的大小</li>
<li>大数字或字符串等常量的存储方式</li>
</ul>
<p>默认情况下，优化器假设合约会执行 200 次。</p>
<ul>
<li>
<p>部署合约代价低，函数执行代价高 =&gt; 设置 <code>--optimize-runs=1</code> =&gt; 字节码小，部署成本低</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">--optimize-runs<span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">608060405234801561000f575f80fd5b5060d88061001c5f395ff3fe6080604052348015600e575f80fd5b50600436106026575f3560e01c8063771602f714602a575b5f80fd5b603960353660046065565b604b565b60405190815260200160405180910390f35b5f8281556001829055605c82846084565b90505b92915050565b5f80604083850312156075575f80fd5b50508035926020909101359150565b80820180821115605f57634e487b7160e01b5f52601160045260245ffdfea264697066735822122004ae56a0249ee3f53260881591e39b22a4653c42195083a2bf2617a7005c751964736f6c63430008160033
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>执行次数更高（有更多交易），不考虑部署成本及输出 =&gt; 调高 <code>--optimize-runs</code> =&gt; 字节码大，部署成本高，但运行消耗的 gas 小。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">--optimize-runs<span class="o">=</span><span class="m">1000</span>
</span></span><span class="line"><span class="cl">608060405234801561000f575f80fd5b5060f18061001c5f395ff3fe6080604052348015600e575f80fd5b50600436106026575f3560e01c8063771602f714602a575b5f80fd5b603960353660046065565b604b565b60405190815260200160405180910390f35b5f8281556001829055605c82846084565b90505b92915050565b5f80604083850312156075575f80fd5b50508035926020909101359150565b80820180821115605f577f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffdfea264697066735822122042318f59dbd71f9bc8436b4de5a288a86c58c42782a37bb0b6c66998ad1de8b964736f6c63430008160033
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p><img alt="1705910968228" loading="lazy" src="https://github.com/lxmliu2002/images/raw/main/post/20240124/1706088649099.png"></p>
<h3 id="库链接">库链接<a hidden class="anchor" aria-hidden="true" href="#库链接">#</a></h3>
<p>如果调用 <code>solc</code> 时带有 <code>--link</code> 选项，所有输入文件都被编译成格式为 <code>__$53aea86b7d70b31448b230b20ae141a537$__</code> 形式的未链接的二进制文件（十六进制编码），并被本地链接（如果从标准输入（stdin）读取输入，则被写到标准输出（stdout））。这些字符串是实际库的地址的占位符。此占位符是<strong>完全限定库名</strong>的 keccak256 哈希的十六进制编码的34个字符前缀。</p>
<p>替换占位符的过程通常涉及将占位符与实际的库地址进行映射，并将映射关系应用于合约编译结果中的相应位置，这确保了验证过程能够正确地定位和访问库的相关代码和功能。</p>
<p><img alt="1705910968228" loading="lazy" src="https://github.com/lxmliu2002/images/raw/main/post/20240124/1706088992259.png"></p>
<h3 id="evm-版本">EVM 版本<a hidden class="anchor" aria-hidden="true" href="#evm-版本">#</a></h3>
<blockquote>
<p>在错误的EVM版本进行编译会导致错误，奇怪和失败的行为。</p>
</blockquote>
<p>使用 <code>solc --evm-version &lt;VERSION&gt; contract.sol</code> 命令选择 EVM 版本。以下是一个EVM版本的列表，以及每个版本中引入的编译器相关变化。 每个版本之间不保证向后兼容。</p>
<ul>
<li>
<p><code>homestead</code></p>
<ul>
<li>
<p>（最老的版本）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1DF DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x48 JUMPI PUSH1 0x0 CALLDATALOAD PUSH29 0x100000000000000000000000000000000000000000000000000000000 SWAP1 DIV DUP1 PUSH4 0x771602F7 EQ PUSH2 0x4D JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x67 PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x62 SWAP2 SWAP1 PUSH2 0xDC JUMP JUMPDEST PUSH2 0x7D JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x74 SWAP2 SWAP1 PUSH2 0x12B JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x99 SWAP2 SWAP1 PUSH2 0x175 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0xB9 DUP2 PUSH2 0xA6 JUMP JUMPDEST DUP2 EQ PUSH2 0xC4 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xD6 DUP2 PUSH2 0xB0 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xF3 JUMPI PUSH2 0xF2 PUSH2 0xA1 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0x101 DUP6 DUP3 DUP7 ADD PUSH2 0xC7 JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0x112 DUP6 DUP3 DUP7 ADD PUSH2 0xC7 JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x125 DUP2 PUSH2 0xA6 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x140 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0x11C JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x180 DUP3 PUSH2 0xA6 JUMP JUMPDEST SWAP2 POP PUSH2 0x18B DUP4 PUSH2 0xA6 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x1A3 JUMPI PUSH2 0x1A2 PUSH2 0x146 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 0x5D SELFDESTRUCT 0xCA 0xB1 CALLDATACOPY PC PUSH18 0x78F2DFB493B7BE81E6F7432DB582BA640940 PUSH8 0x5F11721F13F56473 PUSH16 0x6C634300081600330000000000000000
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p><code>tangerineWhistle</code></p>
<ul>
<li>
<p>访问其他账户的 gas 成本增加，与 gas 估算和优化器有关。对于外部调用，所有 gas 都是默认发送的，以前必须保留一定的数量。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1DF DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x48 JUMPI PUSH1 0x0 CALLDATALOAD PUSH29 0x100000000000000000000000000000000000000000000000000000000 SWAP1 DIV DUP1 PUSH4 0x771602F7 EQ PUSH2 0x4D JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x67 PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x62 SWAP2 SWAP1 PUSH2 0xDC JUMP JUMPDEST PUSH2 0x7D JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x74 SWAP2 SWAP1 PUSH2 0x12B JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x99 SWAP2 SWAP1 PUSH2 0x175 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0xB9 DUP2 PUSH2 0xA6 JUMP JUMPDEST DUP2 EQ PUSH2 0xC4 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xD6 DUP2 PUSH2 0xB0 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xF3 JUMPI PUSH2 0xF2 PUSH2 0xA1 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0x101 DUP6 DUP3 DUP7 ADD PUSH2 0xC7 JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0x112 DUP6 DUP3 DUP7 ADD PUSH2 0xC7 JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x125 DUP2 PUSH2 0xA6 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x140 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0x11C JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x180 DUP3 PUSH2 0xA6 JUMP JUMPDEST SWAP2 POP PUSH2 0x18B DUP4 PUSH2 0xA6 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x1A3 JUMPI PUSH2 0x1A2 PUSH2 0x146 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 0xF9 JUMP PUSH10 0x972668A9ADEF8DF3CA00 0x2F 0xA6 0xBA DIV SDIV 0xEC DUP9 0xE1 PUSH24 0xA56339895DE1534CA35464736F6C63430008160033000000
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p><code>spuriousDragon</code></p>
<ul>
<li>
<p><code>exp</code> 操作码的 gas 成本增加，与 gas 估计和优化器有关。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1DF DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x48 JUMPI PUSH1 0x0 CALLDATALOAD PUSH29 0x100000000000000000000000000000000000000000000000000000000 SWAP1 DIV DUP1 PUSH4 0x771602F7 EQ PUSH2 0x4D JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x67 PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x62 SWAP2 SWAP1 PUSH2 0xDC JUMP JUMPDEST PUSH2 0x7D JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x74 SWAP2 SWAP1 PUSH2 0x12B JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x99 SWAP2 SWAP1 PUSH2 0x175 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0xB9 DUP2 PUSH2 0xA6 JUMP JUMPDEST DUP2 EQ PUSH2 0xC4 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xD6 DUP2 PUSH2 0xB0 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xF3 JUMPI PUSH2 0xF2 PUSH2 0xA1 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0x101 DUP6 DUP3 DUP7 ADD PUSH2 0xC7 JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0x112 DUP6 DUP3 DUP7 ADD PUSH2 0xC7 JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x125 DUP2 PUSH2 0xA6 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x140 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0x11C JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x180 DUP3 PUSH2 0xA6 JUMP JUMPDEST SWAP2 POP PUSH2 0x18B DUP4 PUSH2 0xA6 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x1A3 JUMPI PUSH2 0x1A2 PUSH2 0x146 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 PUSH15 0x83A1CE49DDE567C411F39C4A5795EF 0xB3 ISZERO DUP16 SWAP14 RETURNDATASIZE BALANCE NOT ADD 0xF ADD ORIGIN PUSH7 0x7201370C64736F PUSH13 0x63430008160033000000000000
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p><code>byzantium</code></p>
<ul>
<li>
<p>在汇编中可使用操作码 <code>returndatacopy</code>， <code>returndatasize</code> 和 <code>staticcall</code>。<code>staticcall</code> 操作码在调用非库合约 view 或 pure 函数时使用，它可以防止函数在 EVM 级别修改状态，也就是说，甚至适用于您使用无效的类型转换时。可以访问从函数调用返回的动态数据。引入了 <code>revert</code> 操作码，这意味着 <code>revert</code> 将不会浪费 gas。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1DF DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x48 JUMPI PUSH1 0x0 CALLDATALOAD PUSH29 0x100000000000000000000000000000000000000000000000000000000 SWAP1 DIV DUP1 PUSH4 0x771602F7 EQ PUSH2 0x4D JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x67 PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x62 SWAP2 SWAP1 PUSH2 0xDC JUMP JUMPDEST PUSH2 0x7D JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x74 SWAP2 SWAP1 PUSH2 0x12B JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x99 SWAP2 SWAP1 PUSH2 0x175 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0xB9 DUP2 PUSH2 0xA6 JUMP JUMPDEST DUP2 EQ PUSH2 0xC4 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xD6 DUP2 PUSH2 0xB0 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xF3 JUMPI PUSH2 0xF2 PUSH2 0xA1 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0x101 DUP6 DUP3 DUP7 ADD PUSH2 0xC7 JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0x112 DUP6 DUP3 DUP7 ADD PUSH2 0xC7 JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x125 DUP2 PUSH2 0xA6 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x140 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0x11C JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x180 DUP3 PUSH2 0xA6 JUMP JUMPDEST SWAP2 POP PUSH2 0x18B DUP4 PUSH2 0xA6 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x1A3 JUMPI PUSH2 0x1A2 PUSH2 0x146 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 0xD DUP13 PUSH1 0x71 PUSH0 DUP14 0xCF RETURN 0xD5 0xE4 PUSH12 0x5507BD3D6C4BF4CFC1052568 SWAP12 0xB0 LOG2 0x49 DUP4 SDIV 0xE9 0xC5 0xF6 PUSH5 0x736F6C6343 STOP ADDMOD AND STOP CALLER
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p><code>constantinople</code></p>
<ul>
<li>
<p>在汇编中可使用操作码 <code>create2</code>, <code>extcodehash</code>, <code>shl</code>, <code>shr</code> 和 <code>sar</code>。移位运算符使用移位运算码，因此需要的 gas 较少。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1C2 DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x2B JUMPI PUSH1 0x0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH2 0x30 JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x4A PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x45 SWAP2 SWAP1 PUSH2 0xBF JUMP JUMPDEST PUSH2 0x60 JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x57 SWAP2 SWAP1 PUSH2 0x10E JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x7C SWAP2 SWAP1 PUSH2 0x158 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0x9C DUP2 PUSH2 0x89 JUMP JUMPDEST DUP2 EQ PUSH2 0xA7 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xB9 DUP2 PUSH2 0x93 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xD6 JUMPI PUSH2 0xD5 PUSH2 0x84 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0xE4 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0xF5 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x108 DUP2 PUSH2 0x89 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x123 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0xFF JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x163 DUP3 PUSH2 0x89 JUMP JUMPDEST SWAP2 POP PUSH2 0x16E DUP4 PUSH2 0x89 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x186 JUMPI PUSH2 0x185 PUSH2 0x129 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 SAR SIGNEXTEND 0xCA PUSH9 0x6272C56E1B7EC48BCB SWAP14 CALLDATALOAD XOR 0xE9 0x5D 0x2F 0x2D DUP7 0xE1 0xCD PUSH15 0xCB62CD0BDF6467AB64736F6C634300 ADDMOD AND STOP CALLER
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p><code>petersburg</code></p>
<ul>
<li>
<p>编译器的行为与 constantinople 版本的行为相同。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1C2 DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x2B JUMPI PUSH1 0x0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH2 0x30 JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x4A PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x45 SWAP2 SWAP1 PUSH2 0xBF JUMP JUMPDEST PUSH2 0x60 JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x57 SWAP2 SWAP1 PUSH2 0x10E JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x7C SWAP2 SWAP1 PUSH2 0x158 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0x9C DUP2 PUSH2 0x89 JUMP JUMPDEST DUP2 EQ PUSH2 0xA7 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xB9 DUP2 PUSH2 0x93 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xD6 JUMPI PUSH2 0xD5 PUSH2 0x84 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0xE4 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0xF5 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x108 DUP2 PUSH2 0x89 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x123 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0xFF JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x163 DUP3 PUSH2 0x89 JUMP JUMPDEST SWAP2 POP PUSH2 0x16E DUP4 PUSH2 0x89 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x186 JUMPI PUSH2 0x185 PUSH2 0x129 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 0xF6 TIMESTAMP 0xCE 0xA7 SWAP2 PUSH10 0xA56F5782E5B5B7A788B5 JUMPI DUP1 0x28 PUSH7 0x945664E8192C7C 0xBB 0xB7 DUP10 0x2B 0x4F PUSH5 0x736F6C6343 STOP ADDMOD AND STOP CALLER
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p><code>istanbul</code></p>
<ul>
<li>
<p>在汇编中可使用操作码 <code>chainid</code> 和 <code>selfbalance</code>。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1C2 DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x2B JUMPI PUSH1 0x0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH2 0x30 JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x4A PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x45 SWAP2 SWAP1 PUSH2 0xBF JUMP JUMPDEST PUSH2 0x60 JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x57 SWAP2 SWAP1 PUSH2 0x10E JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x7C SWAP2 SWAP1 PUSH2 0x158 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0x9C DUP2 PUSH2 0x89 JUMP JUMPDEST DUP2 EQ PUSH2 0xA7 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xB9 DUP2 PUSH2 0x93 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xD6 JUMPI PUSH2 0xD5 PUSH2 0x84 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0xE4 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0xF5 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x108 DUP2 PUSH2 0x89 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x123 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0xFF JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x163 DUP3 PUSH2 0x89 JUMP JUMPDEST SWAP2 POP PUSH2 0x16E DUP4 PUSH2 0x89 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x186 JUMPI PUSH2 0x185 PUSH2 0x129 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 SWAP2 0x25 DELEGATECALL PUSH4 0x4BF84E17 PC SELFDESTRUCT PUSH29 0x735401FD80347DCC85EEE8FD49D8DB4521883ABC7F64736F6C63430008 AND STOP CALLER
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p><code>berlin</code></p>
<ul>
<li>
<p><code>SLOAD</code>， <code>*CALL</code>， <code>BALANCE</code>， <code>EXT*</code> 和 <code>SELFDESTRUCT</code> 的 gas 成本增加。 编译器假设这类操作的 gas 成本是固定的。这与 gas 估计和优化器有关。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1C2 DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x2B JUMPI PUSH1 0x0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH2 0x30 JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x4A PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x45 SWAP2 SWAP1 PUSH2 0xBF JUMP JUMPDEST PUSH2 0x60 JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x57 SWAP2 SWAP1 PUSH2 0x10E JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x7C SWAP2 SWAP1 PUSH2 0x158 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0x9C DUP2 PUSH2 0x89 JUMP JUMPDEST DUP2 EQ PUSH2 0xA7 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xB9 DUP2 PUSH2 0x93 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xD6 JUMPI PUSH2 0xD5 PUSH2 0x84 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0xE4 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0xF5 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x108 DUP2 PUSH2 0x89 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x123 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0xFF JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x163 DUP3 PUSH2 0x89 JUMP JUMPDEST SWAP2 POP PUSH2 0x16E DUP4 PUSH2 0x89 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x186 JUMPI PUSH2 0x185 PUSH2 0x129 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 STOP KECCAK256 LOG3 0xD0 MULMOD 0x26 SWAP1 0xB5 POP 0xDA STOP 0x25 0xB2 0xC9 PUSH30 0xFC1877A52773280386B2CDFAACACBF231D64736F6C634300081600330000
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p><code>london</code></p>
<ul>
<li>
<p>区块的基本费用（ <a href="https://eips.ethereum.org/EIPS/eip-3198">EIP-3198</a> 和 <a href="https://eips.ethereum.org/EIPS/eip-1559">EIP-1559</a> ） 可以通过全局的 <code>block.basefee</code> 或内联汇编中的 <code>basefee()</code> 访问。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1C2 DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x2B JUMPI PUSH1 0x0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH2 0x30 JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x4A PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x45 SWAP2 SWAP1 PUSH2 0xBF JUMP JUMPDEST PUSH2 0x60 JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x57 SWAP2 SWAP1 PUSH2 0x10E JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x7C SWAP2 SWAP1 PUSH2 0x158 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0x9C DUP2 PUSH2 0x89 JUMP JUMPDEST DUP2 EQ PUSH2 0xA7 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xB9 DUP2 PUSH2 0x93 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xD6 JUMPI PUSH2 0xD5 PUSH2 0x84 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0xE4 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0xF5 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x108 DUP2 PUSH2 0x89 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x123 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0xFF JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x163 DUP3 PUSH2 0x89 JUMP JUMPDEST SWAP2 POP PUSH2 0x16E DUP4 PUSH2 0x89 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x186 JUMPI PUSH2 0x185 PUSH2 0x129 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 0xC7 PUSH10 0x4DF9F0DFC720CF5FC0EA 0x21 0xCD SHR 0xBF 0xB9 0xD1 LOG3 0xD5 0xD9 0xBC 0xB0 0xC6 DUP12 EXP PUSH23 0xB142E28C5464736F6C6343000816003300000000000000
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p><code>paris</code></p>
<ul>
<li>
<p>引入了 <code>prevrandao()</code> 和 <code>block.prevrandao</code>，并改变了现在已经废弃的 <code>block.difficulty</code> 的语义，不允许在内联汇编中使用 <code>difficulty()</code> （见 <a href="https://eips.ethereum.org/EIPS/eip-4399">EIP-4399</a> ）。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1C2 DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x2B JUMPI PUSH1 0x0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH2 0x30 JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x4A PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x45 SWAP2 SWAP1 PUSH2 0xBF JUMP JUMPDEST PUSH2 0x60 JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x57 SWAP2 SWAP1 PUSH2 0x10E JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x7C SWAP2 SWAP1 PUSH2 0x158 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0x9C DUP2 PUSH2 0x89 JUMP JUMPDEST DUP2 EQ PUSH2 0xA7 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xB9 DUP2 PUSH2 0x93 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xD6 JUMPI PUSH2 0xD5 PUSH2 0x84 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0xE4 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0xF5 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x108 DUP2 PUSH2 0x89 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x123 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0xFF JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x163 DUP3 PUSH2 0x89 JUMP JUMPDEST SWAP2 POP PUSH2 0x16E DUP4 PUSH2 0x89 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x186 JUMPI PUSH2 0x185 PUSH2 0x129 JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 0xD2 PUSH0 ORIGIN SWAP11 0xE2 0x21 SAR DUP13 DUP16 SAR PUSH1 0x9C 0x1E LOG2 PUSH5 0x33156AEE93 SWAP6 COINBASE PUSH7 0x2275DEB9517F5F 0x4C 0xD2 PUSH5 0x736F6C6343 STOP ADDMOD AND STOP CALLER
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p><code>shanghai</code> （ <strong>默认项</strong> ）</p>
<ul>
<li>
<p>由于引入了 <code>push0</code>，代码尺寸更小，并且节省了 gas（参见 <a href="https://eips.ethereum.org/EIPS/eip-3855">EIP-3855</a>）。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0xF JUMPI PUSH0 DUP1 REVERT JUMPDEST POP PUSH2 0x1B2 DUP1 PUSH2 0x1D PUSH0 CODECOPY PUSH0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0xF JUMPI PUSH0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x29 JUMPI PUSH0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH2 0x2D JUMPI JUMPDEST PUSH0 DUP1 REVERT JUMPDEST PUSH2 0x47 PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x42 SWAP2 SWAP1 PUSH2 0xB6 JUMP JUMPDEST PUSH2 0x5D JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x54 SWAP2 SWAP1 PUSH2 0x103 JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH0 DUP3 PUSH0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x77 SWAP2 SWAP1 PUSH2 0x149 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH0 DUP1 REVERT JUMPDEST PUSH0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0x95 DUP2 PUSH2 0x83 JUMP JUMPDEST DUP2 EQ PUSH2 0x9F JUMPI PUSH0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xB0 DUP2 PUSH2 0x8C JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xCC JUMPI PUSH2 0xCB PUSH2 0x7F JUMP JUMPDEST JUMPDEST PUSH0 PUSH2 0xD9 DUP6 DUP3 DUP7 ADD PUSH2 0xA2 JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0xEA DUP6 DUP3 DUP7 ADD PUSH2 0xA2 JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0xFD DUP2 PUSH2 0x83 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x116 PUSH0 DUP4 ADD DUP5 PUSH2 0xF4 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH0 REVERT JUMPDEST PUSH0 PUSH2 0x153 DUP3 PUSH2 0x83 JUMP JUMPDEST SWAP2 POP PUSH2 0x15E DUP4 PUSH2 0x83 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x176 JUMPI PUSH2 0x175 PUSH2 0x11C JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 PUSH29 0x74F32E6AEC3D558640FFE2C76B9291FD3C3E09D6326AEF37ECF8889562 DUP14 PUSH27 0x64736F6C6343000816003300000000000000000000000000000000
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
<p><img alt="1705910968228" loading="lazy" src="https://github.com/lxmliu2002/images/raw/main/post/20240124/image-20240124173130637.png"></p>
<h3 id="编译器版本">编译器版本<a hidden class="anchor" aria-hidden="true" href="#编译器版本">#</a></h3>
<ul>
<li>
<p>0.8.22</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0xF JUMPI PUSH0 DUP1 REVERT JUMPDEST POP PUSH2 0x1B2 DUP1 PUSH2 0x1D PUSH0 CODECOPY PUSH0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0xF JUMPI PUSH0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x29 JUMPI PUSH0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH2 0x2D JUMPI JUMPDEST PUSH0 DUP1 REVERT JUMPDEST PUSH2 0x47 PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x42 SWAP2 SWAP1 PUSH2 0xB6 JUMP JUMPDEST PUSH2 0x5D JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x54 SWAP2 SWAP1 PUSH2 0x103 JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH0 DUP3 PUSH0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x77 SWAP2 SWAP1 PUSH2 0x149 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH0 DUP1 REVERT JUMPDEST PUSH0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0x95 DUP2 PUSH2 0x83 JUMP JUMPDEST DUP2 EQ PUSH2 0x9F JUMPI PUSH0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xB0 DUP2 PUSH2 0x8C JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xCC JUMPI PUSH2 0xCB PUSH2 0x7F JUMP JUMPDEST JUMPDEST PUSH0 PUSH2 0xD9 DUP6 DUP3 DUP7 ADD PUSH2 0xA2 JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0xEA DUP6 DUP3 DUP7 ADD PUSH2 0xA2 JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0xFD DUP2 PUSH2 0x83 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x116 PUSH0 DUP4 ADD DUP5 PUSH2 0xF4 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH0 REVERT JUMPDEST PUSH0 PUSH2 0x153 DUP3 PUSH2 0x83 JUMP JUMPDEST SWAP2 POP PUSH2 0x15E DUP4 PUSH2 0x83 JUMP JUMPDEST SWAP3 POP DUP3 DUP3 ADD SWAP1 POP DUP1 DUP3 GT ISZERO PUSH2 0x176 JUMPI PUSH2 0x175 PUSH2 0x11C JUMP JUMPDEST JUMPDEST SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 PUSH29 0x74F32E6AEC3D558640FFE2C76B9291FD3C3E09D6326AEF37ECF8889562 DUP14 PUSH27 0x64736F6C6343000816003300000000000000000000000000000000
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>0.8.15</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH2 0x1E4 DUP1 PUSH2 0x20 PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH2 0x2B JUMPI PUSH1 0x0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH2 0x30 JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH2 0x4A PUSH1 0x4 DUP1 CALLDATASIZE SUB DUP2 ADD SWAP1 PUSH2 0x45 SWAP2 SWAP1 PUSH2 0xBF JUMP JUMPDEST PUSH2 0x60 JUMP JUMPDEST PUSH1 0x40 MLOAD PUSH2 0x57 SWAP2 SWAP1 PUSH2 0x10E JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 PUSH2 0x7C SWAP2 SWAP1 PUSH2 0x158 JUMP JUMPDEST SWAP1 POP SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x0 DUP2 SWAP1 POP SWAP2 SWAP1 POP JUMP JUMPDEST PUSH2 0x9C DUP2 PUSH2 0x89 JUMP JUMPDEST DUP2 EQ PUSH2 0xA7 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP JUMP JUMPDEST PUSH1 0x0 DUP2 CALLDATALOAD SWAP1 POP PUSH2 0xB9 DUP2 PUSH2 0x93 JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH1 0x0 DUP1 PUSH1 0x40 DUP4 DUP6 SUB SLT ISZERO PUSH2 0xD6 JUMPI PUSH2 0xD5 PUSH2 0x84 JUMP JUMPDEST JUMPDEST PUSH1 0x0 PUSH2 0xE4 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP3 POP POP PUSH1 0x20 PUSH2 0xF5 DUP6 DUP3 DUP7 ADD PUSH2 0xAA JUMP JUMPDEST SWAP2 POP POP SWAP3 POP SWAP3 SWAP1 POP JUMP JUMPDEST PUSH2 0x108 DUP2 PUSH2 0x89 JUMP JUMPDEST DUP3 MSTORE POP POP JUMP JUMPDEST PUSH1 0x0 PUSH1 0x20 DUP3 ADD SWAP1 POP PUSH2 0x123 PUSH1 0x0 DUP4 ADD DUP5 PUSH2 0xFF JUMP JUMPDEST SWAP3 SWAP2 POP POP JUMP JUMPDEST PUSH32 0x4E487B7100000000000000000000000000000000000000000000000000000000 PUSH1 0x0 MSTORE PUSH1 0x11 PUSH1 0x4 MSTORE PUSH1 0x24 PUSH1 0x0 REVERT JUMPDEST PUSH1 0x0 PUSH2 0x163 DUP3 PUSH2 0x89 JUMP JUMPDEST SWAP2 POP PUSH2 0x16E DUP4 PUSH2 0x89 JUMP JUMPDEST SWAP3 POP DUP3 PUSH32 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF SUB DUP3 GT ISZERO PUSH2 0x1A3 JUMPI PUSH2 0x1A2 PUSH2 0x129 JUMP JUMPDEST JUMPDEST DUP3 DUP3 ADD SWAP1 POP SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 DIV 0xBC PUSH15 0xF2B145EB5169F90697C2906D8EAD2 0xE7 0xDD 0xC9 0xE8 ADDRESS 0xDA BLOCKHASH 0xCD 0xD1 ORIGIN PUSH5 0x84D3E16473 PUSH16 0x6C634300080F00330000000000000000
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>0.7.0</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0xC7 DUP1 PUSH2 0x1F PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH1 0xF JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH1 0x28 JUMPI PUSH1 0x0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH1 0x2D JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x60 PUSH1 0x4 DUP1 CALLDATASIZE SUB PUSH1 0x40 DUP2 LT ISZERO PUSH1 0x41 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST DUP2 ADD SWAP1 DUP1 DUP1 CALLDATALOAD SWAP1 PUSH1 0x20 ADD SWAP1 SWAP3 SWAP2 SWAP1 DUP1 CALLDATALOAD SWAP1 PUSH1 0x20 ADD SWAP1 SWAP3 SWAP2 SWAP1 POP POP POP PUSH1 0x76 JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 DUP3 DUP2 MSTORE PUSH1 0x20 ADD SWAP2 POP POP PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 ADD SWAP1 POP SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 BALANCE SMOD 0x21 0xB4 0x26 PUSH21 0xC8BB58941A6BB05C6E1CC489D1980BAE866A31279A 0xC5 0x23 MULMOD 0xA5 PUSH31 0x64736F6C634300070000330000000000000000000000000000000000000000
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>0.6.0</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH2 0x10 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0xC7 DUP1 PUSH2 0x1F PUSH1 0x0 CODECOPY PUSH1 0x0 RETURN INVALID PUSH1 0x80 PUSH1 0x40 MSTORE CALLVALUE DUP1 ISZERO PUSH1 0xF JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST POP PUSH1 0x4 CALLDATASIZE LT PUSH1 0x28 JUMPI PUSH1 0x0 CALLDATALOAD PUSH1 0xE0 SHR DUP1 PUSH4 0x771602F7 EQ PUSH1 0x2D JUMPI JUMPDEST PUSH1 0x0 DUP1 REVERT JUMPDEST PUSH1 0x60 PUSH1 0x4 DUP1 CALLDATASIZE SUB PUSH1 0x40 DUP2 LT ISZERO PUSH1 0x41 JUMPI PUSH1 0x0 DUP1 REVERT JUMPDEST DUP2 ADD SWAP1 DUP1 DUP1 CALLDATALOAD SWAP1 PUSH1 0x20 ADD SWAP1 SWAP3 SWAP2 SWAP1 DUP1 CALLDATALOAD SWAP1 PUSH1 0x20 ADD SWAP1 SWAP3 SWAP2 SWAP1 POP POP POP PUSH1 0x76 JUMP JUMPDEST PUSH1 0x40 MLOAD DUP1 DUP3 DUP2 MSTORE PUSH1 0x20 ADD SWAP2 POP POP PUSH1 0x40 MLOAD DUP1 SWAP2 SUB SWAP1 RETURN JUMPDEST PUSH1 0x0 DUP3 PUSH1 0x0 DUP2 SWAP1 SSTORE POP DUP2 PUSH1 0x1 DUP2 SWAP1 SSTORE POP DUP2 DUP4 ADD SWAP1 POP SWAP3 SWAP2 POP POP JUMP INVALID LOG2 PUSH5 0x6970667358 0x22 SLT KECCAK256 0xA9 0xB9 0xDB SWAP13 0x2B LOG3 0xE9 SMOD MOD PUSH4 0xB81C6012 DUP14 0xB2 SWAP13 0xB2 0x2C 0xD2 SWAP3 0x1E TIMESTAMP PUSH9 0x5E98B3FB163F0DC964 PUSH20 0x6F6C634300060000330000000000000000000000
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="编译器输入的-json-说明">编译器输入的 JSON 说明<a hidden class="anchor" aria-hidden="true" href="#编译器输入的-json-说明">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 必选：源代码语言。目前支持的是 “Solidity“，“Yul“ 和 “SolidityAST” （实验性的）。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nt">&#34;language&#34;</span><span class="p">:</span> <span class="s2">&#34;Solidity&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 必选
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nt">&#34;sources&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 这里的键值是源文件的 “全局“ 名称，
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 导入文件可以通过重映射使用其他文件（见下文）。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;myFile.sol&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 可选： 源文件的kaccak256哈希值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 如果通过URL导入，它用于验证检索的内容。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;keccak256&#34;</span><span class="p">:</span> <span class="s2">&#34;0x123...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 必选（除非声明了 &#34;content&#34; 字段，参见下文）: 指向源文件的URL。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 应按此顺序导入URL，并根据keccak256哈希值检查结果（如果有的话）。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 如果哈希值不匹配，或者没有一个URL(s)的结果是成功的，就应该产生一个错误。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 使用命令行界面只支持文件系统路径。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 通过JavaScript接口，URL将被传递给用户提供的读取回调，因此可以使用回调支持的任何URL。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;urls&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;bzzr://56ab...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ipfs://Qma...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;/tmp/path/to/file.sol&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 如果使用文件，其目录应通过 `--allow-paths &lt;path&gt;` 添加到命令行中。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 如果语言设置为 “SolidityAST”，则需要在 “ast” 字段下提供 AST。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 请注意，ASTs 的导入是试验性的，尤其是：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// - 导入无效的 ASTs 会产生未定义的结果，并且
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// - 对无效的 ASTs 不提供适当的错误报告。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 此外，请注意 AST 导入只消耗编译器在 “stopAfter”（停止后）模式下生成的 AST 字段：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// “parsing” 模式下生成的 AST 字段，然后重新执行分析，
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 因此 AST 中任何基于分析的注释在导入时都会被忽略。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="s2">&#34;ast&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="err">...</span> <span class="p">}</span> <span class="c1">// 格式化为 json ast 请求的 ``ast`` 输出选择。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;destructible&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 可选：源文件的keccak256哈希值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;keccak256&#34;</span><span class="p">:</span> <span class="s2">&#34;0x234...&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 必选：（除非使用 “urls“）：源文件的字面内容
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;content&#34;</span><span class="p">:</span> <span class="s2">&#34;contract destructible is owned { function shutdown() { if (msg.sender == owner) selfdestruct(owner); } }&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// 可选
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nt">&#34;settings&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 可选： 在给定的阶段后停止编译。目前这里只有 “parsing” 有效。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;stopAfter&#34;</span><span class="p">:</span> <span class="s2">&#34;parsing&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 可选： 经过排序的重映射列表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;remappings&#34;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&#34;:g=/dir&#34;</span> <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 可选： 优化器设置
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;optimizer&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 默认情况下是禁用的。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 注意：enabled=false 仍然保留了一些优化功能。见下面的注解。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 警告：在0.8.6版本之前，省略 “enabled“ 键并不等同于将其设置为false，
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 实际上会禁用所有优化。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;enabled&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 根据您打算运行代码的次数进行优化。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 较低的值将更多地针对初始部署成本进行优化，
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 较高的值将更多地针对高频使用进行优化。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;runs&#34;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 打开或关闭优化器组件的细节。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 上面的 “enabled“ 开关提供了两个默认值，
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 可以在这里进行调整。如果给出了 “details“，“enabled“ 可以省略。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;details&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 如果没有给出 details，窥视孔优化器总是打开的，使用 details 来关闭它。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nt">&#34;peephole&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 如果没有给出 details，内联器总是打开的，
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// 使用 details来关闭它。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nt">&#34;inliner&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 如果没有给出 details，未使用的跳板移除器总是打开的，
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// 使用 details来关闭它。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nt">&#34;jumpdestRemover&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 在换元运算中，有时会对字词重新排序。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nt">&#34;orderLiterals&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 移除重复的代码块
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nt">&#34;deduplicate&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 常见的子表达式消除，这是最复杂的步骤，但也能提供最大的收益。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nt">&#34;cse&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 优化代码中字面数字和字符串的表示。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nt">&#34;constantOptimizer&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 新的Yul优化器。主要在ABI coder v2 和 内联汇编的代码上运行。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// 它与全局优化器设置一起被激活，并且可以在这里停用。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// 在 Solidity 0.6.0 之前，它必须通过这个开关激活。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nt">&#34;yul&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Yul优化器的调优选项。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nt">&#34;yulDetails&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="c1">// 改善变量的堆栈槽的分配，可以提前释放堆栈槽。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="c1">// 如果Yul优化器被激活，则默认激活。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="nt">&#34;stackAllocation&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="c1">// 选择要应用的优化步骤。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="c1">// 也可以同时修改优化序列和清理序列。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="c1">// 每个序列的指令用 “:” 分隔，该值以 优化-序列:清理-序列 的形式提供。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="c1">// 更多信息见 “优化器 &gt; 选择优化”。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="c1">// 这个字段是可选的，如果不提供，优化和清理的默认序列都会使用。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="c1">// 如果只提供了其中一个选项，另一个将不会被运行。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="c1">// 如果只提供分隔符 “:”，
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="c1">// 那么优化和清理序列都不会被运行。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="c1">// 如果设置为空值，则只使用默认的清理序列，
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="c1">// 不应用任何优化步骤。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="nt">&#34;optimizerSteps&#34;</span><span class="p">:</span> <span class="s2">&#34;dhfoDgvulfnTUtnIf...&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 编译EVM的版本。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 影响到类型检查和代码生成。版本可以是 homestead,
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// tangerineWhistle, spuriousDragon, byzantium, constantinople, petersburg, istanbul, berlin, london or paris
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;evmVersion&#34;</span><span class="p">:</span> <span class="s2">&#34;byzantium&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 可选：改变编译管道以通过Yul的中间表示法。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 这在默认情况下是假的。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;viaIR&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 可选： 调试设置
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;debug&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 如何处理 revert（和require）的原因字符串。设置是
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// &#34;default&#34;, &#34;strip&#34;, &#34;debug&#34; 和 &#34;verboseDebug&#34;。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// &#34;default&#34; 不注入编译器生成的revert字符串，而是保留用户提供的字符串。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// &#34;strip&#34; 删除所有的revert字符串（如果可能的话，即如果使用了字面意义），以保持副作用。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// &#34;debug&#34; 为编译器生成的内部revert注入字符串，目前为ABI编码器V1和V2实现。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// &#34;verboseDebug&#34; 甚至将进一步的信息附加到用户提供的revert字符串中（尚未实现）。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;revertStrings&#34;</span><span class="p">:</span> <span class="s2">&#34;default&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 可选：在产生的EVM汇编和Yul代码的注释中包括多少额外的调试信息。可用的组件是：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// - `location`: `@src &lt;index&gt;:&lt;start&gt;:&lt;end&gt;` 形式的注解，
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">//   表明原始 Solidity 文件中相应元素的位置，其中：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">//     - `&lt;index&gt;` 是与 `@us-src` 注释相匹配的文件索引。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">//     - `&lt;start&gt;` 是该位置的第一个字节的索引。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">//     - `&lt;end&gt;` 是该位置后第一个字节的索引。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// - `snippet`: 来自 `@src` 所示位置的单行代码片断。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">//     该片段有引号，并跟随相应的 `@src` 注释。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// - `*`: 通配符值，可用于请求所有的东西。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;debugInfo&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;location&#34;</span><span class="p">,</span> <span class="s2">&#34;snippet&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 元数据设置 (可选)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;metadata&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// CBOR元数据默认是附加在字节码的最后。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 将此设置为false，会从运行时和部署时代码中省略元数据。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;appendCBOR&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 只使用字面内容，不使用URL（默认为false）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;useLiteralContent&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 对附加在字节码上的元数据哈希值使用给定的哈希值方法。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 元数据哈希可以通过选项 &#34;none &#34;从字节码中删除。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 其他选项是 &#34;ipfs&#34; 和 &#34;bzzr1&#34;。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 如果省略该选项，默认使用 &#34;ipfs&#34;。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;bytecodeHash&#34;</span><span class="p">:</span> <span class="s2">&#34;ipfs&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 库的地址。如果这里没有给出所有的库，
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 可能会导致未链接的对象，其输出数据是不同的。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;libraries&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 顶层键是使用该库的源文件的名称。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 如果使用了重映射，这个源文件应该与应用重映射后的全局路径一致。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 如果这个键是一个空字符串，那就是指一个全局水平。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;myFile.sol&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;MyLib&#34;</span><span class="p">:</span> <span class="s2">&#34;0x123123...&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 以下可用于根据文件和合约名称选择所需的输出。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 如果这个字段被省略，那么编译器就会加载并进行类型检查，但除了错误之外不会产生任何输出。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 第一层键是文件名，第二层键是合约名。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 一个空的合约名称用于不与合约绑定而是与整个源文件绑定的输出，如AST。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 以星号作为合约名称是指文件中的所有合约。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 同样地，以星形作为文件名可以匹配所有文件。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 要选择编译器可能产生的所有输出，
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 使用 &#34;outputSelection&#34;。{ &#34;*&#34;: { &#34;*&#34;: [ &#34;*&#34; ], &#34;&#34;: [ &#34;*&#34; ] } }&#34;，
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 但要注意，这可能会不必要地减慢编译过程。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 可用的输出类型如下：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 文件级别（需要空字符串作为合约名称）：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   ast - 所有源文件的AST
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 合约级别（需要合约名称或 &#34;*&#34;）：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   abi - ABI
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   devdoc - 开发者文档（Natspec格式）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   userdoc - 用户文档（Natspec格式）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   metadata - 元数据
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   ir - 优化代码前的Yul中间表示法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   irOptimized - 优化后的中间表现
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   storageLayout - 合约的状态变量的槽位、偏移量和类型
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   evm.assembly - 新的汇编格式
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   evm.legacyAssembly - JSON中的旧式汇编格式
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   evm.bytecode.functionDebugData - 在函数层面的调试信息
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   evm.bytecode.object - 字节码对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   evm.bytecode.opcodes - 操作码列表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   evm.bytecode.sourceMap - 源码映射（对调试有用）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   evm.bytecode.linkReferences - 链接引用（如果是未链接的对象）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   evm.bytecode.generatedSources - 由编译器生成的源码
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   evm.deployedBytecode* - 部署的字节码（拥有evm.bytecode的所有选项）。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   evm.deployedBytecode.immutableReferences - 从AST id到引用不可变的字节码范围的映射
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   evm.methodIdentifiers - 函数哈希值的列表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   evm.gasEstimates - 函数gas估计
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   ewasm.wast - WebAssembly S-expressions格式的Ewasm
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   ewasm.wasm - WebAssembly二进制格式的Ewasm
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 注意，使用 `evm`， `evm.bytecode`， `ewasm` 等将选择该输出的每个目标部分。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// 此外，`*` 可以作为通配符来请求所有东西。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;outputSelection&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;*&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;*&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;metadata&#34;</span><span class="p">,</span> <span class="s2">&#34;evm.bytecode&#34;</span> <span class="c1">// 启用每个合约的元数据和字节码输出。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="p">,</span> <span class="s2">&#34;evm.bytecode.sourceMap&#34;</span> <span class="c1">// 启用每个合约的源码映射输出。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;ast&#34;</span> <span class="c1">// 启用每个文件的AST输出。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 启用文件def中定义的MyContract的abi和opcodes输出。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;def&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;MyContract&#34;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&#34;abi&#34;</span><span class="p">,</span> <span class="s2">&#34;evm.bytecode.opcodes&#34;</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// modelChecker对象是实验性的，可能会有变化。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nt">&#34;modelChecker&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 选择哪些合约应作为部署的合约进行分析。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;contracts&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;source1.sol&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;contract1&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;source2.sol&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;contract2&#34;</span><span class="p">,</span> <span class="s2">&#34;contract3&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 选择除法和模数运算的编码方式。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 当使用 `false` 时，它们被替换为与松弛变量的乘法。这是默认的。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 如果您使用CHC引擎而不使用Spacer作为Horn求解器（例如使用Eldarica），
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 建议在这里使用 `true`。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 关于这个选项的更详细的解释，请参见形式验证部分。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;divModWithSlacks&#34;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 选择要使用的模型检查器引擎：所有（默认）， bmc， chc， 无。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;engine&#34;</span><span class="p">:</span> <span class="s2">&#34;chc&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 选择在编译时可获得被调用函数代码的情况下，
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 外部调用是否应被视为可信。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 详情请参阅SMT检查器部分。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;extCalls&#34;</span><span class="p">:</span> <span class="s2">&#34;trusted&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 选择哪些类型的不变性应该报告给用户：合约，重入。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;invariants&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;contract&#34;</span><span class="p">,</span> <span class="s2">&#34;reentrancy&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 选择是否输出所有验证过的目标。默认为 `false`。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;showProved&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 选择是否输出所有未验证的目标。默认为 `false`。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;showUnproved&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 选择是否输出所有不支持的语言功能。默认为 `false`。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;showUnsupported&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 如果有的话，选择应该使用哪些求解器。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 关于求解器的描述，见形式验证部分。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;solvers&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;cvc4&#34;</span><span class="p">,</span> <span class="s2">&#34;smtlib2&#34;</span><span class="p">,</span> <span class="s2">&#34;z3&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 选择哪些目标应该被检查：常数条件，下溢，溢出，除以零，余额，断言，弹出空数组，界外。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 如果没有给出该选项，所有目标都被默认检查，除了 Solidity &gt;=0.8.7 的下溢/溢出。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 目标描述见形式化验证部分。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;targets&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;underflow&#34;</span><span class="p">,</span> <span class="s2">&#34;overflow&#34;</span><span class="p">,</span> <span class="s2">&#34;assert&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 每个SMT查询的超时时间，以毫秒为单位。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 如果没有给出这个选项，SMTChecker将默认使用确定性的资源限制。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">// 给定超时为0意味着任何查询都没有资源/时间限制。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;timeout&#34;</span><span class="p">:</span> <span class="mi">20000</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="csp">CSP<a hidden class="anchor" aria-hidden="true" href="#csp">#</a></h1>
<h2 id="高精度算法">高精度算法<a hidden class="anchor" aria-hidden="true" href="#高精度算法">#</a></h2>
<blockquote>
<p><a href="https://www.luogu.com.cn/problem/P1009">P1009 [NOIP1998 普及组] 阶乘之和</a></p>
</blockquote>
<p>使用字符串存储大数，运算时参考竖式进行。</p>
<h3 id="加法运算">加法运算<a hidden class="anchor" aria-hidden="true" href="#加法运算">#</a></h3>
<p>大数加法运算直接模拟竖式加法即可。把对应位相加并将结果存入一个定义好长度的数组（放在对应位处），先不必考虑每一位的进位情况，直接存数即可。当算完得到结果数组后，从最后一位（个位）开始检查进位情况，如果有进位（大于 10）则调整该位及其高一位的数。当遍历完整个数组后再将数组转化成字符串返回即可。</p>
<h3 id="减法运算">减法运算<a hidden class="anchor" aria-hidden="true" href="#减法运算">#</a></h3>
<p>大数减法需要判断一下被减数与减数的大小，保证被减数大于减数，如果不满足则交换两个字符串数并在答案字符串中存入一个负号(&quot;-&quot;)。然后模拟竖式加法，把对应位相减的结果存入一个定义好长度的数组的对应位处（不考虑每一位的借位情况），然后从个位开始检查借位，如果有借位（小于 0）则调整该位及其高一位的数，最后转化数组为字符串并返回。</p>
<h3 id="乘法运算">乘法运算<a hidden class="anchor" aria-hidden="true" href="#乘法运算">#</a></h3>
<p>乘法运算仍旧是模拟竖式乘法，不考虑进位，将每位相乘结果存入数组对应位处（这里需要累加存入，竖式乘法每一位最后算结果时，不一定是两位相加有可能是多位），然后依旧是从个位开始检查进位，最后转化数组并返回结果。</p>
<h3 id="除法运算">除法运算<a hidden class="anchor" aria-hidden="true" href="#除法运算">#</a></h3>
<p>自然数范围内的除法模拟不出精确的小数结果，所以函数最后需要返回两个值一个是商一个是余数。除法的模拟运算用到了大数减法，思想依旧是模拟竖式的除法：</p>
<ul>
<li>从最高位依次取数直到大于等于除数为止</li>
<li>然后用目前取到的数减去若干个除数（直到减到小于除数为止）</li>
<li>记录减去了几个除数，最后将此数存入答案字符串</li>
<li>将记录清零然后再从被除数中再取一个数，判断是否小于除数</li>
<li>如果小于则直接将 0 加到答案字符串末尾</li>
<li>否则转入步骤 2 然后将最后记录加到答案字符串末尾</li>
<li>直到将被除数中的数取完为止</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">//......................................................................................
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">myCompare</span><span class="p">(</span><span class="n">string</span> <span class="n">a</span><span class="p">,</span> <span class="n">string</span> <span class="n">b</span><span class="p">)</span> <span class="c1">// 大数比较设定a&gt;b返回1 a&lt;b返回-1 a=b返回0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">!=</span> <span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="c1">// 如果字符串长度不同那么长度大的那个就是更大的大数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="c1">// 如果字符串长度相同我们通过直接比较字符串的字典序来判断大小
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//......................................................................................
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">string</span> <span class="nf">myAdd</span><span class="p">(</span><span class="n">string</span> <span class="n">a</span><span class="p">,</span> <span class="n">string</span> <span class="n">b</span><span class="p">)</span> <span class="c1">// 高精度加法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">ans</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>                             <span class="c1">// 开辟一个足够存储结果的数组，结果的位数最多为 位数最多的那个数的位数加一(考虑进位)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// 从个位开始通过模拟竖式进行大数加法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>                           <span class="c1">// 当两数均未加完时
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans</span><span class="p">[</span><span class="n">k</span><span class="o">--</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">--</span><span class="p">]</span> <span class="o">-</span> <span class="sc">&#39;0&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="o">--</span><span class="p">]</span> <span class="o">-</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span> <span class="c1">// 我们让我们的数组存储每一位相加的结果注意将字符串转为整型数字
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 检测是否有某个数的高位未加完将其直接存入数组中
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans</span><span class="p">[</span><span class="n">k</span><span class="o">--</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="o">--</span><span class="p">]</span> <span class="o">-</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans</span><span class="p">[</span><span class="n">k</span><span class="o">--</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">--</span><span class="p">]</span> <span class="o">-</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="n">c</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="p">;</span>                  <span class="c1">// 创建一个字符串去存储答案
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="c1">// 因为之前的竖式加每一位都没考虑进位所以我们从最后开始检查进位
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>                               <span class="c1">// 因为是加法如果有进位最多也就进一
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">)</span>           <span class="c1">// 如果大于10说明应该进位那么我们让此位减10它的高一位加1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ans</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span> <span class="c1">// 处理后的结果转化为字符插入结果字符的首位
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">// 检查最最高位是否大于0如果两数相加没有进位那么这一位就是0我们就不必存储它否则则放入字符串
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">c</span><span class="p">;</span> <span class="c1">// 返回答案
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//......................................................................................
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">string</span> <span class="nf">mySubtract</span><span class="p">(</span><span class="n">string</span> <span class="n">a</span><span class="p">,</span> <span class="n">string</span> <span class="n">b</span><span class="p">)</span> <span class="c1">// 高精度减法(整体思想同加法)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="n">c</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="p">;</span>            <span class="c1">// 创建一个字符串去存储答案
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="n">myCompare</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">// 先比较一下两数大小如果相等我们直接返回0即可
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="s">&#34;0&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">myCompare</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1">// 如果a&lt;b那么我们交换两数的值同时在答案字符串中先放入一个负号
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="sc">&#39;-&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 开辟一个足够存储结果的数组  减法结果的位数最多为位数最多的那个数的位数我们保证了a为的大数所以就是a的位数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">ans</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// 从个位开始模拟竖式减法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>                                         <span class="c1">// 表示低位的借位情况  0:无借位   1:有借位
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>                                     <span class="c1">// 同加法一样模拟运算我们知道a是大数所以a遍历完竖式才完成
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">char</span> <span class="n">nowb</span><span class="p">;</span> <span class="c1">// 被减数当前位有数就正常减 没有数说明就是0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">nowb</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="n">nowb</span> <span class="o">=</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">nowb</span> <span class="o">-</span> <span class="n">t</span><span class="p">;</span> <span class="c1">// 对应位相减同时减去低位的借位
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>           <span class="c1">// 如果结果小于0 则向高位借一位
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">t</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">ans</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>     <span class="c1">// 否则向高位无借位
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">k</span><span class="o">--</span><span class="p">,</span> <span class="n">i</span><span class="o">--</span><span class="p">,</span> <span class="n">j</span><span class="o">--</span><span class="p">;</span> <span class="c1">// 继续判断高一位
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">bool</span> <span class="n">flag</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span> <span class="c1">// 这里与加法不同高位可能出现多个零开头的情况我们需要找到第一不是零的地方再存数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">flag</span> <span class="o">&amp;&amp;</span> <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">// 如果当前数为0且未存数则不执行存数操作
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">flag</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span> <span class="c1">// 一旦存入数更改标志位
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">c</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">c</span><span class="p">;</span> <span class="c1">// 返回结果
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//......................................................................................
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">string</span> <span class="nf">myMultiply</span><span class="p">(</span><span class="n">string</span> <span class="n">a</span><span class="p">,</span> <span class="n">string</span> <span class="n">b</span><span class="p">)</span> <span class="c1">// 高精度乘法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="s">&#34;0&#34;</span> <span class="o">||</span> <span class="n">b</span> <span class="o">==</span> <span class="s">&#34;0&#34;</span><span class="p">)</span> <span class="c1">// 其中有一个为0时直接返回0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="s">&#34;0&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">ans</span><span class="p">;</span> <span class="c1">// 开辟一个足够存储结果的数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">m</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">ans</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="n">m</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>       <span class="c1">// 乘法结果的位数最多为两数的位数之和
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="c1">// 这里从高位开始和从低位开始无所谓我们将两数相乘的结果不考虑放到对应位上最后去检测进位即可
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>                           <span class="c1">// 例如个位乘百位的结果 以及十位乘十位的结果 都放到百位上
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">ans</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="sc">&#39;0&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="c1">// 我们从低位开始检查进位
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">)</span> <span class="c1">// 如果大于10说明有进位但乘法的进位不一定只进1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">ans</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10</span><span class="p">);</span> <span class="c1">// 高位加地位的高于个位部分
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">%=</span> <span class="mi">10</span><span class="p">;</span>                <span class="c1">// 低位对十求余
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="n">c</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="p">;</span>    <span class="c1">// 创建字符串存储答案
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">bool</span> <span class="n">flag</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span> <span class="c1">// 同减法一样找到第一个不是0的位置开始存数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">+</span> <span class="n">m</span><span class="p">;</span> <span class="n">t</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">flag</span> <span class="o">&amp;&amp;</span> <span class="n">ans</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">flag</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">c</span><span class="p">;</span> <span class="c1">// 返回答案
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//......................................................................................
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">myDivide</span><span class="p">(</span><span class="n">string</span> <span class="n">a</span><span class="p">,</span> <span class="n">string</span> <span class="n">b</span><span class="p">)</span> <span class="c1">// 高精度除法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">ans</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#34;0&#34;</span><span class="p">);</span> <span class="c1">// 先创建两个字符串空间去存储答案一个存商一个存余数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="n">myCompare</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1">// 如果被除数比除数小商为0余数为a返回答案即可
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">myCompare</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">// 如果被除数与除数相等商为1余数为0返回答案即可
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#34;1&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="c1">// 否则我们需要模拟除法的竖式来进行计算
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">string</span> <span class="n">res</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="p">;</span> <span class="c1">// 创建存储商的字符串
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kt">int</span> <span class="n">m1</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">m2</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">string</span> <span class="n">a1</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">m2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">m2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m1</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="c1">// 模拟竖式从高位开始依次取数减去除数能减几个该位商的当前位就是几
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">a1</span> <span class="o">==</span> <span class="s">&#34;0&#34;</span><span class="p">)</span> <span class="c1">// 如果a1为0为了防止a1出现0开头的情况我们将它清空
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">a1</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">a1</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span> <span class="c1">// 我们从被除数中取一个数放入a1继续减
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="kt">int</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">while</span> <span class="p">(</span><span class="n">myCompare</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">// 当a1大于等于除数时便一直减同时e累加
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">e</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">a1</span> <span class="o">=</span> <span class="n">mySubtract</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">||</span> <span class="n">e</span><span class="p">)</span> <span class="c1">// 如果res不为空或者e不为0我们存储他
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">res</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">e</span> <span class="o">+</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">ans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">;</span> <span class="c1">// 最后res就是商
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">ans</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">a1</span><span class="p">;</span>  <span class="c1">// a1就是余数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>   <span class="c1">// 返回答案
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//......................................................................................
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">string</span> <span class="nf">myFactorial</span><span class="p">(</span><span class="n">string</span> <span class="n">a</span><span class="p">)</span> <span class="c1">// 高精度阶乘
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">{</span>                            <span class="cm">/*我们还可以利用高精度减法和乘法实现大数的阶乘(最大可运行出10000左右的阶乘)*/</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="s">&#34;1&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">myMultiply</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">myFactorial</span><span class="p">(</span><span class="n">mySubtract</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s">&#34;1&#34;</span><span class="p">)));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//......................................................................................
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="n">add_ans</span><span class="p">,</span> <span class="n">subtract_ans</span><span class="p">,</span> <span class="n">multiply_ans</span><span class="p">,</span> <span class="n">factorial_ans</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">divide_ans</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">compare_ans</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span> <span class="o">&gt;&gt;</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">compare_ans</span> <span class="o">=</span> <span class="n">myCompare</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">compare_ans</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">add_ans</span> <span class="o">=</span> <span class="n">myAdd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">add_ans</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">subtract_ans</span> <span class="o">=</span> <span class="n">mySubtract</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">subtract_ans</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">multiply_ans</span> <span class="o">=</span> <span class="n">myMultiply</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">multiply_ans</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">divide_ans</span> <span class="o">=</span> <span class="n">myDivide</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">divide_ans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span>
</span></span><span class="line"><span class="cl">         <span class="o">&lt;&lt;</span> <span class="n">divide_ans</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//	factorial_ans=myFactorial(a);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//	cout&lt;&lt;factorial_ans&lt;&lt;endl;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://lxmliu2002.github.io/tags/csp/">CSP</a></li>
      <li><a href="https://lxmliu2002.github.io/tags/mlm/">MLM</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://lxmliu2002.github.io/posts/server/">
    <span class="title">« Prev</span>
    <br>
    <span>Server</span>
  </a>
  <a class="next" href="https://lxmliu2002.github.io/posts/hugging-face--csp/">
    <span class="title">Next »</span>
    <br>
    <span>Hugging Face Dataset &amp; CSP</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Compiler & CSP on x"
            href="https://x.com/intent/tweet/?text=Compiler%20%26%20CSP&amp;url=https%3a%2f%2flxmliu2002.github.io%2fposts%2fcompiler--csp%2f&amp;hashtags=CSP%2cMLM">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Compiler & CSP on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2flxmliu2002.github.io%2fposts%2fcompiler--csp%2f&amp;title=Compiler%20%26%20CSP&amp;summary=Compiler%20%26%20CSP&amp;source=https%3a%2f%2flxmliu2002.github.io%2fposts%2fcompiler--csp%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Compiler & CSP on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2flxmliu2002.github.io%2fposts%2fcompiler--csp%2f&title=Compiler%20%26%20CSP">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Compiler & CSP on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2flxmliu2002.github.io%2fposts%2fcompiler--csp%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Compiler & CSP on whatsapp"
            href="https://api.whatsapp.com/send?text=Compiler%20%26%20CSP%20-%20https%3a%2f%2flxmliu2002.github.io%2fposts%2fcompiler--csp%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Compiler & CSP on telegram"
            href="https://telegram.me/share/url?text=Compiler%20%26%20CSP&amp;url=https%3a%2f%2flxmliu2002.github.io%2fposts%2fcompiler--csp%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Compiler & CSP on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Compiler%20%26%20CSP&u=https%3a%2f%2flxmliu2002.github.io%2fposts%2fcompiler--csp%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>© <a href="https://github.com/lxmliu2002">lxmliu2002</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
